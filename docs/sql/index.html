
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>SQL Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../solidity/" />
    
    
    <link rel="prev" href="../php/wordpress.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../python/">
            
                <a href="../python/">
            
                    
                    Python
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../python/standard-library.html">
            
                <a href="../python/standard-library.html">
            
                    
                    Python Stardard Library
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../python/tools-and-packages.html">
            
                <a href="../python/tools-and-packages.html">
            
                    
                    Tools & More Packages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../python/django.html">
            
                <a href="../python/django.html">
            
                    
                    Django
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../java/">
            
                <a href="../java/">
            
                    
                    Java
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../java/javafx.html">
            
                <a href="../java/javafx.html">
            
                    
                    JavaFX
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../java/android.html">
            
                <a href="../java/android.html">
            
                    
                    Android Development
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../scala/">
            
                <a href="../scala/">
            
                    
                    Scala
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../javascript/">
            
                <a href="../javascript/">
            
                    
                    JavaScript
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../javascript/jquery.html">
            
                <a href="../javascript/jquery.html">
            
                    
                    jQuery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../javascript/react.html">
            
                <a href="../javascript/react.html">
            
                    
                    React
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../javascript/react-native.html">
            
                <a href="../javascript/react-native.html">
            
                    
                    React Native
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../javascript/node-js.html">
            
                <a href="../javascript/node-js.html">
            
                    
                    Node.js
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../javascript/wechat-mini-program.html">
            
                <a href="../javascript/wechat-mini-program.html">
            
                    
                    Wechat Mini Program
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../c/">
            
                <a href="../c/">
            
                    
                    C
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../cpp/">
            
                <a href="../cpp/">
            
                    
                    C++
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../c-sharp/">
            
                <a href="../c-sharp/">
            
                    
                    C#
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../c-sharp/dot-net.html">
            
                <a href="../c-sharp/dot-net.html">
            
                    
                    .NET
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../c-sharp/asp-dot-net.html">
            
                <a href="../c-sharp/asp-dot-net.html">
            
                    
                    ASP.NET
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../swift/">
            
                <a href="../swift/">
            
                    
                    Swift
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../swift/xcode.html">
            
                <a href="../swift/xcode.html">
            
                    
                    iOS Development
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../go/">
            
                <a href="../go/">
            
                    
                    Go Programming Language
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../markup/">
            
                <a href="../markup/">
            
                    
                    Markup Language
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../markup/html.html">
            
                <a href="../markup/html.html">
            
                    
                    HTML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../markup/xml.html">
            
                <a href="../markup/xml.html">
            
                    
                    XML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../markup/gfm.html">
            
                <a href="../markup/gfm.html">
            
                    
                    GFM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="../markup/latex.html">
            
                <a href="../markup/latex.html">
            
                    
                    LaTeX
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../css/">
            
                <a href="../css/">
            
                    
                    CSS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../css/bootstrap.html">
            
                <a href="../css/bootstrap.html">
            
                    
                    Bootstrap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../typescript/">
            
                <a href="../typescript/">
            
                    
                    TypeScript
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../typescript/angular.html">
            
                <a href="../typescript/angular.html">
            
                    
                    Angular
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../php/">
            
                <a href="../php/">
            
                    
                    PHP
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../php/wordpress.html">
            
                <a href="../php/wordpress.html">
            
                    
                    WordPress
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.15" data-path="./">
            
                <a href="./">
            
                    
                    SQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../solidity/">
            
                <a href="../solidity/">
            
                    
                    Solidity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../os/">
            
                <a href="../os/">
            
                    
                    Operating Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.17.1" data-path="../os/linux.html">
            
                <a href="../os/linux.html">
            
                    
                    Linux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.2" data-path="../os/bash-scripting.html">
            
                <a href="../os/bash-scripting.html">
            
                    
                    Bash Scripting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.3" data-path="../os/regex.html">
            
                <a href="../os/regex.html">
            
                    
                    Regular Expression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.4" data-path="../os/macos.html">
            
                <a href="../os/macos.html">
            
                    
                    MacOS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.5" data-path="../os/solution-stack.html">
            
                <a href="../os/solution-stack.html">
            
                    
                    Solution Stack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.6" data-path="../os/hadoop.html">
            
                <a href="../os/hadoop.html">
            
                    
                    Hadoop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.7" data-path="../os/git.html">
            
                <a href="../os/git.html">
            
                    
                    Git
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.8" data-path="../os/redis.html">
            
                <a href="../os/redis.html">
            
                    
                    Redis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.9" data-path="../os/media.html">
            
                <a href="../os/media.html">
            
                    
                    Media
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../networking/">
            
                <a href="../networking/">
            
                    
                    Networking
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.18.1" data-path="../networking/security.html">
            
                <a href="../networking/security.html">
            
                    
                    Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.2" data-path="../networking/cisco.html">
            
                <a href="../networking/cisco.html">
            
                    
                    Cisco
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="../virtualization/">
            
                <a href="../virtualization/">
            
                    
                    Virtualization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.19.1" data-path="../virtualization/virtualbox.html">
            
                <a href="../virtualization/virtualbox.html">
            
                    
                    VirtualBox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19.2" data-path="../virtualization/docker.html">
            
                <a href="../virtualization/docker.html">
            
                    
                    Docker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19.3" data-path="../virtualization/kubernetes.html">
            
                <a href="../virtualization/kubernetes.html">
            
                    
                    Kubernetes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="../cloud-services/">
            
                <a href="../cloud-services/">
            
                    
                    Cloud Services
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.20.1" data-path="../cloud-services/aws.html">
            
                <a href="../cloud-services/aws.html">
            
                    
                    AWS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.2" data-path="../cloud-services/gcp.html">
            
                <a href="../cloud-services/gcp.html">
            
                    
                    GCP
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.21" data-path="../embedded/">
            
                <a href="../embedded/">
            
                    
                    Embedded Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.21.1" data-path="../embedded/arduino.html">
            
                <a href="../embedded/arduino.html">
            
                    
                    Arduino
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.2" data-path="../embedded/raspberry-pi.html">
            
                <a href="../embedded/raspberry-pi.html">
            
                    
                    Raspberry Pi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.3" data-path="../embedded/st.html">
            
                <a href="../embedded/st.html">
            
                    
                    STMicroelectronics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.4" data-path="../embedded/nvidia.html">
            
                <a href="../embedded/nvidia.html">
            
                    
                    NVIDIA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.5" data-path="../embedded/electricity-magnetism.html">
            
                <a href="../embedded/electricity-magnetism.html">
            
                    
                    Electricity & Magnetism
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.22" data-path="../gis/">
            
                <a href="../gis/">
            
                    
                    GIS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.22.1" data-path="../gis/arcgis.html">
            
                <a href="../gis/arcgis.html">
            
                    
                    ArcGIS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.23" data-path="../algorithm/">
            
                <a href="../algorithm/">
            
                    
                    Algorithm
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.23.1" data-path="../algorithm/blockchain.html">
            
                <a href="../algorithm/blockchain.html">
            
                    
                    Blockchain
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.23.2" data-path="../algorithm/cryptography.html">
            
                <a href="../algorithm/cryptography.html">
            
                    
                    Cryptography
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.23.3" data-path="../algorithm/ml.html">
            
                <a href="../algorithm/ml.html">
            
                    
                    Machine Learning
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.24" data-path="../math/">
            
                <a href="../math/">
            
                    
                    Mathematics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.24.1" data-path="../math/basic.html">
            
                <a href="../math/basic.html">
            
                    
                    Basic Math
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.2" data-path="../math/calculus.html">
            
                <a href="../math/calculus.html">
            
                    
                    Calculus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.3" data-path="../math/linear-algebra.html">
            
                <a href="../math/linear-algebra.html">
            
                    
                    Linear Algebra
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.4" data-path="../math/discrete.html">
            
                <a href="../math/discrete.html">
            
                    
                    Discrete Mathematics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.5" data-path="../math/probability-statistics.html">
            
                <a href="../math/probability-statistics.html">
            
                    
                    Probability & Statistics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.6" data-path="../math/maple.html">
            
                <a href="../math/maple.html">
            
                    
                    Maple Softwares
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.25" data-path="../visualization/">
            
                <a href="../visualization/">
            
                    
                    Visualization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.25.1" data-path="../visualization/graphic-design.html">
            
                <a href="../visualization/graphic-design.html">
            
                    
                    Graphic Design
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.25.2" data-path="../visualization/computer-graphics.html">
            
                <a href="../visualization/computer-graphics.html">
            
                    
                    Computer Graphics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.25.3" data-path="../visualization/tableau.html">
            
                <a href="../visualization/tableau.html">
            
                    
                    Tableau
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.26" data-path="../music/">
            
                <a href="../music/">
            
                    
                    Music
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.26.1" data-path="../music/theory.html">
            
                <a href="../music/theory.html">
            
                    
                    Music Theory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.26.2" data-path="../music/logic-pro.html">
            
                <a href="../music/logic-pro.html">
            
                    
                    Logic Pro
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.27" data-path="../finance/">
            
                <a href="../finance/">
            
                    
                    Finance
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.27.1" data-path="../finance/related-concepts.html">
            
                <a href="../finance/related-concepts.html">
            
                    
                    Related Concepts
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >SQL</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="sql">SQL</h1>
<h2 id="history">History</h2>
<ul>
<li>It started life as SEQUEL in 1974, an IBM product</li>
<li>In 1980 it was renamed SQL</li>
<li>There is a SQL standard maintained by the American National Standards Institute (ANSI). Most database vendors extend the standard</li>
<li>PhpMyAdmin is a tool that helps manage database using a web interface, it is written in PHP.</li>
<li>The easiest way to get MySQL and PHPMyAdmin is to install free tools like XAMPP or WAMP, Then a database server can be installed on the computer and Database management can be accessed from browser using url: localhost:8080/myphpadmin.
(userid:root, password:&quot;&quot;)</li>
</ul>
<h2 id="concepts">Concepts</h2>
<ul>
<li>Compare with NoSQL, SQL it good at making complicated anlytics queries. NoSQL is good at getting direct or simple access to massive data</li>
<li>Column Sometimes referred to as a field, contains the same type of information for every record in table.</li>
<li>Row Sometimes referred to as a record
Table is a collection of related rows</li>
<li>Database is a collection of related tables and other objects</li>
<li>Entity is represented by a table, it is a thing or a person etc.
Cardinality can be used to represent the Entity relationship(one to one, one to many etc.), when the Entity can be zero it is optional.</li>
<li>A weak entity is an entity that cannot be uniquely identified by its attributes alone; therefore, it must use a foreign key.</li>
<li>Relationship has degree, A unary relationship(one entity, recursive relationship), binary relationship(two entities), ternary relationship(three entities), four-entity relationship(four entities), Ternary (and higher) relationships are usually represented by a series of binary relationships.</li>
<li>Attribute is represented by column headings.</li>
<li>Data Dictionary<ul>
<li>Also called Metadata System Tables (SQL Server) System dictionary is the repository of all data definitions for all objects within the scope of the database. It contains meta-data (Table name, column name, data constraints, primary and foreign keys, index)</li>
</ul>
</li>
<li>The System Catalog<ul>
<li>A detailed system data dictionary that describes all objects in the database</li>
</ul>
</li>
<li>For System table of the SQL Server<ul>
<li>Starting with SQL Server 2005, all System Tables are hidden and inaccessible directly A large collection of System Views have been created to accommodate accessing of database&#x2019;s metadata Two schemas INFORMATION_SCHEMA sys</li>
</ul>
</li>
<li>A primary key is a single field in the table that uniquely identifies (unique nonempty values)the table records. primary auto creates index.</li>
<li>Foreign Key is a field a reference a PK from another table.</li>
<li>A good choice for primary keys is a Meaningless But Unique Number (MBUN)&#x2022;Start at 1 and keep incrementing&#x2022;The int datatype provides 2,147,483,647 possible values&#x2022;The bigint datatype provides 9,223,372,036,854,775,807 possible values (&gt; 9 quintillion)</li>
<li>Another possible choice is the Globally Unique Identifier (GUID)&#x2013;Also known as Universally Unique Identifier (UUID)&#x2022;128 bit integer, typically expressed as 32 hex digits in the pattern 8-4-4-4-12&#x2013;Example: 678e6b75-29ad-4cba-8d78-5ad68aad414b&#x2022;Good for decentralized systems</li>
<li>Naming Conventions<ul>
<li>Do not put spaces in the names of anything you create</li>
<li>Do not use descriptive prefixes or postfixes such as tbl</li>
<li>Use all lowercase and divide word boundaries with <code>_</code>, database name uppercase.</li>
<li><a href="http://www.sqlstyle.guide" target="_blank">Click here to see more</a>.</li>
</ul>
</li>
<li>IDENTITY Property<ul>
<li>SQL Server provides an optional identity property to simplify creating MBUNs&#x2022;The identity property would be added to the definition of the primary key column when a table is being created.</li>
<li>IDENTITY [ (seed , increment) ] Seed and increment are optional, both default to 1</li>
<li>when insert row without specifying the value for PK, default rules are used.</li>
<li>Using an identity property simplifies INSERTs.</li>
<li>Without an identity property, the primary key must first be determined and then specified</li>
<li>With an identity property, the primary key is left off the INSERT statement and the database automatically keeps track of it and provides it when necessary.</li>
</ul>
</li>
<li>Determinant<ul>
<li>An attribute whose value determines the value for another attribute</li>
<li>Usually the primary key.</li>
</ul>
</li>
<li>Functional Dependency<ul>
<li>Relationship between a determinant A and dependent attribute B.</li>
<li>Represented by A -&gt; B</li>
</ul>
</li>
<li>Candidate Key<ul>
<li>One of the attributes that could be used as a primary key.</li>
</ul>
</li>
<li>Relation<ul>
<li>A table with rows and columns &#x2022;Each row contains information on an instance of an entity</li>
</ul>
</li>
<li>Tuple is a row of data</li>
<li>When design database, identity the entities then find their relationship.</li>
<li>Many-to-Many relationship cannot be represented in the database. Hence, an intersection entities is required.</li>
<li>Atomic attribute<ul>
<li>A component of the record definition that is used to describe an entity A field Unique meaningful names Example: postal_code Composite attribute Composed of atomic attributes, each defined in the data dictionary Address is comprised of street_address city province_id postal_code</li>
</ul>
</li>
<li>Derived attribute<ul>
<li>An attribute whose value is obtained by applying a formula to other data elements Examples: sales commission = sales <em> percentage age = DATEDIFF(YEAR, birth_date, GETDATE()) Multi-valued attribute An attribute with multiple possible values A employee can have more than one skill Alias Synonym A different name for a data element with the same meaning ``SELECT COUNT(</em>) AS total FROM patients``</li>
</ul>
</li>
<li>Domain<ul>
<li>The set of possible values an attribute can take on Concatenated Key Also known as Composite Key, Compound Key Two or more attributes taken together to uniquely identify a record Examples: patient_id, admission_date in admissions table purchase_order_id, line_num in purchase_order_lines table Secondary Key Requires an index may not be unique Example: last_name Sort Key Used to physically sequence a file Example: seniority listing of employee records</li>
</ul>
</li>
<li>Foreign Key<ul>
<li>A field (or multiple fields) in a table that uniquely identifies a row of another table (or the same table) Example: nursing_unit_id in admissions table Entity Occurrence Represented by a record with actual data values in it, or a row in a table Schema The definition of an entire database In SQL Server, schemas are used as containers to organize database objects</li>
</ul>
</li>
<li>Indexes is used to improve only the access time.</li>
<li>Clustered indexes is the indexes that are associated with a column, usually the primary key. when create is physical sort and associated column data. Unclustered index store unsorted data on the store device and use pointers to associate the data with index.</li>
<li>Multiple SQL statement can bu put in order, end with ;.</li>
<li>Normalization Quick Summary&#x2022;<ul>
<li>0NF - tables without normalization.</li>
<li>1NF - Eliminate Repeating Groups And Derived Attributes&#x2013;Make a separate table for each set of related attributes, and give each table a primary key&#x2022;</li>
<li>2NF - Eliminate Redundant Data&#x2013;If an attribute depends on only part of a composite key, remove it to a separate table&#x2022;</li>
<li>3NF - Eliminate Columns Not Dependent On Key&#x2013;If attributes do not contribute to a description of the key, remove them to a separate table</li>
</ul>
</li>
<li>OLTP(Online Transaction Process) uses normalized data.</li>
<li>OLAP(Online Analytical Process) and BI(Business Intellige) and Data warehouse stores denormalized data.</li>
<li>Business Rules are specifications that preserve the integrity of a conceptual or logical data model. They are enforced by for types of rules.</li>
<li>Entity integrity(PK)</li>
<li>Referential integrity(FK)</li>
<li>Domains(Value Boundary, check)</li>
<li>Triggering operations(?)</li>
<li>View<ul>
<li>View is a virtual table based on one or more tables.</li>
<li>The View result set is not permanently stored in the database, but generated each time it is used</li>
<li>Shows up in INFORMATION_SCHEMA.VIEWS &amp;INFORMATION_SCHEMA.TAB</li>
</ul>
</li>
<li>SQL Statements have two types.<ul>
<li>Data Definition Language (DDL)<ul>
<li>CREATE table</li>
<li>CREATE index</li>
</ul>
</li>
<li>Data Manipulation Language (DML)<ul>
<li>SELECT</li>
<li>INSERT</li>
<li>UPDATE</li>
<li>DELETE</li>
</ul>
</li>
</ul>
</li>
<li>Depending on the database vendor, data can be case sensitive <code>&apos;M&apos; &lt;&gt; &apos;m&apos;</code><ul>
<li>Data in Oracle database is case sensitive</li>
</ul>
</li>
<li>SQL is not case sensitive<ul>
<li>Convention is to capitalize keywords and use lower case for tables, columns, etc</li>
</ul>
</li>
<li>SQL ignores whitespace<ul>
<li>Convention is to capitalize keywords and place each clause on its own line</li>
</ul>
</li>
<li>For Character and string data single quotes are recommended and generally used.</li>
<li>multiple queries or commands can be entered at the same time and separate by ; at end of each line.</li>
<li>SQL is case insensitive. However uppercase is preferred for all commands.</li>
<li>SQL syntax is not sensitive to indentations.</li>
<li><code>dual</code> is a &quot;dummy&quot; table in Oracle that has 1 row and 1 column
&#x2013; Used whenever a single value is expected from a <code>SELECT ... FROM dual;</code> syntax</li>
</ul>
<h2 id="database-tools">Database Tools</h2>
<ul>
<li>Tools for connecting to the database server for testing and maintainance purpose</li>
</ul>
<h3 id="sql-developer">SQL Developer</h3>
<ul>
<li>Used for Oracle Database</li>
<li><a href="https://github.com/oracle/docker-images/blob/main/OracleDatabase/SingleInstance/README.md" target="_blank">Click</a> to see to installation instruction from oracle docker image repo<ul>
<li>Oracle 18.4 Express Edition has SID as <code>xe</code></li>
</ul>
</li>
<li>SET command<ul>
<li>it only effect the current session<ul>
<li>To set all sessions, a connection startup script can be created and set in <code>Tools / Preferences...</code></li>
</ul>
</li>
<li><code>SET PAGESIZE 1000</code> set output page size for text output<ul>
<li>default is <code>14</code></li>
</ul>
</li>
</ul>
</li>
<li><code>Run Statement</code> - runs the current statement and presents the query result in a grid</li>
<li><code>Run Script</code> - runs the whole script and presents the script output as text</li>
<li>If a section of the script is highlighted and <code>Run Statement</code> or <code>Run Script</code> is pressed, only the highlighted section will run<ul>
<li>This is a good way to test a subquery to ensure that it&#x2019;s working as expected</li>
</ul>
</li>
<li><code>History</code> - returns all previously ran commands
&#x2013; Double-clicking one of them brings them back into the Worksheet tab where they can be run again or edited</li>
<li>Enable line numbers - right-click the line gutter (left margin of the code editor) and select Toggle Line Numbers</li>
</ul>
<h3 id="sql-command-line">SQL Command Line</h3>
<ul>
<li>Available on all installs of Oracle, known as <code>SQL*Plus</code></li>
<li>If something is wrong with database, may be only tool that allows database access</li>
<li>For mac, to install</li>
<li>It can run any <code>PL/SQL</code> query<ul>
<li>SQL statements must be terminated by <code>;</code></li>
</ul>
</li>
<li>run <code>sqlplus</code> to open the tool<ul>
<li>or, <code>sqlplus &lt;user&gt;/&lt;password&gt; as &lt;role&gt;</code></li>
<li>or, <code>sqlplus &lt;user&gt;/&lt;password&gt;</code></li>
<li>Will be prompted for credentials</li>
</ul>
</li>
<li>Useful command:<ul>
<li><code>show user</code></li>
<li><code>help</code></li>
<li><code>connect</code> (prompted for credentials)<ul>
<li>or <code>connect &lt;user&gt;/&lt;password&gt; as &lt;role&gt;</code></li>
</ul>
</li>
<li><code>disconnect</code></li>
<li><code>/</code> to rerun previous SQL command</li>
<li><code>help index</code> see a list of <code>SQL*Plus</code> commands</li>
<li><code>help &lt;command&gt;</code> see help for a certain command</li>
<li><code>@&lt;filename&gt;.sql</code> run a <code>sql</code> script</li>
<li><code>quit</code></li>
</ul>
</li>
</ul>
<h3 id="pgadmin">pgAdmin</h3>
<ul>
<li>A web app for managing Postgres database</li>
</ul>
<h2 id="data-types">Data Types</h2>
<h3 id="general-data-types">General Data Types</h3>
<h4 id="numeric">Numeric</h4>
<ul>
<li>int(can have no length),can be signed or unsigned.</li>
<li>FLOAT(optional display length,decimal place) cannot be unsigned.</li>
<li>DOUBLE(optional display length,decimal place) cannot be unsigned.</li>
</ul>
<h4 id="date-and-time">Date and Time</h4>
<ul>
<li>DATE - A date in YYYY-MM-DD format.</li>
<li>DATETIME - A date and time combination in YYYY-MM-DD HH:MM:SS format.</li>
<li>TIMESTAMP - A timestamp, calculated from midnight, January 1, 1970</li>
<li>TIME - Stores the time in HH:MM:SS format.</li>
</ul>
<h4 id="string-type">String Type</h4>
<ul>
<li>CHAR(M) - Fixed-length character string. Size is specified in parenthesis. Max 255 bytes</li>
<li>VARCHAR(M) - Variable-length character string. Max size is specified in parenthesis</li>
<li>BLOB - &quot;Binary Large Objects&quot; and are used to store large amounts of binary data, such as images or other types of files.</li>
<li>TEXT - Large amount of text data.</li>
<li>The size parameter specifies the maximum length of the table&apos;s column.</li>
</ul>
<h3 id="sql-server-data-type">SQL Server Data Type</h3>
<h4 id="exact-numerics">Exact Numerics</h4>
<ul>
<li>bigint</li>
<li>bit</li>
<li>decimal</li>
<li>int</li>
<li>money</li>
<li>numeric</li>
<li>smallint</li>
<li>smallmoney</li>
<li>tinyint</li>
</ul>
<h4 id="approximate-numerics">Approximate Numerics</h4>
<ul>
<li>float</li>
<li>real</li>
</ul>
<h4 id="date-and-time">Date and Time</h4>
<ul>
<li>date</li>
<li>datetime2</li>
<li>datetime</li>
<li>datetimeoffset</li>
<li>smalldatetime</li>
<li>time</li>
</ul>
<h4 id="character-strings">Character Strings</h4>
<ul>
<li>char</li>
<li>text</li>
<li>varchar</li>
</ul>
<h4 id="unicode-character-strings">Unicode Character Strings</h4>
<ul>
<li>nchar</li>
<li>ntext</li>
<li>nvarchar</li>
</ul>
<h4 id="binary-strings">Binary Strings</h4>
<ul>
<li>binary</li>
<li>image</li>
<li>varbinary</li>
</ul>
<h4 id="other-data-types">Other Data Types</h4>
<ul>
<li>Cursor</li>
<li>hierarchyid</li>
<li>sql_variant</li>
<li>table</li>
<li>timestamp</li>
<li>uniqueidentifier</li>
<li>xml</li>
</ul>
<h3 id="postgres-data-types">Postgres Data Types</h3>
<ul>
<li>Array is supported for all types</li>
</ul>
<h3 id="oracle-data-types">Oracle Data Types</h3>
<ul>
<li>VARCHAR2(maximum length)
&#x2013; Variable length character data
&#x2013; Maximum length up to 32,767 bytes
&#x2013; Maximum length of a database column is 4,000 bytes
&#x2013; NVARCHAR2 Unicode version of VARCHAR2
&#x2013; For Oracle databases: VARCHAR is synonymous with VARCHAR2; to avoid possible changes in behavior, always use VARCHAR2 to store variable-length character strings</li>
<li>CHAR(max)
&#x2013; Fixed length character data, blank padded if necessary
&#x2013; Optional maximum length up to 32,767 bytes
&#x2013; Maximum length of a database column is 2,000 byte
&#x2013; Defaults to 1 byte
&#x2013; NCHAR Unicode version of CHAR</li>
<li>NUMBER[(precision, scale)]
&#x2013; Fixed or floating point number of almost any size
&#x2013; Precision is total number of digits
&#x2013; Scale determines where rounding occurs
&#x2013; If scale is omitted, it is 0 and value becomes integer (default)
&#x2013; Maximum precision is 38 digits&#x2013;Scale can be from 0 to 127</li>
<li>BINARY_INTEGER<ul>
<li>Stores signed integer values</li>
<li>Compares to NUMBER, but takes up less space and is faster in calculations</li>
<li>-2,147,483,747 to 2,147,483,747</li>
</ul>
</li>
<li>DATE<ul>
<li>Stores fixed length date values</li>
<li>January 1, 4712 BC to December 31, 9999 AD
&#x2013; Start date based on Julian Day Number used in astronomy</li>
<li>When stored in a database column, date values include the time of day in seconds since midnight</li>
</ul>
</li>
<li>TIMESTAMP<ul>
<li>Extension of DATE type</li>
<li>Stores fixed length date values with precision down to a fraction of a second, with up to 9 places after the decimal (default is 6)</li>
<li>Example: 28-SEP-1966 09.51.44.000000 AM</li>
</ul>
</li>
<li>BOOLEAN<ul>
<li>Stores the value TRUE or FALSE as well as NULL</li>
<li>PL/SQL only, database tables don&apos;t support this type</li>
</ul>
</li>
<li>LONG<ul>
<li>Stores variable length character strings</li>
<li>LONG is like VARCHAR2, but it&#x2019;s maximum length is 2GB</li>
</ul>
</li>
<li>LONG RAW<ul>
<li>Stores raw binary up to 2GB</li>
</ul>
</li>
<li>LOB<ul>
<li>Large OBject</li>
<li>4 types: BLOB, CLOB , NCLOB and BFILE</li>
<li>Stores binary objects such as image or video files up to 4GB</li>
<li>BLOBs and CLOBs are functionally equivalent</li>
<li>LOB types stored in the database, BFILE stored outside the database</li>
<li>NCLOB Unicode version of CLOB</li>
</ul>
</li>
<li>ROWID<ul>
<li>Internally, every Oracle table has a ROWID pseudocolumn, which stores binary values called ROWIDs</li>
<li>ROWIDs uniquely identify rows (within a table) and provide the fastest way to access particular rows</li>
<li>Use the ROWID data type to store ROWIDs in a readable format</li>
</ul>
</li>
<li>ROWNUM<ul>
<li>ROWNUM is a pseudocolumn that indicates the order of the row within the result set</li>
<li>Determined before ORDER BY</li>
<li>Can be used to approximate SQL Server&apos;s TOP clause</li>
</ul>
</li>
<li>ROWTYPE<ul>
<li>A list column types from a table</li>
<li><code>rowtypeName tableName%ROWTYPE;</code></li>
</ul>
</li>
<li>RECORD<ul>
<li>user defined list of column types<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
<span class="hljs-keyword">type</span> books <span class="hljs-keyword">is</span> <span class="hljs-built_in">record</span>
    (title <span class="hljs-built_in">varchar</span>(<span class="hljs-number">50</span>),
    author <span class="hljs-built_in">varchar</span>(<span class="hljs-number">50</span>),
    subject <span class="hljs-built_in">varchar</span>(<span class="hljs-number">100</span>),
    book_id <span class="hljs-built_in">number</span>);
book1 books;
book2 books;
</code></pre>
</li>
</ul>
</li>
</ul>
<h2 id="sql-syntax">SQL Syntax</h2>
<h3 id="get-database-info">Get Database Info</h3>
<ul>
<li>The following SQL examples work for mySQL, variation for other SQL will be noted<ul>
<li>Check server version<pre><code class="lang-sql"><span class="hljs-keyword">select</span> @@<span class="hljs-keyword">version</span>
</code></pre>
</li>
<li>the command lists the databases managed by the server.<pre><code class="lang-sql"><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">DATABASES</span> MySQL
.<span class="hljs-keyword">databases</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">SQL</span> <span class="hljs-keyword">Server</span>
</code></pre>
</li>
<li>display all of the tables in the currently selected database.<pre><code class="lang-sql"><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">TABLES</span> MySQL
.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">SQL</span> <span class="hljs-keyword">Server</span>
</code></pre>
</li>
<li>displays information about the columns in a given table.<pre><code class="lang-sql"><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">COLUMNS</span> <span class="hljs-keyword">FROM</span> tablename
</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="select">SELECT</h3>
<ul>
<li>The <code>SELECT</code> statement is used to query data from a database. Query results are stored in a table called result-set.</li>
<li>A <code>SELECT</code> statement retrieves zero or more rows from one or more database tables.</li>
<li><code>FROM</code> is required expect for SQL Server.<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> column_list
<span class="hljs-keyword">FROM</span> table_name
</code></pre>
</li>
<li>SELECT can be followed by a aggregating function<ul>
<li>Aggregating functions will ignore columns with NULL values</li>
<li>AVG &#x2013; Computes the average value of the column</li>
<li>COUNT &#x2013; Counts the number of rows</li>
<li>MAX &#x2013; Determines the maximum value</li>
<li>MIN &#x2013; Determines the minimum value</li>
<li>SUM &#x2013; Totals the numeric values<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(*)<span class="hljs-keyword">FROM</span> patients
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">AVG</span>(patient_weight)<span class="hljs-keyword">FROM</span> patients
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">MIN</span>(last_name)<span class="hljs-keyword">FROM</span> patients
</code></pre>
</li>
</ul>
</li>
<li>Coalesce - takes any number of columns name and returns the first value that is not null, it is used to set a default value if returns null<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> first_name, last_name, <span class="hljs-keyword">COALESCE</span>(allergies, <span class="hljs-string">&apos;No known allergies&apos;</span>)<span class="hljs-keyword">FROM</span> patients
<span class="hljs-comment">-- For each returning records, When allergies has a value it will return the value</span>
<span class="hljs-comment">-- If allergies is NULL, it will return &apos;No known allergies&apos;</span>
</code></pre>
</li>
<li><code>NVL()</code> function: if the first argument is NULL, return the second argument</li>
<li>Case Function - Case function allows boolean logic in a SQL statement</li>
<li>If no conditions are true and there is no else clause, null is returned<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> first_name, last_name,
  <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> patient_height &gt; <span class="hljs-number">170</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">&apos;Tall&apos;</span>
  <span class="hljs-keyword">WHEN</span> patient_height &gt; <span class="hljs-number">120</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">&apos;Average&apos;</span>
  <span class="hljs-keyword">ELSE</span> <span class="hljs-string">&apos;Short&apos;</span>
  <span class="hljs-keyword">END</span>
<span class="hljs-keyword">FROM</span> patients
</code></pre>
</li>
<li>Case function can be aliased as a column to enhance readability<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> first_name, last_name,
  <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> patient_height &gt; <span class="hljs-number">170</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">&apos;Tall&apos;</span>
  <span class="hljs-keyword">WHEN</span> patient_height &gt; <span class="hljs-number">120</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">&apos;Average&apos;</span>
  <span class="hljs-keyword">ELSE</span> <span class="hljs-string">&apos;Short&apos;</span>
  <span class="hljs-keyword">END</span> height
<span class="hljs-keyword">FROM</span> patients
</code></pre>
</li>
<li>Columns have fully qualified names as <code>tablename.columnname</code> is acceptable. It is used to distinguish same columns names from different tables.</li>
<li>Multiple columns can be queried in one command separated by commas.</li>
<li><code>*</code> represent all.</li>
<li><code>DISTINCT</code> qualifier return unique value of columns<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> column_name1, column_name2
<span class="hljs-keyword">FROM</span> table_name;
</code></pre>
</li>
<li><code>LIMIT</code> keyword shows only specific number of d rows.<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ID</span>, FirstName, LastName, City
<span class="hljs-keyword">FROM</span> customers <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">5</span>;
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">Select</span> <span class="hljs-number">4</span> <span class="hljs-keyword">start</span> <span class="hljs-keyword">after</span> <span class="hljs-number">3</span>rd(counting <span class="hljs-keyword">from</span> zero)
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ID</span>, FirstName, LastName, City
<span class="hljs-keyword">FROM</span> customers <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">3</span>, <span class="hljs-number">4</span>;
</code></pre>
</li>
<li>Im SQL Server use TOP, The TOP clause sets a maximum number of rows that can be retrieved<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> TOP <span class="hljs-number">5</span> *
<span class="hljs-keyword">FROM</span> patients;
and
<span class="hljs-keyword">SELECT</span> TOP <span class="hljs-number">5</span> <span class="hljs-keyword">PERCENT</span> *
<span class="hljs-keyword">FROM</span> patients;
</code></pre>
</li>
<li>ORDER BY is used with <code>SELECT</code> to sort the returned data.<ul>
<li>By default the order is <code>ASC</code>, use <code>DESC</code> to get results in descending order</li>
</ul>
</li>
<li>Can order by multiple columns separate by commas. Sort the first column first then second.<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> customers
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> FirstName;
Default uses ascending order.
Or <span class="hljs-keyword">use</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> Salary <span class="hljs-keyword">DESC</span>
</code></pre>
</li>
<li>Where keyword is used to add conditions.<ul>
<li>Predicates are used in the <code>WHERE</code> clause to specify conditions, Basic Predicate:<ul>
<li><code>=, &lt;&gt;, &lt;, &gt;, &lt;=, &gt;=</code></li>
<li>BETWEEN Predicate</li>
<li>EXISTS Predicate</li>
<li>IN Predicate</li>
<li>LIKE Predicate</li>
<li>NULL Predicate<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> column_list
<span class="hljs-keyword">FROM</span> table_name
<span class="hljs-keyword">WHERE</span> condition;
Condition could be ID=5 (any comparison and logic operator(and &amp; or)
between. for example ID=5 and ID=10)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> customers
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">ID</span> <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">3</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">7</span>;
(Boundaries are included)
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
<li>Single quotation marks (&apos;) is used for text.<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ID</span>, FirstName, LastName, City
<span class="hljs-keyword">FROM</span> customers
<span class="hljs-keyword">WHERE</span> City = <span class="hljs-string">&apos;New York&apos;</span>;
</code></pre>
</li>
<li>single qoute can also be the escape characters. Ex: Can&apos;&apos;t</li>
<li><code>IN</code> keyword includes all satisfied columns.<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> customers
<span class="hljs-keyword">WHERE</span> City <span class="hljs-keyword">IN</span> (<span class="hljs-string">&apos;New York&apos;</span>, <span class="hljs-string">&apos;Los Angeles&apos;</span>, <span class="hljs-string">&apos;Chicago&apos;</span>);
</code></pre>
</li>
<li>The <code>NOT IN</code> operator allows you to exclude a list of specific values from the result set. Result set must included in bracket, even there is only one element in it. result set can be a column returned from other SELECT query.</li>
<li><code>ANY</code> and <code>SOME</code> checks whether any value in the list makes the condition true</li>
<li><code>ALL</code> checks to ensure that all values in the list are true<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> first_name, last_name, patient_height
<span class="hljs-keyword">FROM</span> patients
<span class="hljs-keyword">WHERE</span> gender = <span class="hljs-string">&apos;M&apos;</span>
<span class="hljs-keyword">AND</span> patient_height &gt; ALL (
  <span class="hljs-keyword">SELECT</span> patient_height
  <span class="hljs-keyword">FROM</span> patients
  <span class="hljs-keyword">WHERE</span> gender = <span class="hljs-string">&apos;F&apos;</span>)
</code></pre>
</li>
<li>EXISTS returns true if a subquery contains any rows.</li>
<li><code>IS</code> can be used with <code>NULL</code>. or <code>IS NOT NULL</code><ul>
<li><code>WHERE column = NULL</code> will not return anything</li>
<li><code>NULL + 5</code> will return <code>NULL</code><pre><code class="lang-sql"><span class="hljs-comment">-- This select all row of patients tables that exist in the unit_dose_orders table</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name
<span class="hljs-keyword">FROM</span> patients
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span> (<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> unit_dose_orders <span class="hljs-keyword">WHERE</span> unit_dose_orders.patient_id = patients.patient_id)
<span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> vendors
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> (<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> purchase_orders <span class="hljs-keyword">WHERE</span> purchase_orders.vendor_id = vendors.vendor_id)
<span class="hljs-comment">-- This select all row of patients tables that don&#x2019;t exist in the unit_dose_orders table</span>
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> patients
<span class="hljs-keyword">WHERE</span> allergies <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>;
</code></pre>
</li>
</ul>
</li>
<li><code>AND</code> and <code>OR</code> can be used to connects conditions for WHERE statement.</li>
<li><code>CONCAT</code> combines two column in a format<ul>
<li>A concatenation results in a new column. The default column name will be the CONCAT<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">CONCAT</span>(FirstName, <span class="hljs-string">&apos;, &apos;</span> , City) <span class="hljs-keyword">FROM</span> customers;
</code></pre>
</li>
</ul>
</li>
<li><code>AS</code> is used for a column name change(Alias)</li>
<li><code>AS</code> is optional</li>
<li>Use double qoute for alias name to reserves capitalization, e.g. <code>AS &quot;Name&quot;</code>(works when database support case sensitive data)<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">CONCAT</span>(FirstName,<span class="hljs-string">&apos;, &apos;</span>, City) <span class="hljs-keyword">AS</span> new_column
<span class="hljs-keyword">FROM</span> customers;
</code></pre>
</li>
<li>Arithmetic operator can also be used in query.<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ID</span>, FirstName, LastName, Salary+<span class="hljs-number">500</span> <span class="hljs-keyword">AS</span> Salary
<span class="hljs-keyword">FROM</span> employees;
</code></pre>
</li>
<li>Upper and lower function change upper lower cases.<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> FirstName, <span class="hljs-keyword">UPPER</span>(LastName) <span class="hljs-keyword">AS</span> LastName
<span class="hljs-keyword">FROM</span> employees;
<span class="hljs-keyword">SELECT</span> FirstName, LastName <span class="hljs-keyword">AS</span> LastName
<span class="hljs-keyword">FROM</span> employees
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">LOWER</span>(LastName) <span class="hljs-keyword">like</span> <span class="hljs-string">&apos;smi%&apos;</span>;
</code></pre>
</li>
<li>GROUP BY<ul>
<li>It can be used to deal with results of the column that has different rows.</li>
<li>GROUP BY must be used in conjunction with an aggregating function</li>
<li>Does not sort automatically, still need ORDER BY for sort</li>
<li>Multiple groupings are allowed<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> province_id, city, <span class="hljs-keyword">COUNT</span>(*)
<span class="hljs-keyword">FROM</span> patients
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> province_id, city
</code></pre>
</li>
</ul>
</li>
<li>HAVING<ul>
<li>It is like another WHERE clause for grouped columns.</li>
<li>Used with GROUP BY<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> nursing_unit_id, <span class="hljs-keyword">COUNT</span>(*)
<span class="hljs-keyword">FROM</span> admissions
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> nursing_unit_id
<span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">COUNT</span>(*) &gt;= <span class="hljs-number">340</span>
</code></pre>
</li>
</ul>
</li>
<li>Subqueries is a query that has queries inside.<ul>
<li>the inner query is processed first.</li>
<li>Enclose the subquery in parentheses.</li>
<li>Subquery Returns Single Rows<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> FirstName, Salary <span class="hljs-keyword">FROM</span> employees
<span class="hljs-keyword">WHERE</span>  Salary &gt; (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">AVG</span>(Salary) <span class="hljs-keyword">FROM</span> employees)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> Salary <span class="hljs-keyword">DESC</span>;
</code></pre>
</li>
<li>Subquery Returns Multiple Rows<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> nursing_unit_id, patient_id, admission_date
<span class="hljs-keyword">FROM</span> admissions
<span class="hljs-keyword">WHERE</span> nursing_unit_id <span class="hljs-keyword">IN</span>(<span class="hljs-keyword">SELECT</span> nursing_unit_idFROM nursing_unitsWHERE beds &lt; <span class="hljs-number">10</span>)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> nursing_unit_id, patient_id
</code></pre>
</li>
<li>Nested Subquery<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> nursing_unit_id, <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> patients
<span class="hljs-keyword">FROM</span> admissionsWHERE nursing_unit_id <span class="hljs-keyword">IN</span>
(<span class="hljs-keyword">SELECT</span> nursing_unit_id
<span class="hljs-keyword">FROM</span> nursing_units
<span class="hljs-keyword">WHERE</span> beds &gt;(<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">AVG</span>(beds)<span class="hljs-keyword">FROM</span> nursing_units))
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> nursing_unit_id
</code></pre>
</li>
<li>Subquery as a Table<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> (
<span class="hljs-keyword">SELECT</span> province_id, city, <span class="hljs-keyword">COUNT</span>(*) citycount
<span class="hljs-keyword">FROM</span> patients
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> province_id, city)
<span class="hljs-keyword">WHERE</span> city <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&apos;H%&apos;</span>
</code></pre>
</li>
</ul>
</li>
<li>The like keyword can be used to specify a pattern, pattern is represented by:<ul>
<li><code>_</code> any value.</li>
<li><code>%</code> any group of values<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> employees
<span class="hljs-keyword">WHERE</span> FirstName <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&apos;A%&apos;</span>;
</code></pre>
</li>
</ul>
</li>
<li>This choose any text begin with <code>A</code>.</li>
<li>NOT LIKE picks anything that not in this pattern.</li>
<li>Clauses in SELECT should follow orders as <code>SELECT</code>, <code>FROM</code>, <code>WHERE</code>, <code>GROUP BY</code>, <code>HAVING</code>, <code>ORDER BY</code></li>
</ul>
<h3 id="union">Union</h3>
<ul>
<li><code>UNION</code> combines two or more <code>SELECT</code> statements with same type of columns(data type), removes any existing duplicates<ul>
<li>If one column can&#x2019;t match the data type, use null instead<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> FirstName, LastName, Company <span class="hljs-keyword">FROM</span> businessContacts
<span class="hljs-keyword">UNION</span>
<span class="hljs-keyword">SELECT</span> FirstName, LastName, <span class="hljs-literal">NULL</span> <span class="hljs-keyword">FROM</span> otherContacts;
</code></pre>
</li>
</ul>
</li>
<li><code>UNION ALL</code> works faster, and it does not remove duplicate rows</li>
</ul>
<h3 id="built-in-function">Built-in Function</h3>
<ul>
<li>Scalar Functions &#x2013; Returns Single value.</li>
<li><p>Column Function - works with a set of value.</p>
</li>
<li><p>Mathematical Functions</p>
<ul>
<li>ABS</li>
<li>ACOS</li>
<li>ASIN</li>
<li>ATAN</li>
<li>ATN2</li>
<li>CEILING</li>
<li>COS</li>
<li>COT</li>
<li>DEGREES</li>
<li>EXP</li>
<li>FLOOR</li>
<li>LOG</li>
<li>LOG10</li>
<li>PI</li>
<li>POWER</li>
<li>RADIANS</li>
<li>RAND</li>
<li>ROUND</li>
<li>SIGN</li>
<li>SIN</li>
<li>SQRT</li>
<li>SQUARE</li>
<li>TAN</li>
</ul>
</li>
<li>String Functions<ul>
<li>ASCII</li>
<li>CHAR</li>
<li>CHARINDEX</li>
<li>DIFFERENCE</li>
<li>LEFT</li>
<li>LEN</li>
<li>LOWER</li>
<li>LTRIM</li>
<li>NCHAR</li>
<li>PATINDEX</li>
<li>QUOTENAME</li>
<li>REPLACE</li>
<li>REPLICATE</li>
<li>REVERSE</li>
<li>RTRIM</li>
<li>SOUNDEX</li>
<li>SPACE</li>
<li>STR</li>
<li>STUFF</li>
<li>SUBSTRING</li>
<li>UNICODE</li>
<li>UPPER</li>
</ul>
</li>
<li>Date And Time Functions<ul>
<li>CURRENT_TIMESTAMP</li>
<li>DATEDIFF(datepartType, startdate, enddate)<ul>
<li>datepartType: year, quarter, month, dayofyear, day, week, hour, minute, second, millisecond, microsecond, nanonsecond</li>
<li>Be careful, DATEDIFF with YEAR does not calculate age. A person born on November 15, 1999 is not 19 on October 2, 2018. Use the following way to calculate.<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEDIFF</span>(<span class="hljs-keyword">DAY</span>, <span class="hljs-string">&apos;2017-01-01&apos;</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">608</span> <span class="hljs-keyword">days</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEDIFF</span>(<span class="hljs-keyword">MONTH</span>, <span class="hljs-string">&apos;2017-01-01&apos;</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">20</span> <span class="hljs-keyword">months</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEDIFF</span>(<span class="hljs-keyword">YEAR</span>, <span class="hljs-string">&apos;1999-11-15&apos;</span>, <span class="hljs-string">&apos;2018-10-02&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">19</span> <span class="hljs-keyword">years</span>
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">FLOOR</span>(<span class="hljs-keyword">DATEDIFF</span>(<span class="hljs-keyword">DAY</span>, <span class="hljs-string">&apos;1999-11-15&apos;</span>, <span class="hljs-string">&apos;2018-10-02&apos;</span>) / <span class="hljs-number">365.25</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">18</span> <span class="hljs-keyword">years</span>
</code></pre>
</li>
</ul>
</li>
<li>DATEDIFF extracts the YEAR from both dates and performs subtraction without considering the months or days</li>
<li>DATEADD(datepart, number, date)<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEADD</span>(<span class="hljs-keyword">DAY</span>, <span class="hljs-number">60</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">2018</span><span class="hljs-number">-10</span><span class="hljs-number">-31</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEADD</span>(<span class="hljs-keyword">MONTH</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">2019</span><span class="hljs-number">-02</span><span class="hljs-number">-01</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEADD</span>(<span class="hljs-keyword">YEAR</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">2021</span><span class="hljs-number">-09</span><span class="hljs-number">-01</span>
</code></pre>
</li>
<li>use DATEADD with negative values<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEADD</span>(<span class="hljs-keyword">DAY</span>, <span class="hljs-number">-60</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">2018</span><span class="hljs-number">-07</span><span class="hljs-number">-03</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEADD</span>(<span class="hljs-keyword">MONTH</span>, <span class="hljs-number">-5</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">2018</span><span class="hljs-number">-04</span><span class="hljs-number">-01</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEADD</span>(<span class="hljs-keyword">YEAR</span>, <span class="hljs-number">-3</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">2015</span><span class="hljs-number">-09</span><span class="hljs-number">-01</span>
</code></pre>
</li>
<li>DATENAME(datepart, date) works like DATEPART but returns a string instead of an integer<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> encounter_date_time,
      <span class="hljs-keyword">DATENAME</span>(<span class="hljs-keyword">HOUR</span>, encounter_date_time) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">hour</span>],
      <span class="hljs-keyword">DATENAME</span>(<span class="hljs-keyword">MINUTE</span>, encounter_date_time) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">minute</span>],
      <span class="hljs-keyword">DATENAME</span>(<span class="hljs-keyword">SECOND</span>, encounter_date_time) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">second</span>]
<span class="hljs-keyword">FROM</span> encounters
</code></pre>
</li>
<li>DATEPART(datepart, date)<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> encounter_date_time,
      <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">HOUR</span>, encounter_date_time) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">hour</span>],
      <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">MINUTE</span>, encounter_date_time) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">minute</span>],
      <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">SECOND</span>, encounter_date_time) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">second</span>]
<span class="hljs-keyword">FROM</span> encounters
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span>  <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">YEAR</span>, <span class="hljs-keyword">Timestamp</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&apos;Year&apos;</span>,
        <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">MONTH</span>, <span class="hljs-keyword">Timestamp</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&apos;Month&apos;</span>,
        <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">DAY</span>, <span class="hljs-keyword">Timestamp</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&apos;Day&apos;</span>,
        <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> <span class="hljs-string">&apos;Visits&apos;</span>
<span class="hljs-keyword">FROM</span>      tblVisits
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>  <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">DAY</span>, <span class="hljs-keyword">Timestamp</span>),
          <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">MONTH</span>, <span class="hljs-keyword">Timestamp</span>),
          <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">YEAR</span>, <span class="hljs-keyword">Timestamp</span>)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>  <span class="hljs-string">&apos;Year&apos;</span>,
          <span class="hljs-string">&apos;Month&apos;</span>,
          <span class="hljs-string">&apos;Day&apos;</span>
</code></pre>
</li>
<li>DAY(date) extracts the day of the month</li>
<li>MONTH(date) extracts the month of the year</li>
<li>YEAR(date) extracts the year<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> birth_date,
      <span class="hljs-keyword">YEAR</span>(birth_date) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">year</span>],
      <span class="hljs-keyword">MONTH</span>(birth_date) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">month</span>],
      <span class="hljs-keyword">DAY</span>(birth_date) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">day</span>]
<span class="hljs-keyword">FROM</span> patients
</code></pre>
</li>
<li>The GETDATE function returns the current date with time<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">GETDATE</span>()
</code></pre>
</li>
<li>To get the date without the time, the CONVERT function can be used<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">CONVERT</span>(<span class="hljs-built_in">DATE</span>, <span class="hljs-keyword">GETDATE</span>())
</code></pre>
</li>
<li>Calculate patient age<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> birth_date,
      <span class="hljs-keyword">FLOOR</span>(<span class="hljs-keyword">DATEDIFF</span>(<span class="hljs-keyword">DAY</span>, birth_date, <span class="hljs-keyword">GETDATE</span>()) / <span class="hljs-number">365.25</span>)
<span class="hljs-keyword">FROM</span> patients
</code></pre>
</li>
<li>GETUTCDATE</li>
<li>ISDATE</li>
<li>MONTH</li>
<li>SWITCHOFFSET</li>
<li>TODATETIMEOFFSET</li>
<li>YEAR</li>
</ul>
</li>
</ul>
<h3 id="join">Join</h3>
<ul>
<li>Table names can use nickname, set after <code>FROM</code> clause, e.g. <code>FROM tablename alias</code></li>
<li>Columns that appear in multiple tables must be table prefixed(ususally use alias for short) to prevent ambiguity<ul>
<li><code>alias.*</code> means all columns from table <code>alias</code></li>
</ul>
</li>
<li>MySQL only supports some basic join types like inner and outer</li>
</ul>
<h4 id="inner-join">Inner Join</h4>
<ul>
<li>Rows returned only if they exist in both tables</li>
<li><code>INNER</code> in the query is optional<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">column</span>
<span class="hljs-keyword">FROM</span> firsttable
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> secondtable
<span class="hljs-keyword">ON</span> firsttable.<span class="hljs-keyword">column</span> = secondtable.<span class="hljs-keyword">column</span>
</code></pre>
</li>
<li>Select all columns from both tables, Join on purchase order id<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> purchase_orders
<span class="hljs-keyword">JOIN</span> purchase_order_lines
<span class="hljs-keyword">ON</span> purchase_orders.purchase_order_id = purchase_order_lines.purchase_order_id
</code></pre>
</li>
<li>Optionally, the old pre ANSI 92 syntax<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> ct.<span class="hljs-keyword">ID</span>, ct.<span class="hljs-keyword">Name</span>, <span class="hljs-keyword">ord</span>.<span class="hljs-keyword">Name</span>, <span class="hljs-keyword">ord</span>.Amount
<span class="hljs-keyword">FROM</span> customers <span class="hljs-keyword">AS</span> ct, orders <span class="hljs-keyword">AS</span> <span class="hljs-keyword">ord</span>
<span class="hljs-keyword">WHERE</span> ct.<span class="hljs-keyword">ID</span>=<span class="hljs-keyword">ord</span>.Customer_ID
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ct.<span class="hljs-keyword">ID</span>;
</code></pre>
</li>
</ul>
<h4 id="outer-join">Outer Join</h4>
<ul>
<li>It can be either <code>LEFT OUTER JOIN</code> or <code>RIGHT OUTER JOIN</code></li>
<li>Keyword <code>OUTTER</code> is optional</li>
<li>The <code>LEFT OUTTER JOIN</code> returns all rows from the first table, even if there are no matches in the right table</li>
<li>The <code>RIGHT OUTTER JOIN</code> returns all rows from the second table, even if there are no matches in the right table<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> table1.column1, table2.column2
<span class="hljs-keyword">FROM</span> table1 <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">OUTER</span> <span class="hljs-keyword">JOIN</span> table2
<span class="hljs-keyword">ON</span> table1.column_name = table2.column_name;
</code></pre>
</li>
<li>If no match is found for a particular row, NULL is returned</li>
<li>Excluding records that both tables have<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> tableA A
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> tableB B <span class="hljs-keyword">ON</span> A.<span class="hljs-keyword">key</span> = B.<span class="hljs-keyword">key</span>
<span class="hljs-keyword">WHERE</span> B.<span class="hljs-keyword">key</span> <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>
</code></pre>
</li>
<li>Optionally, old syntax for left outer join<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> s.item_id, p.item_id, quantity_sold, quantity_purchased
<span class="hljs-keyword">FROM</span> sales s, purchases p
<span class="hljs-keyword">WHERE</span> s.item_id = p.item_id(+)
</code></pre>
</li>
</ul>
<h4 id="natural-join">Natural Join</h4>
<ul>
<li>The database will decide which columns from both tables are used to join, based on the names and data types</li>
<li>Table prefixes are not required<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> patient_id, nursing_unit_id, room, bed
<span class="hljs-keyword">FROM</span> patients
<span class="hljs-keyword">NATURAL</span> <span class="hljs-keyword">JOIN</span> admissions
</code></pre>
</li>
</ul>
<h4 id="full-outer-join">Full Outer Join</h4>
<ul>
<li>All rows returned from both tables</li>
<li>Missing values returned as NULL<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> s.item_id, p.item_id, quantity_sold, quantity_purchased
<span class="hljs-keyword">FROM</span> sales s
<span class="hljs-keyword">FULL</span> <span class="hljs-keyword">OUTER</span> <span class="hljs-keyword">JOIN</span> purchases p <span class="hljs-keyword">ON</span> s.item_id = p.item_id
</code></pre>
</li>
<li>To exclude records that both tables have<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> tableA A
<span class="hljs-keyword">FULL</span> <span class="hljs-keyword">OUTER</span> <span class="hljs-keyword">JOIN</span> tableB B
<span class="hljs-keyword">ON</span> A.<span class="hljs-keyword">key</span> = B.<span class="hljs-keyword">key</span>
<span class="hljs-keyword">WHERE</span> A.<span class="hljs-keyword">key</span> <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">OR</span> B.<span class="hljs-keyword">key</span> <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>
</code></pre>
</li>
</ul>
<h4 id="cross-join">Cross Join</h4>
<ul>
<li>Each row from left table is joined with each row from right table</li>
<li>If <code>table_a</code> has <code>x</code> rows, <code>table_b</code> has <code>y</code> rows. the cross join of them has <code>x</code> multiply by <code>y</code> rows.<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> p.product_id, sold, purchased
<span class="hljs-keyword">FROM</span> sales_lines s
<span class="hljs-keyword">CROSS</span> <span class="hljs-keyword">JOIN</span> purchase_lines p
</code></pre>
</li>
<li>optionally, cross join can be expressed as:<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> ct.<span class="hljs-keyword">ID</span>, ct.<span class="hljs-keyword">Name</span>, <span class="hljs-keyword">ord</span>.<span class="hljs-keyword">Name</span>, <span class="hljs-keyword">ord</span>.Amount
<span class="hljs-keyword">FROM</span> customers ct, orders <span class="hljs-keyword">ord</span>
</code></pre>
</li>
</ul>
<h4 id="self-join">Self Join</h4>
<ul>
<li>A table Join on itself using any types of join<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> e1.employee_id, e1.first_name, e1.last_name, e1.department, e1.title, e1.supervisor, e2.employee_id, e2.first_name, e2.last_name
<span class="hljs-keyword">FROM</span> employees e1
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> employees e2 - - <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">using</span> <span class="hljs-keyword">LEFT</span>, somebody will be <span class="hljs-keyword">missing</span>.
<span class="hljs-keyword">ON</span> e1.supervisor = e2.employee_id
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> e1.department, e1.employee_id
</code></pre>
</li>
</ul>
<h4 id="join-multiple-tables">Join Multiple Tables</h4>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> first_name, last_name, medication_description, dosage
<span class="hljs-keyword">FROM</span> patients p
<span class="hljs-keyword">JOIN</span> unit_dose_orders u
<span class="hljs-keyword">ON</span> p.patient_id = u.patient_id
<span class="hljs-keyword">JOIN</span> medications m
<span class="hljs-keyword">ON</span> u.medication_id = m.medication_id
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> last_name, first_name, medication_description
</code></pre>
<h3 id="view">View</h3>
<ul>
<li><code>VIEW</code> is a virtual table that is based on the result-set of an SQL statement</li>
<li>The View result set is not permanently stored in the database, but generated and executed each time it is used</li>
<li>A <code>VIEW</code> can be modified by an <code>UPDATE</code>, <code>INSERT</code> or <code>DELETE</code> provided it doesn&#x2019;t use any of the following<ul>
<li>Set operations (UNION, UNION ALL, INTERSECT, MINUS)</li>
<li>Group functions (AVG, COUNT, MAX, MIN, SUM)&#x2013;GROUP BY or HAVING clauses</li>
<li>CONNECT BY or START WITH clauses</li>
<li>DISTINCT operator&#x2013;ROWNUM pseudocolumn</li>
</ul>
</li>
<li>For Oracle use <code>GRANT CREATE VIEW TO tableA;</code> to grant permission</li>
<li>Create a view<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> current_patients
<span class="hljs-keyword">AS</span>
<span class="hljs-keyword">SELECT</span> a.patient_id, first_name, last_name, nursing_unit_id, room
<span class="hljs-keyword">FROM</span> patients p
<span class="hljs-keyword">JOIN</span> admissions a
<span class="hljs-keyword">ON</span> p.patient_id = a.patient_id
<span class="hljs-keyword">WHERE</span> discharge_date <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>
</code></pre>
</li>
<li>Once generated, View can be later query as a normal table<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> current_patients
</code></pre>
</li>
<li>A view always shows up-to-date data.</li>
<li>When use <code>SUBSTRING()</code> function in a view columns names must have alias(new name after AS)</li>
<li>Update view<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">VIEW</span> view_name <span class="hljs-keyword">AS</span>
<span class="hljs-keyword">SELECT</span> column_name(s)
<span class="hljs-keyword">FROM</span> table_name
<span class="hljs-keyword">WHERE</span> condition;
</code></pre>
<ul>
<li><code>REPLACE</code> is used to replace the view, if it has already been created,</li>
</ul>
</li>
<li>Delete View<pre><code class="lang-sql"><span class="hljs-keyword">Delete</span> <span class="hljs-keyword">view</span>,
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">VIEW</span> <span class="hljs-keyword">List</span>;
</code></pre>
</li>
</ul>
<h3 id="insert">Insert</h3>
<ul>
<li>Insert a single row to the database<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> table_name
<span class="hljs-keyword">VALUES</span> (value1, value2, value3);
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> dental_services
<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">101</span>, <span class="hljs-string">&apos;Tricky Extraction&apos;</span>, <span class="hljs-string">&apos;E&apos;</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>);
</code></pre>
</li>
<li>New row will be added at the bottom. Order is important.</li>
<li>Must include a value for columns that have no default values or don&#x2019;t allow null.</li>
<li><code>PK</code> value can be omitted, identity property will be used.</li>
<li>Alternatively, you can specify the table&apos;s column names, then it is also possible to insert data into specific columns<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> table_name (column2, column4)
<span class="hljs-keyword">VALUES</span> (value2, value4);
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> dental_services
(service_id, service_description, service_type, hourly_rate, sales_ytd)
<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">302</span>, <span class="hljs-string">&apos;Temporary Filling&apos;</span>, <span class="hljs-string">&apos;F&apos;</span>, <span class="hljs-number">100</span>, <span class="hljs-number">0</span>)
</code></pre>
</li>
<li>When omit one column, its value will be set to NULL.</li>
<li>Multiple rows of value can be inserted in one statement after <code>VALUE</code> separated by comma.<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> dental_services
(service_id, service_description, service_type, hourly_rate, sales_ytd)
<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">302</span>, <span class="hljs-string">&apos;Temporary Filling&apos;</span>, <span class="hljs-string">&apos;F&apos;</span>, <span class="hljs-number">100</span>, <span class="hljs-number">0</span>),(<span class="hljs-number">303</span>,<span class="hljs-string">&apos;Temp&apos;</span>,<span class="hljs-string">&apos;T&apos;</span>,<span class="hljs-number">230.0</span>)
</code></pre>
</li>
<li>One can insert multiple rows<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> tablename[(column1, column2, column3, column4)]
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">statement</span>
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> dental_service_archives(service_id, service_description, service_type, hourly_rate, sales_ytd)
<span class="hljs-keyword">SELECT</span> service_id, service_description, service_type, hourly_rate, sales_ytd
<span class="hljs-keyword">FROM</span> dental_services
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> dental_service_archives(service_id, service_description, service_type, hourly_rate, sales_ytd)
<span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> dental*services
<span class="hljs-keyword">WHERE</span> sales_ytd &gt;= <span class="hljs-number">500</span>
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> dental_service_archives
<span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> dental_services
</code></pre>
<ul>
<li>if column names are not specified, all columns must have values<pre><code class="lang-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> dental_service_archives(service_id, service_description)
<span class="hljs-keyword">SELECT</span> service_id, service_description
<span class="hljs-keyword">FROM</span> dental_services
</code></pre>
</li>
<li>omitted column will be null</li>
</ul>
</li>
</ul>
<h3 id="update">Update</h3>
<ul>
<li>Update a single row<pre><code class="lang-sql"><span class="hljs-keyword">UPDATE</span> departments
<span class="hljs-keyword">SET</span> manager_first_name = <span class="hljs-string">&apos;Bob&apos;</span>, manager_last_name = <span class="hljs-string">&apos;Loblaw&apos;</span>
<span class="hljs-keyword">WHERE</span> department_id = <span class="hljs-number">5</span>
</code></pre>
</li>
<li>select multi rows and apply updates using formula<pre><code class="lang-sql"><span class="hljs-keyword">UPDATE</span> items
<span class="hljs-keyword">SET</span> item_cost = item_cost * <span class="hljs-number">1.1</span>
<span class="hljs-keyword">WHERE</span> primary_vendor_id = <span class="hljs-number">5</span>
</code></pre>
</li>
<li>Updating A Single Row With A Subquery<pre><code class="lang-sql"><span class="hljs-keyword">UPDATE</span> purchase_orders
<span class="hljs-keyword">SET</span> total_amount = (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">SUM</span>(quantity * unit_cost)<span class="hljs-keyword">FROM</span> purchase_order_linesWHERE purchase_order_id = <span class="hljs-number">10</span>)
<span class="hljs-keyword">WHERE</span> purchase_order_id = <span class="hljs-number">1</span>
</code></pre>
</li>
<li>If the WHERE clause is omitted, all records in the table will be updated</li>
</ul>
<h3 id="delete">Delete</h3>
<ul>
<li>The <code>DELETE</code> statement removes the data from the table permanently.</li>
<li>Delete a single row<pre><code class="lang-sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> dental_services
<span class="hljs-keyword">WHERE</span> service_id = <span class="hljs-number">301</span>
</code></pre>
</li>
<li><code>FROM</code> is optional</li>
<li>Deletion can fail if the PK has a reference to other table.</li>
<li>Delete multiple rows.<pre><code class="lang-sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> sales
<span class="hljs-keyword">WHERE</span> amount &gt;= <span class="hljs-number">100</span>
</code></pre>
</li>
<li>If <code>WHERE</code> clause is omitted, all records in the table will be deleted<ul>
<li><code>DELETE table_name;</code></li>
</ul>
</li>
</ul>
<h3 id="constraints">Constraints</h3>
<ul>
<li>During table creation, specify column level constraint(s) after the data type of that column.</li>
<li>NULL<ul>
<li>All data types support the concept of NULL</li>
<li>NULL is the absence of a value, it is unknown</li>
<li>For a numeric column NULL is not 0</li>
<li>For a string column NULL is not &apos;&apos;</li>
</ul>
</li>
<li>Primary Key<ul>
<li>Define it as a primary key</li>
<li>PRIMARY KEY (UserID)</li>
</ul>
</li>
<li>Not Null
name varchar(100) NOT NULL</li>
<li>Unique</li>
<li>Default<ul>
<li>Default value will set for the new column, if not default value then all null.</li>
</ul>
</li>
<li>Check<ul>
<li>Determines whether the value is valid or not from a logical expression.</li>
</ul>
</li>
<li>Auto increment<ul>
<li>the starting value for AUTO_INCREMENT is 1, and it will increment by 1 for each new record.</li>
<li>UserID int NOT NULL AUTO_INCREMENT</li>
</ul>
</li>
</ul>
<h3 id="create-table">Create Table</h3>
<ul>
<li>A single database can house hundreds of tables<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> table_name
(column_name1 data_type(<span class="hljs-keyword">size</span>),
column_name2 data_type(<span class="hljs-keyword">size</span>),
column_name3 data_type(<span class="hljs-keyword">size</span>));
</code></pre>
</li>
<li>Create Table with Constraints<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">Users</span>
(
UserID <span class="hljs-built_in">int</span>,
FirstName <span class="hljs-built_in">varchar</span>(<span class="hljs-number">100</span>),
LastName <span class="hljs-built_in">varchar</span>(<span class="hljs-number">100</span>),
City <span class="hljs-built_in">varchar</span>(<span class="hljs-number">100</span>),
PRIMARY <span class="hljs-keyword">KEY</span>(UserID)
);
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> employees
(employee_id <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
employee_name <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
department_id <span class="hljs-built_in">INT</span>,
job_id <span class="hljs-built_in">CHAR</span>(<span class="hljs-number">3</span>),
birth_date <span class="hljs-built_in">DATE</span>,
gender <span class="hljs-built_in">CHAR</span>(<span class="hljs-number">1</span>),
salary <span class="hljs-built_in">DECIMAL</span>(<span class="hljs-number">8</span>, <span class="hljs-number">2</span>),
<span class="hljs-keyword">CONSTRAINT</span> PK_employees PRIMARY <span class="hljs-keyword">KEY</span>(employee_id),
<span class="hljs-keyword">CONSTRAINT</span> CK_gender <span class="hljs-keyword">CHECK</span>(gender <span class="hljs-keyword">IN</span> (<span class="hljs-string">&apos;M&apos;</span>, <span class="hljs-string">&apos;F&apos;</span>)),
<span class="hljs-keyword">CONSTRAINT</span> CK_salary <span class="hljs-keyword">CHECK</span>(salary &gt;= <span class="hljs-number">0</span>),
<span class="hljs-keyword">CONSTRAINT</span> FK_employees_department_id_departments FOREIGN <span class="hljs-keyword">KEY</span>(department_id) <span class="hljs-keyword">REFERENCES</span> departments(department_id))
</code></pre>
</li>
<li>Table Creation Example with IDENTITY and Constraints Specified Inline<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> employees_with_identity
(employee_id <span class="hljs-built_in">INT</span> <span class="hljs-keyword">IDENTITY</span> PRIMARY <span class="hljs-keyword">KEY</span>,
employee_name <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
department_id <span class="hljs-built_in">INT</span> FOREIGN <span class="hljs-keyword">KEY</span> <span class="hljs-keyword">REFERENCES</span> departments(department_id),
job_id <span class="hljs-built_in">CHAR</span>(<span class="hljs-number">3</span>),
birth_date <span class="hljs-built_in">DATE</span>,
gender <span class="hljs-built_in">CHAR</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">CHECK</span>(gender <span class="hljs-keyword">IN</span> (<span class="hljs-string">&apos;M&apos;</span>, <span class="hljs-string">&apos;F&apos;</span>)),
salary <span class="hljs-built_in">DECIMAL</span>(<span class="hljs-number">8</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">CHECK</span>(salary &gt;= <span class="hljs-number">0</span>))
</code></pre>
</li>
<li>Other Examples:<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> TableName (
ColumnName1 DataType[(<span class="hljs-keyword">size</span>)][<span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>] [<span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">value</span>],
ColumnName2 DataType[(<span class="hljs-keyword">size</span>)][<span class="hljs-keyword">not</span> <span class="hljs-literal">null</span>] [<span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">value</span>],
[<span class="hljs-keyword">CONSTRAINT</span> CK_ConstraintName
<span class="hljs-keyword">CHECK</span> (ConstraintCheckCondition),]
    <span class="hljs-keyword">CONSTRAINT</span> PK_ConstraintName
              PRIMARY <span class="hljs-keyword">KEY</span>(ColumnName[, ColumnName]
[,<span class="hljs-keyword">CONSTRAINT</span> FK_ConstraintName
FOREIGN <span class="hljs-keyword">KEY</span> (ColumnName)
<span class="hljs-keyword">REFERENCES</span> TableName (ColumnName)
<span class="hljs-keyword">ON</span> <span class="hljs-keyword">DELETE</span> RESTRICT
<span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> RESTRICT]
)
</code></pre>
</li>
</ul>
<h3 id="create-index">Create Index</h3>
<ul>
<li>Create an index<pre><code class="lang-sql"><span class="hljs-keyword">Create</span> [<span class="hljs-keyword">UNIQUE</span>][clustered] <span class="hljs-keyword">INDEX</span> index_name
<span class="hljs-keyword">ON</span> table_name
(column_name1 [ <span class="hljs-keyword">ASC</span>/<span class="hljs-keyword">DESC</span> ].
...
column_nameN [ <span class="hljs-keyword">ASC</span>/<span class="hljs-keyword">DESC</span> ]
</code></pre>
</li>
<li>Ex:<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> STJ_patients_last_name
<span class="hljs-keyword">ON</span> patients
(last_name <span class="hljs-keyword">ASC</span>)
</code></pre>
</li>
</ul>
<h3 id="sequences">Sequences</h3>
<ul>
<li>A Sequence is a database object used to generate unique numbers</li>
<li>CURRVAL returns the current value of the sequence</li>
<li>NEXTVAL returns the next value of the sequence</li>
<li>Create a sequence, <code>CREATE SEQUENCE sequence_name [INCREMENT BY value]</code></li>
<li>Access a Sequence, <code>sequence_name.CURRVAL</code>, or <code>sequence_name.NEXTVAL</code><ul>
<li><code>INSERT INTO tableName VALUES(sequence_name.NEXTVAL);</code></li>
</ul>
</li>
</ul>
<h3 id="alter-table">Alter Table</h3>
<ul>
<li>The ALTER TABLE command is used to add, delete, or modify columns and their constraints in an existing table</li>
<li>Add new columns<pre><code class="lang-sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> People
<span class="hljs-keyword">ADD</span> DateOfBirth;
</code></pre>
</li>
<li>Delete columns<pre><code class="lang-sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> People
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">COLUMN</span> DateOfBirth;
</code></pre>
</li>
<li>Delete entire table, <code>DROP TABLE People;</code></li>
<li>Rename columns<pre><code class="lang-sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> People
<span class="hljs-keyword">CHANGE</span> FirstName <span class="hljs-keyword">name</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">100</span>);
</code></pre>
</li>
<li>Rename tables, <code>RENAME TABLE People TO Users;</code></li>
</ul>
<h2 id="sql-script">SQL Script</h2>
<ul>
<li>the script put multiple SQL statement together one by one in a file.</li>
<li>the script file has an extension of <code>.sql</code></li>
<li>each statement requires <code>;</code> in the end</li>
<li>Excel can build inserts statements</li>
<li>When work with scripts in database management software always select the correct table or database before execution</li>
<li>Syntax<ul>
<li>lexical units:<ul>
<li>Identifiers &#x2013; begin with a letter and may be up to 30 characters long</li>
<li>Reserved words &#x2013; such as SELECT, BEGIN, END</li>
<li>Delimiters &#x2013; characters with special meaning, such as <code>+</code> <code>-</code> <code>&apos;</code> <code>&gt;</code> <code>(</code> <code>:=</code> <code>||</code> <code>/*</code> <code>--</code> etc.</li>
<li>Literals &#x2013; such as <code>123</code>, <code>&apos;Hello World&apos;</code>, <code>FALSE</code></li>
<li>Comments &#x2013; single line comments <code>--</code> or mutli-line comments <code>/* */</code></li>
</ul>
</li>
<li>Scope And Labels<ul>
<li>Variables and other structures are scoped local to their block</li>
<li>Labels are enclosed in <code>&lt;&lt; label &gt;&gt;</code></li>
<li>Labels can be added to the top of any blocks to improve readability and to qualify identifiers</li>
<li>The name of the block must precede the first line of executable code (BEGIN or DECLARE)</li>
</ul>
</li>
</ul>
</li>
<li>A group of sql command is called a batch in sql script.</li>
<li><code>BEGIN</code>, <code>END</code>, is used to enclose a block of PL, like <code>{}</code></li>
</ul>
<h3 id="useful-command">Useful Command</h3>
<ul>
<li>Oracle<ul>
<li><code>SET SERVEROUTPUT ON;</code> enable output</li>
<li><code>CLEAR SCREEN;</code> clears the output window</li>
<li><code>SET VERIFY OFF;</code> suppress new and old impact of substitution variable</li>
<li><code>SET NLS_DATE_FORMAT = &apos;DD-MON-YYYY</code> set the date input format</li>
<li><code>ALTER SESSION</code> only make changes to the current session<ul>
<li>The statement stays in effect until you disconnect from the database</li>
<li><code>ALTER SESSION SET NLS_DATE_FORMAT = &apos;DD-MON-YYYY</code></li>
</ul>
</li>
</ul>
</li>
<li>MySQL<ul>
<li>GO statements is used at the end of each batch, no <code>;</code> followed. It can be followed by an integer that repeats the batch for certain time. When a batch fails other batches will still be executed.</li>
<li>Some <code>CREATE</code> and <code>INSERT</code> statements require that they are the first statement in a batch.</li>
<li><code>SET</code> commands can be used to change session settings.</li>
<li>Examples SQL Server:<pre><code class="lang-sql"><span class="hljs-comment">-- Suppress INSERT, UPDATE and DELETE completion messages</span>
<span class="hljs-keyword">SET</span> NOCOUNT <span class="hljs-keyword">ON</span>
<span class="hljs-comment">-- Set date format to YYYY-MM-DD</span>
<span class="hljs-keyword">SET</span> DATEFORMAT ymd;
<span class="hljs-comment">-- Make the master database the current database</span>
<span class="hljs-keyword">USE</span> <span class="hljs-keyword">master</span>
<span class="hljs-comment">-- If database co859 exists, drop it</span>
<span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> (<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> sysdatabases <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">name</span> = <span class="hljs-string">&apos;co859&apos;</span>)
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">DATABASE</span> co859;
GO
<span class="hljs-comment">-- Print statement in the script print string in console, when it is executed. For Microsoft SQL manegement output setting need to be changed to text.</span>
PRINT &apos;Verification&apos;
<span class="hljs-comment">-- Create the co859 database</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> co859;
GO
<span class="hljs-comment">-- Make the co859 database the current database</span>
<span class="hljs-keyword">USE</span> co859;
</code></pre>
</li>
<li>SET DATEFORMAT format, format can be:<ul>
<li>dmy (Preferred in much of the world)</li>
<li>mdy (Preferred in USA)</li>
<li>ymd (Unambiguous, best choice, SQL Server default)</li>
<li>ydm (Should be avoided)</li>
<li>myd (Should be avoided)</li>
<li>dym (Should be avoided)</li>
</ul>
</li>
<li>CREATE User statement creates a new entry in the user table that has no privileges.</li>
<li>GRANT is then used to control the access and privileges the user has<ul>
<li><code>GRANT Create ON &lt;Database&gt; TO &lt;Source&gt;</code></li>
</ul>
</li>
<li>Sources can be<ul>
<li><code>smith@localhost</code> &#x2013; this account will be granted access only when accessing the data locally, not remotely</li>
<li><code>RSingh@&apos;192.168.1.%&apos;</code> &#x2013; this account will be granted access only when accessing the data from a host with an IP address that begins with <code>192.168.1</code></li>
<li><code>DNguyen</code> &#x2013; this account will be granted access from any host, local or not (translates to DNguyen@&#x2019;%&#x2019;)</li>
</ul>
</li>
<li><code>create database databaseName</code> create a new database.</li>
<li><code>grant select on databaseName.* to userName@localhost identified by &apos;newPassword&apos;</code> create new database user with local connection and only be allowed to select records.</li>
<li><code>use databaseName</code> set the database as default database.</li>
<li><code>describe tableName;</code> view details about certain table.</li>
<li><code>exit;</code> exit the mysql interface.</li>
</ul>
</li>
</ul>
<h3 id="procedural-language">Procedural Language</h3>
<ul>
<li>Many of the procedure languages supports variables, conditions, loops and exceptions</li>
<li>It adds logic to the SQL scripts</li>
<li>Each database vendor extends SQL with procedural code:<ul>
<li>Microsoft uses T-SQL</li>
<li>Oracle uses Procedural Language SQL (PL/SQL)<ul>
<li>Based on Ada</li>
</ul>
</li>
<li>IBM uses SQL Procedural Language (SQL PL)</li>
<li>MySQL uses SQL/Persistent Stored Module (SQL/PSM)</li>
</ul>
</li>
<li>Data Definition Language (CREATE, DROP, ALTER, etc.) is not valid in PL/SQL</li>
<li>DML (INSERT, UPDATE, DELETE) and SELECT are valid in PL/SQL</li>
</ul>
<h3 id="oracle-scripts">Oracle Scripts</h3>
<h4 id="built-in-functions">Built-in Functions</h4>
<ul>
<li>TO_CHAR<ul>
<li>TO_CHAR converts its arguments into a VARCHAR2 with optional formatting</li>
<li>TO_CHAR(value[, format_mask])<ul>
<li><code>TO_CHAR(AVG(cost), &apos;$9,999.99&apos;)</code></li>
<li><code>TO_CHAR(SYSDATE, &apos;DD-MONTH-YYYY</code></li>
<li><code>TO_CHAR(SYSDATE, &apos;HH:MI:SS&apos;)</code></li>
<li><code>TO_CHAR(SYSDATE, &apos;FMDD-MONTH-YYYY&apos;)</code><ul>
<li><code>FM</code> - Fill mode controls blank padding and leading zero suppression</li>
</ul>
</li>
<li><code>TO_CHAR(12345.678, &apos;099,999)</code></li>
<li><code>TRIM(TO_CHAR(v_total, &apos;$999G999G999D99&apos;))</code></li>
</ul>
</li>
<li>TO_CHAR(character)</li>
<li>TO_CHAR(datetime)</li>
<li>TO_CHAR(number)</li>
</ul>
</li>
<li>TO_DATE(SYSDATE), convert <code>SYSDATE</code> to <code>DATE</code></li>
</ul>
<h4 id="procedural-code-blocks">Procedural Code Blocks</h4>
<ul>
<li>The basic unit of organization in <code>PL</code> is the block</li>
<li><code>PL</code> blocks can be named or anonymous</li>
<li>Named blocks can be stored in the database</li>
<li>Blocks can be nested</li>
<li>END block types need to have <code>;</code></li>
<li>Structure<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  <span class="hljs-comment">-- Declaration statements</span>
  <span class="hljs-comment">-- Declear Types</span>
  v_first_name VARCHAR2(<span class="hljs-number">35</span>);
  <span class="hljs-comment">-- Use column&apos;s data type to declear (anchored variable declaration)</span>
  v_last_name students.last_name%TYPE;
  <span class="hljs-comment">--  Declear constant types and assign value</span>
  id CONSTANT NUMBER := 7;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-comment">-- Mandatory, Executable statements</span>
  <span class="hljs-comment">-- Use || between variable names and strings</span>
  <span class="hljs-keyword">SELECT</span> first_name, last_name
  <span class="hljs-keyword">INTO</span> v_first_name, v_last_name
  <span class="hljs-keyword">FROM</span> student
  <span class="hljs-keyword">WHERE</span> student_id = <span class="hljs-keyword">id</span>;
  <span class="hljs-comment">-- OUTPUT</span>
  DBMS_OUTPUT.PUT_LINE (&apos;Student name: &apos;||first_name ||&apos; &apos;|| last_name);
EXCEPTION
  <span class="hljs-comment">-- Exception-handling statements</span>
  WHEN NO_DATA_FOUND THEN
      DBMS_OUTPUT.PUT_LINE (&apos;No student is found&apos;);
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
</ul>
<h4 id="substitution-variables">Substitution Variables</h4>
<ul>
<li>Substitution variables get processed at run time</li>
<li>Substitution Variables, prompt for input in a pop-up after execution, <code>i_student_id NUMBER := &amp;input_student_id;</code></li>
<li>If a substitution variable appears more than once and <code>&amp;</code> is used, substitution is prompted for each time<ul>
<li>Use <code>&amp;&amp;</code> to prompt only once</li>
</ul>
</li>
<li>When prompting to fill a text variable, enclose substitution variable in quotes, <code>name VARCHAR2(5) := &apos;&amp;input_name&apos;;</code></li>
</ul>
<h4 id="conditional-structure">Conditional Structure</h4>
<ul>
<li>IF<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  v_num1 <span class="hljs-built_in">NUMBER</span> := &amp;first_number;
  v_num2 NUMBER := &amp;second_number;
  v_temp NUMBER;
<span class="hljs-keyword">BEGIN</span>
<span class="hljs-comment">-- if v_num1 is greater than v_num2 rearrange their values</span>
  <span class="hljs-keyword">IF</span> v_num1 &gt; v_num2 <span class="hljs-keyword">THEN</span>
    v_temp := v_num1;
    v_num1 := v_num2;
    v_num2 := v_temp;
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
  <span class="hljs-comment">-- display the values of v_num1 and v_num2</span>
  DBMS_OUTPUT.PUT_LINE (&apos;v_num1 = &apos;||v_num1);
  DBMS_OUTPUT.PUT_LINE (&apos;v_num2 = &apos;||v_num2);
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>IF/ELSE statements<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  v_num <span class="hljs-built_in">NUMBER</span> := &amp;sv_user_num;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-comment">-- test if the number provided by the user is even</span>
  <span class="hljs-keyword">IF</span> <span class="hljs-keyword">MOD</span>(v_num,<span class="hljs-number">2</span>) = <span class="hljs-number">0</span>  <span class="hljs-keyword">THEN</span>
    DBMS_OUTPUT.PUT_LINE (v_num||<span class="hljs-string">&apos; is even number&apos;</span>);
  ELSE
    DBMS_OUTPUT.PUT_LINE (v_num||&apos; is odd number&apos;);
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
  DBMS_OUTPUT.PUT_LINE (&apos;Done&apos;);
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>ELSIF statements<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  v_num <span class="hljs-built_in">NUMBER</span> := &amp;sv_num;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">IF</span> v_num &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span>
    DBMS_OUTPUT.PUT_LINE (v_num||<span class="hljs-string">&apos; is a negative number&apos;</span>);
  ELSIF v_num = 0 THEN
    DBMS_OUTPUT.PUT_LINE (v_num||&apos; is equal to zero&apos;);
  ELSE
    DBMS_OUTPUT.PUT_LINE (v_num||&apos; is a positive number&apos;);
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>Nested If statements<pre><code class="lang-sql">DECLARE
  v_num1 NUMBER := &amp;sv_num1;
  v_num2 NUMBER := &amp;sv_num2;
  v_total NUMBER;
BEGIN
  IF v_num1 &gt; v_num2 THEN
    DBMS_OUTPUT.PUT_LINE (&apos;IF part of the outer IF&apos;);
    v_total := v_num1 - v_num2;
  ELSE
    DBMS_OUTPUT.PUT_LINE (&apos;ELSE part of the outer IF&apos;);
    v_total := v_num1 + v_num2;
    IF v_total &lt; 0 THEN
      DBMS_OUTPUT.PUT_LINE (&apos;Inner IF&apos;);
      v_total := v_total * (-1);
    END IF;
  END IF;
  DBMS_OUTPUT.PUT_LINE (&apos;v_total = &apos;||v_total);
END;
</code></pre>
</li>
<li>Conditions with Logical Operators<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  v_letter <span class="hljs-built_in">CHAR</span>(<span class="hljs-number">1</span>) := <span class="hljs-string">&apos;&amp;sv_letter&apos;</span>;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">IF</span> (v_letter &gt;= <span class="hljs-string">&apos;A&apos;</span> <span class="hljs-keyword">AND</span> v_letter &lt;= <span class="hljs-string">&apos;Z&apos;</span>)
  <span class="hljs-keyword">OR</span> (v_letter &gt;= <span class="hljs-string">&apos;a&apos;</span> <span class="hljs-keyword">AND</span> v_letter &lt;= <span class="hljs-string">&apos;z&apos;</span>)
  <span class="hljs-keyword">THEN</span>
    DBMS_OUTPUT.PUT_LINE (<span class="hljs-string">&apos;This is a letter&apos;</span>);
  ELSE
    DBMS_OUTPUT.PUT_LINE (&apos;This is not a letter&apos;);
    IF v_letter BETWEEN &apos;0&apos; AND &apos;9&apos; THEN
      DBMS_OUTPUT.PUT_LINE (&apos;This is a number&apos;);
    ELSE
      DBMS_OUTPUT.PUT_LINE (&apos;This is not a number&apos;);
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>CASE statements<ul>
<li>CASE statements with selector after <code>CASE</code><pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  v_num <span class="hljs-built_in">NUMBER</span> := &amp;sv_user_num;
  v_num_flag NUMBER;
<span class="hljs-keyword">BEGIN</span>
  v_num_flag := <span class="hljs-keyword">MOD</span>(v_num,<span class="hljs-number">2</span>);
  <span class="hljs-comment">-- test if the number provided by the user is even</span>
  CASE v_num_flag
    WHEN 0 THEN
      DBMS_OUTPUT.PUT_LINE (v_num||&apos; is even number&apos;);
    ELSE
      DBMS_OUTPUT.PUT_LINE (v_num||&apos; is odd number&apos;);
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">CASE</span>;
  DBMS_OUTPUT.PUT_LINE (&apos;Done&apos;);
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>CASE statements without selector after <code>CASE</code><pre><code class="lang-sql">DECLARE
  v_student_id   NUMBER := 102;
  v_section_id   NUMBER := 89;
  v_final_grade  NUMBER;
  v_letter_grade CHAR(1);
BEGIN
  SELECT final_grade
  INTO v_final_grade
  FROM enrollment
  WHERE student_id = v_student_id
  AND section_id = v_section_id;
  CASE
    WHEN v_final_grade &gt;= 90 THEN v_letter_grade := &apos;A&apos;;
    WHEN v_final_grade &gt;= 80 THEN v_letter_grade := &apos;B&apos;;
    WHEN v_final_grade &gt;= 70 THEN v_letter_grade := &apos;C&apos;;
    WHEN v_final_grade &gt;= 60 THEN v_letter_grade := &apos;D&apos;;
    ELSE v_letter_grade := &apos;F&apos;;
  END CASE;
  DBMS_OUTPUT.PUT_LINE (&apos;Letter grade is: &apos;||v_letter_grade);
END;
</code></pre>
</li>
<li>Case Expression<pre><code class="lang-sql">v_result :=
  CASE v_num_flag
    WHEN 0 THEN v_num||&apos; is even number&apos;
    ELSE v_num||&apos; is odd number&apos;
  <span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>CASE Expression in a SQL Statement<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> course_no, description,
  <span class="hljs-keyword">CASE</span>
    <span class="hljs-keyword">WHEN</span> prerequisite <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span>
      <span class="hljs-string">&apos;No prerequisite course required&apos;</span>
    <span class="hljs-keyword">ELSE</span> TO_CHAR(prerequisite)
  <span class="hljs-comment">-- Optional label</span>
  <span class="hljs-keyword">END</span> prerequisite
<span class="hljs-keyword">INTO</span> v_course_no, v_description, v_prereq
<span class="hljs-keyword">FROM</span> course
<span class="hljs-keyword">WHERE</span> course_no = <span class="hljs-number">20</span>;
</code></pre>
</li>
<li>Case statement can be nested</li>
</ul>
</li>
<li>NULLIF<ul>
<li>NULLIF compares two expressions, if they are equal, it returns NULL</li>
<li>Otherwise it returns the value of the first expression<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
v_num <span class="hljs-built_in">NUMBER</span> := &amp;sv_user_num;
v_remainder NUMBER;
<span class="hljs-keyword">BEGIN</span>
<span class="hljs-comment">-- calculate the remainder and if it is zero return NULL</span>
v_remainder := <span class="hljs-keyword">NULLIF</span>(<span class="hljs-keyword">MOD</span>(v_num,<span class="hljs-number">2</span>),<span class="hljs-number">0</span>);
DBMS_OUTPUT.PUT_LINE (&apos;v_remainder: &apos;||v_remainder);
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
</ul>
</li>
<li>Simple Loop<ul>
<li>Example<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
v_counter <span class="hljs-built_in">NUMBER</span> := <span class="hljs-number">0</span>;
<span class="hljs-keyword">BEGIN</span>
<span class="hljs-keyword">LOOP</span>
  DBMS_OUTPUT.PUT_LINE (<span class="hljs-string">&apos;v_counter = &apos;</span>||v_counter);
  EXIT;
<span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>Simple LOOP with EXIT Condition<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
v_counter BINARY_INTEGER := <span class="hljs-number">0</span>;
<span class="hljs-keyword">BEGIN</span>
<span class="hljs-keyword">LOOP</span>
  <span class="hljs-comment">-- increment loop counter by one</span>
  v_counter := v_counter + <span class="hljs-number">1</span>;
  DBMS_OUTPUT.PUT_LINE (&apos;v_counter = &apos;||v_counter);
  <span class="hljs-comment">-- if EXIT condition yields TRUE exit the loop</span>
  IF v_counter = 5 THEN
    EXIT;
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
<span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>Simple LOOP with EXIT WHEN Condition<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
v_course course.course_no%<span class="hljs-keyword">TYPE</span> := <span class="hljs-number">430</span>;
v_instructor_id instructor.instructor_id%TYPE := 102;
v_sec_num section.section_no%TYPE := 0;
<span class="hljs-keyword">BEGIN</span>
<span class="hljs-keyword">LOOP</span>
  <span class="hljs-comment">-- increment section number by one</span>
  v_sec_num := v_sec_num + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">section</span>
    (section_id, course_no, section_no, instructor_id, created_date, created_by, modified_date, modified_by)
  <span class="hljs-keyword">VALUES</span>
    (section_id_seq.<span class="hljs-keyword">NEXTVAL</span>, v_course, v_sec_num, v_instructor_id, <span class="hljs-keyword">SYSDATE</span>, <span class="hljs-keyword">USER</span>, <span class="hljs-keyword">SYSDATE</span>, <span class="hljs-keyword">USER</span>);
  <span class="hljs-comment">-- if number of sections added is four exit the loop</span>
  EXIT WHEN v_sec_num = 4;
<span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">COMMIT</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
</ul>
</li>
<li>WHILE Loop<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  v_counter <span class="hljs-built_in">NUMBER</span> := <span class="hljs-number">1</span>;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">WHILE</span> v_counter &lt; <span class="hljs-number">5</span> <span class="hljs-keyword">LOOP</span>
    DBMS_OUTPUT.PUT_LINE (<span class="hljs-string">&apos;v_counter = &apos;</span>||v_counter);
    v_counter := v_counter + 1;
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>FOR LOOP<pre><code class="lang-sql"><span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">FOR</span> v_counter <span class="hljs-keyword">IN</span> <span class="hljs-number">1.</span><span class="hljs-number">.5</span> <span class="hljs-keyword">LOOP</span>
    <span class="hljs-comment">-- By Default, Loop will only increment (or decrement) by 1</span>
    DBMS_OUTPUT.PUT_LINE (<span class="hljs-string">&apos;v_counter = &apos;</span>|| v_counter);
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>Numeric FOR LOOP IN REVERSE<pre><code class="lang-sql"><span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">FOR</span> v_counter <span class="hljs-keyword">IN</span> <span class="hljs-keyword">REVERSE</span> <span class="hljs-number">1.</span><span class="hljs-number">.5</span> <span class="hljs-keyword">LOOP</span>
    DBMS_OUTPUT.PUT_LINE (<span class="hljs-string">&apos;v_counter = &apos;</span>||v_counter);
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>CONTINUE - Used to advance to the next iteration of a loop<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  v_counter <span class="hljs-built_in">NUMBER</span> := <span class="hljs-number">0</span>;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">LOOP</span>
    DBMS_OUTPUT.PUT_LINE (<span class="hljs-string">&apos;v_counter = &apos;</span>||v_counter);
    CONTINUE;
    v_counter := v_counter + 1;
    EXIT WHEN v_counter = 5;
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
</ul>
<h4 id="exception-handling">Exception Handling</h4>
<ul>
<li>Catch Errors based on Built-in Exception types<pre><code class="lang-sql">EXCEPTION
  WHEN ZERO_DIVIDE THEN
    DBMS_OUTPUT.PUT_LINE (&apos;A number cannot be divided by zero.&apos;);
  WHEN VALUE_ERROR THEN
    DBMS_OUTPUT.PUT_LINE (&apos;An error has occurred&apos;);
  WHEN NO_DATA_FOUND THEN
    DBMS_OUTPUT.PUT_LINE (&apos;There is no such student&apos;);
  WHEN TOO_MANY_ROWS THEN
    DBMS_OUTPUT.PUT_LINE (&apos;TOO_MANY_ROWS&apos;);
  WHEN PROGRAM_ERROR OR DUP_VALUE_ON_INDEX THEN
    DBMS_OUTPUT.PUT_LINE (&apos;PROGRAM_ERROR or DUP_VALUE_ON_INDEX&apos;);
  <span class="hljs-comment">-- Handle any exceptions</span>
  WHEN OTHERS THEN
    DBMS_OUTPUT.PUT_LINE (&apos;An error has occurred&apos;);
</code></pre>
</li>
<li>EXCEPTION block works below inner blocks as well</li>
<li>only 1 exception can be raised per block, until handled</li>
<li>User-Defined Exceptions<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  v_student_id STUDENT.STUDENT_ID%<span class="hljs-keyword">TYPE</span> := &amp;sv_student_id;
  v_total_courses NUMBER;
  e_invalid_id EXCEPTION;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">IF</span> v_student_id &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span>
    <span class="hljs-keyword">RAISE</span> e_invalid_id;
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
  DBMS_OUTPUT.PUT_LINE (&apos;No exception has been raised&apos;);
EXCEPTION
  WHEN e_invalid_id THEN
    DBMS_OUTPUT.PUT_LINE (&apos;An id cannot be negative&apos;);
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>Reraise Exceptions - raise twice, new error replace old in the output<pre><code class="lang-sql"><span class="hljs-comment">-- outer block</span>
<span class="hljs-keyword">DECLARE</span> e_exception <span class="hljs-keyword">EXCEPTION</span>;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-comment">-- inner block</span>
  <span class="hljs-keyword">BEGIN</span>
    <span class="hljs-keyword">RAISE</span> e_exception;
  EXCEPTION
    WHEN e_exception THEN
      RAISE;
  <span class="hljs-keyword">END</span>;
EXCEPTION
  WHEN e_exception THEN
    DBMS_OUTPUT.PUT_LINE (&apos;An error has occurred&apos;);
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>RAISE_APPLICATION_ERROR gives an error with more of an Oracle look and feel
, <code>RAISE_APPLICATION_ERROR(error_number, error_message[, keep_errors])</code><ul>
<li><code>error_number</code>: -20,999 to -20,000</li>
<li><code>error_message</code>: up to 2,048 characters</li>
<li><code>keep_errors</code>: boolean<ul>
<li>If TRUE, new error is added to error stack</li>
<li>If FALSE (default), new error replaces error stack</li>
</ul>
</li>
<li>Example<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
v_student_id STUDENT.STUDENT_ID%<span class="hljs-keyword">TYPE</span> := &amp;sv_student_id;
v_total_courses NUMBER;
<span class="hljs-keyword">BEGIN</span>
<span class="hljs-keyword">IF</span> v_student_id &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span>
  RAISE_APPLICATION_ERROR (<span class="hljs-number">-20000</span>, <span class="hljs-string">&apos;An id cannot be negative&apos;</span>);
<span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
<pre><code class="lang-sql">EXCEPTION
WHEN NO_DATA_FOUND THEN
  RAISE_APPLICATION_ERROR (-20001, &apos;This ID is invalid&apos;);
</code></pre>
</li>
</ul>
</li>
<li>EXCEPTION_INIT Pragma<ul>
<li>The exception handler only works with named errors</li>
<li>Not all Oracle errors have names</li>
<li>The EXCEPTION_INIT Pragma (compiler directive) adds an Oracle error number to the user defined error<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
v_zip ZIPCODE.ZIP%<span class="hljs-keyword">TYPE</span> := <span class="hljs-string">&apos;&amp;sv_zip&apos;</span>;
e_child_exists EXCEPTION;
<span class="hljs-keyword">PRAGMA</span> EXCEPTION_INIT(e_child_exists, <span class="hljs-number">-2292</span>);
</code></pre>
</li>
</ul>
</li>
<li>SQLCODE and SQLERRM<ul>
<li>SQLCODE returns Oracle error number</li>
<li>SQLERRM returns error message, maximum length 512 bytes</li>
<li>Used with WHEN OTHERS exception handler</li>
<li>Example<pre><code class="lang-sql">EXCEPTION
  WHEN OTHERS THEN
    v_err_code := SQLCODE;
    v_err_msg  := SUBSTR(SQLERRM, 1, 200);
    DBMS_OUTPUT.PUT_LINE (&apos;Error code: &apos;||v_err_code);
    DBMS_OUTPUT.PUT_LINE (&apos;Error message: &apos;||v_err_msg);
</code></pre>
</li>
</ul>
</li>
</ul>
<h4 id="cursor">Cursor</h4>
<ul>
<li>When Oracle processes a SQL statement, it creates an area of memory known as the context area</li>
<li>Implicit Cursor - SQL engin utlize cursors internally to complete tasks</li>
<li>Explicit Cursor - It returns an array of records with defines row element types</li>
<li>To use a cursor, one needs to:<ul>
<li>Declare the cursor (SELECT statement)</li>
<li>Open the cursor</li>
<li>Fetch the cursor (one row at a time, usually in a loop)</li>
<li>Perform desired processing</li>
<li>Close the cursor<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
<span class="hljs-keyword">CURSOR</span> c_zip <span class="hljs-keyword">IS</span>
  <span class="hljs-keyword">SELECT</span> *
    <span class="hljs-keyword">FROM</span> zipcode;
vr_zip c_zip%ROWTYPE;
<span class="hljs-keyword">BEGIN</span>
<span class="hljs-keyword">OPEN</span> c_zip;
LOOP
  FETCH c_zip INTO vr_zip;
  EXIT WHEN c_zip%NOTFOUND;
  DBMS_OUTPUT.PUT_LINE(vr_zip.zip||&apos; &apos;||vr_zip.city||&apos; &apos;||vr_zip.state);
<span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
</ul>
</li>
<li>Cursor Attributes<ul>
<li><code>%NOTFOUND</code> &#x2013; Boolean that returns TRUE if previous FETCH did not return a row</li>
<li><code>%FOUND</code> &#x2013; Boolean that returns TRUE if previous FETCH returned a row</li>
<li><code>%ROWCOUNT</code> &#x2013; Number of records fetched from a cursor at that point in time</li>
<li><code>%ISOPEN</code> &#x2013; Boolean that returns TRUE if the cursor is open<pre><code class="lang-sql">EXCEPTION
WHEN OTHERS THEN
  IF c_student%ISOPEN THEN
    CLOSE c_student;
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
</code></pre>
</li>
<li>Attributes are appended to name of cursor, ex. <code>c_zip%ROWCOUNT</code></li>
<li>For implicit cursor, use <code>SQL%ROWCOUNT</code></li>
</ul>
</li>
<li>Cursor FOR Loops<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> table_log (description VARCHAR2(<span class="hljs-number">250</span>));
<span class="hljs-keyword">DECLARE</span>
  <span class="hljs-keyword">CURSOR</span> c_student <span class="hljs-keyword">IS</span>
    <span class="hljs-keyword">SELECT</span> student_id, last_name, first_name
      <span class="hljs-keyword">FROM</span> student
      <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">rownum</span> &lt;= <span class="hljs-number">5</span>;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">FOR</span> r_student <span class="hljs-keyword">IN</span> c_student <span class="hljs-keyword">LOOP</span>
    <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> table_log
      <span class="hljs-keyword">VALUES</span>(r_student.last_name);
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
<ul>
<li><code>ROWNUM</code> in cursor definition returns a number indicating the order in which a row was selected from a table</li>
<li>Cursor FOR loops handle opening, fetching and closing cursors implicitly</li>
<li>Cursor FOR Loops can be nested</li>
<li>Cursor can have variables in its definition, the value of the variable will be accessed before acessing the cursor</li>
</ul>
</li>
<li>Cursors with Parameters<ul>
<li>Like passing a parameter to a method</li>
<li>Different values can be provided at run time<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
<span class="hljs-keyword">CURSOR</span> c_zip(p_state <span class="hljs-keyword">IN</span> zipcode.state%<span class="hljs-keyword">TYPE</span>) <span class="hljs-keyword">IS</span>
  <span class="hljs-keyword">SELECT</span> zip, city, state
    <span class="hljs-keyword">FROM</span> zipcode
    <span class="hljs-keyword">WHERE</span> state = p_state;
<span class="hljs-keyword">BEGIN</span>
<span class="hljs-keyword">FOR</span> r_zip <span class="hljs-keyword">IN</span> c_zip(<span class="hljs-string">&apos;NJ&apos;</span>) <span class="hljs-keyword">LOOP</span>
  DBMS_OUTPUT.PUT_LINE(r_zip.city||<span class="hljs-string">&apos; &apos;</span>||r_zip.zip);
<span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>Cursor can have multiple parameters and separated by comma, <code>CURSOR c_grade(i_section_id IN section.section_id%TYPE, i_student_id IN student.student_id%TYPE) IS</code></li>
</ul>
</li>
<li>Cursors for update<ul>
<li>When cursors are used to update, <code>FOR UPDATE</code> keyword is required in declaration<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
<span class="hljs-keyword">CURSOR</span> c_course <span class="hljs-keyword">IS</span>
  <span class="hljs-keyword">SELECT</span> course_no, <span class="hljs-keyword">cost</span>
    <span class="hljs-keyword">FROM</span> course <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">UPDATE</span>;
<span class="hljs-keyword">BEGIN</span>
<span class="hljs-keyword">FOR</span> r_course <span class="hljs-keyword">IN</span> c_course <span class="hljs-keyword">LOOP</span>
  <span class="hljs-keyword">IF</span> r_course.<span class="hljs-keyword">cost</span> &lt; <span class="hljs-number">2500</span> <span class="hljs-keyword">THEN</span>
    <span class="hljs-keyword">UPDATE</span> course
      <span class="hljs-keyword">SET</span> <span class="hljs-keyword">cost</span> = r_course.<span class="hljs-keyword">cost</span> + <span class="hljs-number">10</span>
      <span class="hljs-keyword">WHERE</span> course_no = r_course.course_no;
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
<span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
</ul>
</li>
<li><code>FOR UPDATE</code> only locks a certain row during operation</li>
<li><code>WHERE CURRENT OF</code> lock and return the current row from the cursor during update<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  <span class="hljs-keyword">CURSOR</span> c_stud_zip <span class="hljs-keyword">IS</span>
    <span class="hljs-keyword">SELECT</span> s.student_id, z.city
      <span class="hljs-keyword">FROM</span> student s
      <span class="hljs-keyword">JOIN</span> zipcode z <span class="hljs-keyword">ON</span> s.zip = z.zip
      <span class="hljs-keyword">WHERE</span> z.city = <span class="hljs-string">&apos;Brooklyn&apos;</span>
      <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-keyword">OF</span> phone;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">FOR</span> r_stud_zip <span class="hljs-keyword">IN</span> c_stud_zip <span class="hljs-keyword">LOOP</span>
  DBMS_OUTPUT.PUT_LINE(r_stud_zip.student_id);
    <span class="hljs-keyword">UPDATE</span> student
      <span class="hljs-keyword">SET</span> phone = <span class="hljs-string">&apos;718&apos;</span>||<span class="hljs-keyword">SUBSTR</span>(phone,<span class="hljs-number">4</span>)
      <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">CURRENT</span> <span class="hljs-keyword">OF</span> c_stud_zip;
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
</ul>
<h4 id="transcation">Transcation</h4>
<ul>
<li>some units of work (transactions) will change multiple tables</li>
<li>Database not considered in a consistent state unless all or none of the changes are processed together</li>
<li>Changes made by one database user are not visible to other users until committed</li>
<li><code>COMMIT</code> makes events within a transaction permanent</li>
<li><code>ROLLBACK</code> erases events within a transaction</li>
<li><code>SAVEPOINT</code> marks a place in a transaction to where a partial rollback may be made<pre><code class="lang-sql"><span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> student
  (student_id, last_name, zip, registration_date, created_by, created_date, modified_by, modified_date)
  <span class="hljs-keyword">VALUES</span>(student_id_seq.<span class="hljs-keyword">NEXTVAL</span>, <span class="hljs-string">&apos;Tashi&apos;</span>, <span class="hljs-number">10015</span>, <span class="hljs-string">&apos;1-JAN-2019&apos;</span>, <span class="hljs-string">&apos;STUDENTA&apos;</span>, <span class="hljs-string">&apos;1-JAN-2019&apos;</span>, <span class="hljs-string">&apos;STUDENTA&apos;</span>, <span class="hljs-string">&apos;1-JAN-2019&apos;</span>);
  <span class="hljs-keyword">SAVEPOINT</span> A;
  <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> student
  (student_id, last_name, zip, registration_date, created_by, created_date, modified_by, modified_date)
  <span class="hljs-keyword">VALUES</span>(student_id_seq.<span class="hljs-keyword">NEXTVAL</span>, <span class="hljs-string">&apos;Sonam&apos;</span>, <span class="hljs-number">10015</span>, <span class="hljs-string">&apos;1-JAN-2019&apos;</span>, <span class="hljs-string">&apos;STUDENTB&apos;</span>, <span class="hljs-string">&apos;1-JAN-2019&apos;</span>, <span class="hljs-string">&apos;STUDENTB&apos;</span>, <span class="hljs-string">&apos;1-JAN-2019&apos;</span>);
  <span class="hljs-keyword">SAVEPOINT</span> B;
  <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> student
  (student_id, last_name, zip, registration_date, created_by, created_date, modified_by, modified_date)
  <span class="hljs-keyword">VALUES</span>(student_id_seq.<span class="hljs-keyword">NEXTVAL</span>, <span class="hljs-string">&apos;Norbu&apos;</span>, <span class="hljs-number">10015</span>, <span class="hljs-string">&apos;1-JAN-2019&apos;</span>, <span class="hljs-string">&apos;STUDENTB&apos;</span>, <span class="hljs-string">&apos;1-JAN-2019&apos;</span>, <span class="hljs-string">&apos;STUDENTB&apos;</span>, <span class="hljs-string">&apos;1-JAN-2019&apos;</span>);
  <span class="hljs-keyword">SAVEPOINT</span> C;
  <span class="hljs-keyword">ROLLBACK</span> <span class="hljs-keyword">TO</span> B;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
</ul>
<h4 id="procedure">Procedure</h4>
<ul>
<li>A procedure is a named PL/SQL block</li>
<li>Procedures have names and may be called from a SQL prompt, other procedures, triggers or scheduling utilities</li>
<li>Procedures may accept and return parameters</li>
<li>If procedure doesn&apos;t compile, inspect the Compiler Log or use the show error command <code>SHOW ERROR;</code></li>
<li>Example<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">PROCEDURE</span> Discount
<span class="hljs-keyword">AS</span>
  <span class="hljs-keyword">CURSOR</span> c_group_discount
  <span class="hljs-keyword">IS</span>
    <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">distinct</span> s.course_no, c.description
      <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">section</span> s, enrollment e, course c
      <span class="hljs-keyword">WHERE</span> s.section_id = e.section_id
      <span class="hljs-keyword">AND</span> c.course_no = s.course_no
      <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> s.course_no, c.description,
              e.section_id, s.section_id
      <span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">COUNT</span>(*) &gt;= <span class="hljs-number">8</span>;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">FOR</span> r_group_discount <span class="hljs-keyword">IN</span> c_group_discount <span class="hljs-keyword">LOOP</span>
    <span class="hljs-keyword">UPDATE</span> course
      <span class="hljs-keyword">SET</span> <span class="hljs-keyword">cost</span> = <span class="hljs-keyword">cost</span> * <span class="hljs-number">.95</span>
      <span class="hljs-keyword">WHERE</span> course_no = r_group_discount.course_no;
    DBMS_OUTPUT.PUT_LINE
      (&apos;A 5% discount has been given to &apos;||
      r_group_discount.course_no||&apos; &apos;||
      r_group_discount.description);
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>Execute Procedure<pre><code class="lang-sql"><span class="hljs-keyword">BEGIN</span>
  Discount;
<span class="hljs-keyword">END</span>
</code></pre>
<ul>
<li>Interactively in SQL Developer, use <code>EXECUTE Discount;</code>, and <code>EXEC Discount;</code></li>
</ul>
</li>
<li>Query existing procedure<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> object_name, object_type, <span class="hljs-keyword">status</span>
  <span class="hljs-keyword">FROM</span> user_objects
  <span class="hljs-keyword">WHERE</span> object_name = <span class="hljs-string">&apos;DISCOUNT&apos;</span>;
</code></pre>
</li>
<li>Procedure parameter modes:<ul>
<li><code>IN</code> - Passes a value into the programConstants, literals, expressions, cannot be changed with the program. Read-only value</li>
<li><code>OUT</code> - Passes a value back from the program, cannot assign default values, must be a variable, a value is assigned only if the program is successful. Write-only value</li>
<li><code>IN OUT</code> - Passes value in and also sends values back. Must be a variable</li>
</ul>
</li>
<li>Procedure parameter example<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">PROCEDURE</span> find_sname
  (i_student_id <span class="hljs-keyword">IN</span> <span class="hljs-built_in">NUMBER</span>,
  o_first_name <span class="hljs-keyword">OUT</span> VARCHAR2,
  o_last_name <span class="hljs-keyword">OUT</span> VARCHAR2)
<span class="hljs-keyword">AS</span>
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">SELECT</span> first_name, last_name
    <span class="hljs-keyword">INTO</span> o_first_name, o_last_name
    <span class="hljs-keyword">FROM</span> student
    <span class="hljs-keyword">WHERE</span> student_id = i_student_id;
EXCEPTION
  WHEN OTHERS THEN
    DBMS_OUTPUT.PUT_LINE(&apos;Error in finding student_id: &apos;||i_student_id);
<span class="hljs-keyword">END</span> find_sname;
</code></pre>
</li>
<li>Calling with Positional Parameters<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  v_first student.first_name%<span class="hljs-keyword">TYPE</span>;
  v_last student.last_name%TYPE;
<span class="hljs-keyword">BEGIN</span>
  find_sname (<span class="hljs-number">105</span>, v_first, v_last);
  DBMS_OUTPUT.PUT_LINE(v_first ||&apos; &apos;|| v_last);
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>Calling with Named Parameters<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  v_id student.student_id%<span class="hljs-keyword">TYPE</span> := <span class="hljs-number">110</span>;
  v_first student.first_name%TYPE;
  v_last student.last_name%TYPE;
<span class="hljs-keyword">BEGIN</span>
  find_sname (o_first_name =&gt; v_first,
              o_last_name =&gt; v_last,
              i_student_id =&gt; v_id);
  DBMS_OUTPUT.PUT_LINE(v_first ||&apos; &apos;|| v_last);
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>For debugging, login as <code>SYS</code> and issue following commands, <code>GRANT DEBUG CONNECT SESSION TO student;</code>, <code>GRANT DEBUG ANY PROCEDURE TO student;</code> and perform the following steps:<ol>
<li>Expand Procedures in explorer</li>
<li>Right click desired procedure and select Edit&#x2026;</li>
<li>Compile for Debug by clicking dropdown of gears icon</li>
<li>Add breakpoints as desired by clicking in gutter</li>
<li>Click Debug icon to run</li>
<li>Edit created anonymous block for input parameters as necessary</li>
<li>Step through code</li>
</ol>
</li>
</ul>
<h4 id="execute-immediate">EXECUTE IMMEDIATE</h4>
<ul>
<li>It is a statement that allows the execution of a sql statement or block stroed in a string</li>
<li>It allows for creating SQL statements on the fly and executing them</li>
<li>It allows things that wouldn&#x2019;t normally be permissible in a PL/SQL block, such as DDL</li>
<li>Syntax<pre><code class="lang-sql">  <span class="hljs-keyword">EXECUTE</span> <span class="hljs-keyword">IMMEDIATE</span> dynamic_SQL_string
  [<span class="hljs-keyword">INTO</span> defined_variable1, defined_variable2, ...]
  [<span class="hljs-keyword">USING</span> [<span class="hljs-keyword">IN</span> | <span class="hljs-keyword">OUT</span> | <span class="hljs-keyword">IN</span> <span class="hljs-keyword">OUT</span>] bind_argument1, bind_argument2,
  ...][{<span class="hljs-keyword">RETURNING</span> | <span class="hljs-keyword">RETURN</span>} field1, field2, ... <span class="hljs-keyword">INTO</span> bind_argument1,
  bind_argument2, ...]
</code></pre>
<ul>
<li>dynamic_SQL_string may be a SQL statement or a PL/SQL block</li>
<li>The INTO clause contains the list of predefined variables that hold values returned by the SELECT statement, when it returns a single row</li>
<li>The USING clause contains a list of bind arguments passed to the SQL statement or PL/SQL block</li>
<li>IN, OUT and IN OUT are modes for bind arguments, IN is default</li>
<li>RETURNING INTO or RETURN clause contains a list of bind arguments that store values returned by the dynamic SQL or PL/SQL block</li>
<li>RETURNING INTO has similar argument modes to USING, OUT is default</li>
</ul>
</li>
<li>Example<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  sql_stmt VARCHAR2(<span class="hljs-number">100</span>);
  plsql_block VARCHAR2(300);
  v_zip VARCHAR2(5) := &apos;11106&apos;;
  v_total_students NUMBER;
  v_new_zip VARCHAR2(5);
  v_student_id NUMBER := 151;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-comment">-- Create table MY_STUDENT</span>
  sql_stmt := <span class="hljs-string">&apos;CREATE TABLE my_student &apos;</span>||
              <span class="hljs-string">&apos;AS SELECT * FROM student WHERE zip = &apos;</span>||v_zip;
  <span class="hljs-keyword">EXECUTE</span> <span class="hljs-keyword">IMMEDIATE</span> sql_stmt;
  <span class="hljs-comment">-- Select total number of records from MY_STUDENT table</span>
  <span class="hljs-comment">-- and display results on the screen</span>
  <span class="hljs-keyword">EXECUTE</span> <span class="hljs-keyword">IMMEDIATE</span> <span class="hljs-string">&apos;SELECT COUNT(*) FROM my_student&apos;</span> <span class="hljs-keyword">INTO</span> v_total_students;
  DBMS_OUTPUT.PUT_LINE (&apos;Students added: &apos;||v_total_students);
  <span class="hljs-comment">-- Select current date and display it on the screen</span>
  plsql_block := &apos;<span class="hljs-keyword">DECLARE</span> <span class="hljs-string">&apos; ||
                &apos;</span>  v_date <span class="hljs-built_in">DATE</span>; &apos; ||
                &apos;<span class="hljs-keyword">BEGIN</span> <span class="hljs-string">&apos; ||
                &apos;</span>  <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">SYSDATE</span> <span class="hljs-keyword">INTO</span> v_date <span class="hljs-keyword">FROM</span> DUAL; &apos;||
                &apos;  DBMS_OUTPUT.PUT_LINE (TO_CHAR(v_date, &apos;&apos;DD-MON-YYYY&apos;&apos;));&apos;||
                &apos;<span class="hljs-keyword">END</span>;&apos;;
  <span class="hljs-keyword">EXECUTE</span> <span class="hljs-keyword">IMMEDIATE</span> plsql_block;
  <span class="hljs-comment">-- Update record in MY_STUDENT table</span>
  sql_stmt := &apos;<span class="hljs-keyword">UPDATE</span> my_student <span class="hljs-keyword">SET</span> zip = <span class="hljs-number">11105</span> <span class="hljs-keyword">WHERE</span> student_id = :<span class="hljs-number">1</span> <span class="hljs-string">&apos;||
              &apos;</span><span class="hljs-keyword">RETURNING</span> zip <span class="hljs-keyword">INTO</span> :<span class="hljs-number">2</span><span class="hljs-string">&apos;;
  EXECUTE IMMEDIATE sql_stmt USING v_student_id RETURNING INTO v_new_zip;
  DBMS_OUTPUT.PUT_LINE (&apos;</span><span class="hljs-keyword">New</span> zip code: <span class="hljs-string">&apos;||v_new_zip);
END;
</span></code></pre>
</li>
<li>DDL statements cannot accept bind arguments, Names of schema objects cannot be passed as bind arguments, Both of these problems are solved by concatenation<ul>
<li>Dynamic SQL statements should not be terminated with a semicolon (<code>;</code>)</li>
<li>Dynamic PL/SQL blocks should not be terminated with a slash (<code>/</code>)</li>
</ul>
</li>
<li>Passing NULL<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  sql_stmt VARCHAR2(<span class="hljs-number">100</span>);
  v_null VARCHAR2(1);
<span class="hljs-keyword">BEGIN</span>
  sql_stmt := <span class="hljs-string">&apos;UPDATE course&apos;</span>||
              <span class="hljs-string">&apos; SET prerequisite = :some_value&apos;</span>;
  <span class="hljs-keyword">EXECUTE</span> <span class="hljs-keyword">IMMEDIATE</span> sql_stmt
  <span class="hljs-keyword">USING</span> v_null;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
</ul>
<h4 id="open-for-fetch-and-close">OPEN-FOR, FETCH and CLOSE</h4>
<ul>
<li>They are statements for multi-row queries</li>
<li>Very similar to cursors<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  <span class="hljs-comment">-- REF CURSOR declares a cursor type</span>
  <span class="hljs-keyword">TYPE</span> student_cur_type <span class="hljs-keyword">IS</span> <span class="hljs-keyword">REF</span> <span class="hljs-keyword">CURSOR</span>;
  <span class="hljs-comment">-- student_cur is an instance of the new type</span>
  student_cur student_cur_type;
  v_zip VARCHAR2(5) := &apos;&amp;sv_zip&apos;;
  v_first_name VARCHAR2(25);
  v_last_name VARCHAR2(25);
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">OPEN</span> student_cur <span class="hljs-keyword">FOR</span>
    <span class="hljs-string">&apos;SELECT first_name, last_name FROM student &apos;</span>|| <span class="hljs-string">&apos;WHERE zip = :1&apos;</span>
  <span class="hljs-keyword">USING</span> v_zip;
  LOOP
    FETCH student_cur INTO v_first_name, v_last_name;
    EXIT WHEN student_cur%NOTFOUND;
    DBMS_OUTPUT.PUT_LINE (&apos;First Name: &apos;||v_first_name);
    DBMS_OUTPUT.PUT_LINE (&apos;Last Name: &apos;||v_last_name);
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
  CLOSE student_cur;
EXCEPTION
  WHEN OTHERS THEN
    IF student_cur%ISOPEN THEN
      CLOSE student_cur;
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
    DBMS_OUTPUT.PUT_LINE (&apos;ERROR: &apos;|| SUBSTR(SQLERRM, 1, 200));
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
</ul>
<h4 id="trigger">Trigger</h4>
<ul>
<li>A database trigger is a named PL/SQL block</li>
<li>Triggers are &quot;special&quot; procedures</li>
<li>Triggers may not use transaction control statements: COMMIT, SAVEPOINT or ROLLBACK with the exception of an autonomous transaction</li>
<li>Triggers execute automatically (or are fired) in response to an event</li>
<li>During the execution of the trigger, there are pseudorecords <code>:NEW</code> and <code>:OLD</code>, they can be used to access the new and old values, it has the type <code>triggering_table%TYPE</code><ul>
<li>Delete event has a old record</li>
<li>Insert event has a new record</li>
<li>Update event has both new and old record</li>
</ul>
</li>
<li>Debug trigger in SQL Develop<ol>
<li>In the Connections navigator, expand the student connection, then expand the Triggers folder, select the student_bi trigger</li>
<li>Click the gears icon to compile the trigger</li>
<li>The same error messages appear and the line of code in error is highlighted</li>
<li>Fix the error and compile</li>
</ol>
</li>
<li>BEFORE Trigger<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">TRIGGER</span> student_bi
<span class="hljs-keyword">BEFORE</span> <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">ON</span> student
<span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-keyword">ROW</span>
<span class="hljs-keyword">DECLARE</span>
  v_student_id STUDENT.STUDENT_ID%<span class="hljs-keyword">TYPE</span>;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">SELECT</span> STUDENT_ID_SEQ.<span class="hljs-keyword">NEXTVAL</span>
    <span class="hljs-keyword">INTO</span> v_student_id
    <span class="hljs-keyword">FROM</span> dual;
  :NEW.student_id    := v_student_id;
  :NEW.created_by    := USER;
  :NEW.created_date  := SYSDATE;
  :NEW.modified_by   := USER;
  :NEW.modified_date := SYSDATE;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>After Trigger<pre><code class="lang-sql">CREATE OR REPLACE TRIGGER employees_au
AFTER UPDATE ON employees
FOR EACH ROW
DECLARE
  v_diff NUMBER;
BEGIN
  v_diff := :NEW.salary - :OLD.salary;
  IF v_diff &gt; 250 THEN
    INSERT INTO salary_log (employee_id, salary_date, description)
      VALUES(:NEW.employee_id, SYSDATE, &apos;Raise of more than $250&apos;);
  END IF;
END;
</code></pre>
</li>
<li>A row trigger will fire the same number of times as rows that have been affected. Whereas a statement trigger will only fire once, regardless of how many rows have been affected<ul>
<li>Row trigger is enabled by adding the <code>FOR EACH ROW</code> keyword</li>
</ul>
</li>
<li><code>INSERTING</code>, <code>UPDATING</code> and <code>DELETING</code> are boolean functions that evaluate to <code>TRUE</code> depending on which DML statement invoked the trigger<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">TRIGGER</span> instructor_aud
<span class="hljs-keyword">AFTER</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">ON</span> INSTRUCTOR
<span class="hljs-keyword">DECLARE</span>
  v_type VARCHAR2(<span class="hljs-number">10</span>);
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">IF</span> UPDATING <span class="hljs-keyword">THEN</span>
    v_type := <span class="hljs-string">&apos;UPDATE&apos;</span>;
  ELSIF DELETING THEN
    v_type := &apos;<span class="hljs-keyword">DELETE</span><span class="hljs-string">&apos;;
  END IF;
  UPDATE statistics SET transaction_user = USER, transaction_date = SYSDATE
    WHERE table_name = &apos;</span>INSTRUCTOR<span class="hljs-string">&apos; AND transaction_name = v_type;
  IF SQL%NOTFOUND THEN
    INSERT INTO statistics
    VALUES (&apos;</span>INSTRUCTOR<span class="hljs-string">&apos;, v_type, USER, SYSDATE);
  END IF;
END;
</span></code></pre>
</li>
<li>COMMIT<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">TRIGGER</span> instructor_aud
<span class="hljs-keyword">AFTER</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">ON</span> INSTRUCTOR
<span class="hljs-keyword">DECLARE</span>
  v_type VARCHAR2(<span class="hljs-number">10</span>);
  <span class="hljs-keyword">PRAGMA</span> AUTONOMOUS_TRANSACTION;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">IF</span> UPDATING <span class="hljs-keyword">THEN</span>
    v_type := <span class="hljs-string">&apos;UPDATE&apos;</span>;
  ELSIF DELETING THEN
    v_type := &apos;<span class="hljs-keyword">DELETE</span><span class="hljs-string">&apos;;
  END IF;
  UPDATE statistics SET transaction_user = USER, transaction_date = SYSDATE
    WHERE table_name = &apos;</span>INSTRUCTOR<span class="hljs-string">&apos; AND transaction_name = v_type;
  IF SQL%NOTFOUND THEN
    INSERT INTO statistics VALUES (&apos;</span>INSTRUCTOR<span class="hljs-string">&apos;, v_type, USER, SYSDATE);
  END IF;
  COMMIT;
END;
</span></code></pre>
<ul>
<li><code>ROLLBACK;</code> can be executed after the trigger is activated</li>
</ul>
</li>
<li>Raise error can cancel the trigger<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">TRIGGER</span> instructor_biud
<span class="hljs-keyword">BEFORE</span> <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">ON</span> INSTRUCTOR
<span class="hljs-keyword">DECLARE</span>
  v_day VARCHAR2(<span class="hljs-number">10</span>);
<span class="hljs-keyword">BEGIN</span>
  v_day := <span class="hljs-keyword">RTRIM</span>(TO_CHAR(<span class="hljs-keyword">SYSDATE</span>, <span class="hljs-string">&apos;DAY&apos;</span>));
  IF v_day LIKE (&apos;T%&apos;) THEN
    RAISE_APPLICATION_ERROR(-20000, &apos;A table cannot be modified during off hours&apos;);
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>An <code>INSTEAD OF</code> trigger can operate against a view<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">TRIGGER</span> instructor_summary_del
INSTEAD <span class="hljs-keyword">OF</span> <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">ON</span> instructor_summary_view
<span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span> <span class="hljs-keyword">ROW</span>
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> instructor <span class="hljs-keyword">WHERE</span> instructor_id = :<span class="hljs-keyword">OLD</span>.INSTRUCTOR_ID;
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li><code>DROP TRIGGER instructor_biud;</code> delete a trigger</li>
</ul>
<h4 id="function">Function</h4>
<ul>
<li>A function is another type of procedure</li>
<li>Parameters are optional</li>
<li>A value must be returned</li>
<li>A function can be used in a SQL statement<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">FUNCTION</span> show_description
  (i_course_no course.course_no%<span class="hljs-keyword">TYPE</span>)
<span class="hljs-keyword">RETURN</span> varchar2
<span class="hljs-keyword">AS</span>
  v_description varchar2(<span class="hljs-number">50</span>);
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">SELECT</span> description
    <span class="hljs-keyword">INTO</span> v_description
    <span class="hljs-keyword">FROM</span> course
  <span class="hljs-keyword">WHERE</span> course_no = i_course_no;
  RETURN v_description;
EXCEPTION
  WHEN NO_DATA_FOUND THEN
    RETURN(&apos;The Course is not in the database&apos;);
  WHEN OTHERS THEN
    RETURN(&apos;Error in running show_description&apos;);
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>Using Function<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  v_description VARCHAR2(<span class="hljs-number">50</span>);
<span class="hljs-keyword">BEGIN</span>
  v_description := show_description(&amp;course_number);
  dbms_output.put_line(v_description);
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
<li>Using Function in SQL Statement, <code>SELECT course_no, show_description(course_no) FROM course;</code></li>
</ul>
<h4 id="packages">Packages</h4>
<ul>
<li>A package is a container that may hold procedures, functions, global variables and cursors</li>
<li>When a package is first called, it is loaded into memory, making it very fast on subsequent calls</li>
<li>PL/SQL is not object oriented, but using packages offer some of the concepts such as overloading</li>
<li>Package specification:<ul>
<li>Information about the package&#x2019;s contents, but not the code</li>
<li>Global/public variables</li>
<li>Anything found in a PL/SQL DECLARE section may be placed in the specification</li>
<li>Objects in the specification are public<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">PACKAGE</span> manage_students
<span class="hljs-keyword">AS</span>
<span class="hljs-keyword">PROCEDURE</span> find_sname
  (i_student_id <span class="hljs-keyword">IN</span> student.student_id%<span class="hljs-keyword">TYPE</span>,
  o_first_name <span class="hljs-keyword">OUT</span> student.first_name%<span class="hljs-keyword">TYPE</span>,
  o_last_name <span class="hljs-keyword">OUT</span> student.last_name%<span class="hljs-keyword">TYPE</span>);
FUNCTION id_is_good
  (i_student_id IN student.student_id%TYPE)
  RETURN BOOLEAN;
<span class="hljs-keyword">END</span> manage_students;
</code></pre>
</li>
<li>modify packages by redefining the specification</li>
</ul>
</li>
<li>Package Body<ul>
<li>Executable code</li>
<li>Any code for objects in body that are not in the specification are private to the package</li>
<li>Must match specification for cursor and modules<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">PACKAGE</span> <span class="hljs-keyword">BODY</span> manage_students
<span class="hljs-keyword">AS</span>
<span class="hljs-keyword">PROCEDURE</span> find_sname
  (i_student_id <span class="hljs-keyword">IN</span> student.student_id%<span class="hljs-keyword">TYPE</span>,
  o_first_name <span class="hljs-keyword">OUT</span> student.first_name%<span class="hljs-keyword">TYPE</span>,
  o_last_name <span class="hljs-keyword">OUT</span> student.last_name%<span class="hljs-keyword">TYPE</span>)
<span class="hljs-keyword">IS</span>
  v_student_id student.student_id%<span class="hljs-keyword">TYPE</span>;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">SELECT</span> first_name, last_name
    <span class="hljs-keyword">INTO</span> o_first_name, o_last_name
    <span class="hljs-keyword">FROM</span> student
  <span class="hljs-keyword">WHERE</span> student_id = i_student_id;
EXCEPTION
  WHEN OTHERS THEN
    dbms_output.put_line(&apos;Error in finding student_id: &apos; || v_student_id);
<span class="hljs-keyword">END</span> find_sname;
FUNCTION id_is_good
  (i_student_id IN student.student_id%TYPE)
  RETURN BOOLEAN
IS
  v_id_cnt number;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(*)
    <span class="hljs-keyword">INTO</span> v_id_cnt
    <span class="hljs-keyword">FROM</span> student
  <span class="hljs-keyword">WHERE</span> student_id = i_student_id;
  RETURN 1 = v_id_cnt;
EXCEPTION
  WHEN OTHERS THEN
    RETURN FALSE;
<span class="hljs-keyword">END</span> id_is_good;
<span class="hljs-keyword">END</span> manage_students;
</code></pre>
</li>
<li>To creat packages in a single script, use <code>/</code> on a line by itself to separate the <code>CREATE PACKAGE</code> and <code>CREATE PACKAGE BODY</code> script</li>
</ul>
</li>
<li>Referencing Package Elements<ul>
<li>From outside the package: <code>package_name.element</code></li>
<li>From inside the package: <code>element</code></li>
</ul>
</li>
<li>Using a Package<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  v_first_name student.first_name%<span class="hljs-keyword">TYPE</span>;
  v_last_name student.last_name%TYPE;
  v_id student.student_id%TYPE := &amp;student_id;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">IF</span> manage_students.id_is_good(v_id) <span class="hljs-keyword">THEN</span>
    manage_students.find_sname(v_id, v_first_name, v_last_name);
    dbms_output.put_line(&apos;Student No. &apos; || v_id || &apos; is &apos;
      || v_last_name || &apos;, &apos; || v_first_name);
  ELSE
    dbms_output.put_line(&apos;Student ID: &apos; || v_id || &apos; is not in the database.&apos;);
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">IF</span>;
<span class="hljs-keyword">END</span>;
</code></pre>
<ul>
<li>Anything that doesn&apos;t define in the specification are private, to use private functions run <code>EXECUTE package_name.private_definition;</code></li>
</ul>
</li>
<li>Package Initialization<ul>
<li>The first time a package is called, the initialization section is executed, if it exists</li>
<li>Package initialization code is placed after any procedures or functions<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">PACKAGE</span> school_api <span class="hljs-keyword">AS</span>
v_current_date <span class="hljs-built_in">DATE</span>;
PROCEDURE Discount_Cost;
FUNCTION new_instructor_id
  RETURN instructor.instructor_id%TYPE;
<span class="hljs-keyword">END</span> school_api;
/
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">PACKAGE</span> <span class="hljs-keyword">BODY</span> school_api <span class="hljs-keyword">AS</span>
<span class="hljs-keyword">PROCEDURE</span> discount_cost
<span class="hljs-keyword">IS</span>
  <span class="hljs-keyword">CURSOR</span> c_group_discount
  <span class="hljs-keyword">IS</span>
    <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">distinct</span> s.course_no, c.description
      <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">section</span> s, enrollment e, course c
    <span class="hljs-keyword">WHERE</span> s.section_id = e.section_id
      <span class="hljs-keyword">AND</span> s.course_no = c.course_no
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> s.course_no, c.description,
            e.section_id, s.section_id
    <span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">COUNT</span>(*) &gt;= <span class="hljs-number">8</span>;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">FOR</span> r_group_discount <span class="hljs-keyword">IN</span> c_group_discount <span class="hljs-keyword">LOOP</span>
    <span class="hljs-keyword">UPDATE</span> course
      <span class="hljs-keyword">SET</span> <span class="hljs-keyword">cost</span> = <span class="hljs-keyword">cost</span> * <span class="hljs-number">.95</span>
      <span class="hljs-keyword">WHERE</span> course_no = r_group_discount.course_no;
    dbms_output.put_line
      (&apos;A 5% discount has been given to &apos;
      || r_group_discount.course_no || &apos; &apos;
      || r_group_discount.description);
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
<span class="hljs-keyword">END</span> discount_cost;
FUNCTION new_instructor_id
  RETURN instructor.instructor_id%TYPE
IS
  v_new_instid instructor.instructor_id%TYPE;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">SELECT</span> INSTRUCTOR_ID_SEQ.<span class="hljs-keyword">NEXTVAL</span>
    <span class="hljs-keyword">INTO</span> v_new_instid
    <span class="hljs-keyword">FROM</span> dual;
  RETURN v_new_instid;
EXCEPTION
  WHEN OTHERS THEN
    <span class="hljs-keyword">DECLARE</span>
      v_sqlerrm VARCHAR2(<span class="hljs-number">250</span>) := <span class="hljs-keyword">SUBSTR</span>(SQLERRM, <span class="hljs-number">1</span>, <span class="hljs-number">250</span>);
    <span class="hljs-keyword">BEGIN</span>
      RAISE_APPLICATION_ERROR(<span class="hljs-number">-20003</span>,
        <span class="hljs-string">&apos;Error in instructor_id: &apos;</span> || v_sqlerrm);
    <span class="hljs-keyword">END</span>;
<span class="hljs-keyword">END</span> new_instructor_id;
<span class="hljs-comment">-- Initial starts</span>
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">SELECT</span> trunc(<span class="hljs-keyword">sysdate</span>, <span class="hljs-string">&apos;DD&apos;</span>)
    <span class="hljs-keyword">INTO</span> v_current_date
    <span class="hljs-keyword">FROM</span> dual;
<span class="hljs-keyword">END</span> school_api;
</code></pre>
</li>
</ul>
</li>
<li>Access a variable from a package<pre><code class="lang-sql"><span class="hljs-keyword">DECLARE</span>
  v_date <span class="hljs-built_in">DATE</span>;
<span class="hljs-keyword">BEGIN</span>
  v_date := school_api.v_current_date;
  dbms_output.put_line(&apos;Current date from package: &apos; || v_date);
<span class="hljs-keyword">END</span>;
</code></pre>
</li>
</ul>
<h4 id="oracle-supplied-packages">Oracle Supplied Packages</h4>
<ul>
<li>Oracle supplies 100s of PL/SQL packages</li>
<li><a href="https://docs.oracle.com/en/database/oracle/oracle-database/18/arpls/index.html" target="_blank">Click</a> for complete PL/SQL Packages and Types Reference</li>
<li>Steps to check package content like <code>DBMS_OUTPUT</code> in SQL Developer<ol>
<li>Expand the SYS user</li>
<li>Expand the Packages node</li>
<li>Scroll to DBMS_OUTPUT</li>
<li>Expand it to see its parameters</li>
<li>Select it to see its specification</li>
<li>Select DBMS_OUTPUT Body</li>
</ol>
</li>
<li><code>dbms_job</code> package allows the scheduling of execution of PL/SQL procedures<ul>
<li><code>dbms_job.submit()</code>, Enters a PL/SQL procedure as a job into the job queue
```sql
-- Example Procedure
CREATE OR REPLACE PROCEDURE new_course
(course_name IN course.description%TYPE)
AS
BEGIN
INSERT INTO course
  (course_no, description, created_by, created_date, modified_by, modified_date)
  VALUES(course_no_seq.NEXTVAL, course_name, USER, SYSDATE, USER, SYSDATE);
END;
-- Submit the job
-- Parameters
/* job - OUT Mode, The unique number that identifies the job in the job queue</li>
<li>what - IN Mode, The PL/SQL procedure and parameters that execute as part of this job</li>
<li>next_date - IN Mode, The next execution date for the job</li>
<li>interval - IN Mode, The calculation to compute the next date of the job; this can make use of SYSDATE and any date function</li>
<li>no_parse - IN Mode, FALSE (default): Procedure is parsed for validity at submission, TRUE: procedure is parsed when job first runs
*/
DECLARE
v_job_no NUMBER;
BEGIN
dbms_job.SUBMIT(job       =&gt; v_job_no,<pre><code>            what      =&gt; &apos;new_course(&apos;&apos;Oracle PL/SQL Programming&apos;&apos;);&apos;,
            next_date =&gt; SYSDATE,
            interval  =&gt; &apos;SYSDATE + 1/4&apos;);
</code></pre>COMMIT;
dbms_output.put_line(v_job_no);
END;
-- See Jobs in the Queue
SELECT job, last_date, last_sec, next_date, next_sec, broken, what
FROM dba_jobs;
```</li>
<li><code>dbms_job.remove()</code>, Removes a previously submitted PL/SQL procedure from the job queue, e.g. <code>EXEC dbms_job.remove(n)</code></li>
<li><code>dbms_job.change()</code>, Changes the parameters that have been set for a previously submitted job (description, next run time or interval), <code>EXEC dbms_job.change(n, NULL, NULL, &apos;SYSDATE + 1/24&apos;);</code> timing format are shown as follows<pre><code class="lang-sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">SESSION</span> <span class="hljs-keyword">SET</span> NLS_DATE_FORMAT = <span class="hljs-string">&apos;YYYY-MM-DD HH:MI:SS&apos;</span>;
<span class="hljs-comment">-- Now and 2 days from now</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">SYSDATE</span>, TO_CHAR(<span class="hljs-keyword">SYSDATE</span> + <span class="hljs-number">2</span>) <span class="hljs-keyword">FROM</span> dual;
<span class="hljs-comment">-- Now and 6 hours from now</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">SYSDATE</span>, TO_CHAR(<span class="hljs-keyword">SYSDATE</span> + <span class="hljs-number">1</span>/<span class="hljs-number">4</span>) <span class="hljs-keyword">FROM</span> dual;
<span class="hljs-comment">-- Now and 1 hour from now</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">SYSDATE</span>, TO_CHAR(<span class="hljs-keyword">SYSDATE</span> + <span class="hljs-number">1</span>/<span class="hljs-number">24</span>) <span class="hljs-keyword">FROM</span> dual;
<span class="hljs-comment">-- Now and 1 minute from now</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">SYSDATE</span>, TO_CHAR(<span class="hljs-keyword">SYSDATE</span> + <span class="hljs-number">60</span>/<span class="hljs-number">86400</span>) <span class="hljs-keyword">FROM</span> dual;
<span class="hljs-comment">-- There are 86,400 seconds in 1 day</span>
</code></pre>
</li>
<li><code>dbms_job.broken()</code>, Disables a job in the queue, e.g. set job n to be broken <code>EXEC dbms_job.broken(n, TRUE);</code></li>
<li><code>dbms_job.interval()</code>, Alters the interval set for an existing job</li>
<li><code>dbms_job.next_date()</code>, Changes the next time an existing job runs</li>
<li><code>dbms_job.run()</code>, Forces the run of a job regardless of schedule, e.g. <code>EXEC dbms_job.run(n);</code></li>
</ul>
</li>
</ul>
<h4 id="explain-plan">EXPLAIN PLAN</h4>
<ul>
<li>This statement displays execution plans chosen by the Oracle optimizer for SELECT, UPDATE, INSERT, and DELETE statements<pre><code class="lang-sql"><span class="hljs-keyword">EXPLAIN</span> PLAN <span class="hljs-keyword">FOR</span>
<span class="hljs-keyword">SELECT</span> s.course_no,
      c.description,
      i.first_name,
      i.last_name,
      s.section_no,
      TO_CHAR(s.start_date_time, <span class="hljs-string">&apos;Mon-DD-YYYY HH:MIAM&apos;</span>),
      s.location
  <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">section</span> s,
      course c,
      instructor i
<span class="hljs-keyword">WHERE</span> s.course_no     = c.course_no
<span class="hljs-keyword">AND</span>   s.instructor_id = i.instructor_id;
<span class="hljs-comment">-- To see the plan, issue this command which uses the dbms_xplan package</span>
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">TABLE</span>(dbms_xplan.display);
<span class="hljs-comment">-- The TABLE function converts the output of the display procedure into a table that can be queried by SELECT</span>
</code></pre>
</li>
<li>A statement&apos;s execution plan is the sequence of operations Oracle performs to run the statement</li>
<li>Cardinality is the estimated number of rows the operation will return</li>
<li>Cost is not expressed in any actual units, it is relative to other execution plans<ul>
<li>Cost is a numeric internal measure that represents the estimated resource usage for an execution plan</li>
<li>The lower the cost, the more efficient the plan</li>
</ul>
</li>
<li>When using SQL Developer, Click the <code>Explain Plan...</code> button on the toolbar, or press <code>F10</code> to see the execution plan</li>
</ul>
<h3 id="mysql-scripts">MySQL Scripts</h3>
<h4 id="system-stored-procedures">System Stored Procedures</h4>
<ul>
<li>Pieces of executable code stored in the database (small programs)</li>
<li>Stored procedures require procedural code</li>
<li>For MySQL<ul>
<li>System Stored Procedures are pre-defined stored procedures with name:<ul>
<li><code>sp_help &lt;column_name&gt;</code> see help about a column</li>
<li><code>sp_server_info</code> see info about the server</li>
</ul>
</li>
<li>Procedures are stored in the data dictionary <code>sys.procedures</code>, <code>sys.sql_modules</code></li>
</ul>
</li>
</ul>
<h4 id="create-procedures">Create Procedures</h4>
<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> procedure_name
    @param1 DATATYPE,
    @param2 DATATYPE
<span class="hljs-keyword">AS</span>
&#x2026;<span class="hljs-keyword">SQL</span> COMMAND <span class="hljs-keyword">WITH</span> @param1, @param2&#x2026;
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> update_items_item_cost
    @increase <span class="hljs-built_in">DECIMAL</span>(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>),
    @vendor_id <span class="hljs-built_in">INT</span>  = <span class="hljs-number">0</span>    - - <span class="hljs-keyword">SET</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">after</span>
<span class="hljs-keyword">AS</span>
<span class="hljs-keyword">UPDATE</span> items
    <span class="hljs-keyword">SET</span> item_cost = item_cost * (<span class="hljs-number">1</span> + @increase)
    <span class="hljs-keyword">WHERE</span> primary_vendor_id = @vendor_id;
</code></pre>
<h4 id="alter-a-procedure">Alter a Procedure</h4>
<pre><code class="lang-sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">PROCEDURE</span> procedure_name
    @param1 DATATYPE,
    @param2 DATATYPE
<span class="hljs-keyword">AS</span>
&#x2026;<span class="hljs-keyword">SQL</span> COMMAND <span class="hljs-keyword">WITH</span> @param1, @param2&#x2026;
</code></pre>
<h4 id="delete-a-procedure">Delete a Procedure</h4>
<pre><code class="lang-sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">PROCEDURE</span> procedure_name;
</code></pre>
<h4 id="run-procedure">Run Procedure</h4>
<ul>
<li>use <code>EXEC</code> to run procedures<pre><code class="lang-sql">EXEC sp_help
EXEC procedure_name &apos;column_name&apos;;
</code></pre>
</li>
<li>Can accept command line parameters, separated by commas</li>
<li>functions are not accepted, new variables need to be declared to store values from function. <code>EXEC procedure_name @param1=&#x2018;value1&#x2019;, @param2=&#x2018;value2&#x2019;;</code></li>
<li>Parameters can be positional or named, <code>EXEC procedure_name value1 value2;</code></li>
<li>SET, It is used to assign value.<pre><code class="lang-sql"><span class="hljs-keyword">SET</span> @variable_name = <span class="hljs-keyword">value</span>;
<span class="hljs-keyword">SET</span> @variable_name = <span class="hljs-literal">NULL</span>;
<span class="hljs-keyword">SET</span> @variable_name = &lt;<span class="hljs-keyword">SQL</span> Command that <span class="hljs-keyword">return</span> a single <span class="hljs-keyword">value</span>&gt;
</code></pre>
</li>
</ul>
<h4 id="conditional-structure">Conditional Structure</h4>
<ul>
<li>IF<pre><code class="lang-sql">IF @ref_error = 1
<span class="hljs-keyword">SET</span> @error_msg = <span class="hljs-string">&apos;NOT FOUND&apos;</span>;
</code></pre>
</li>
<li>IF/ELSE statements<pre><code class="lang-sql">IF @ref_error = 0
  <span class="hljs-keyword">SET</span> @error_msg = <span class="hljs-string">&apos;FOUND&apos;</span>;
ELSE
  <span class="hljs-keyword">SET</span> @error_msg = <span class="hljs-string">&apos;NOT FOUND&apos;</span>;
</code></pre>
</li>
<li>CASE statements<pre><code class="lang-sql">CASE @evaluation
WHEN 100
  THEN <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.3</span>;
WHEN 90
  THEN <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.2</span>;
WHEN 80
  THEN <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.1</span>;
ELSE <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.05</span>;
<span class="hljs-keyword">END</span>
</code></pre>
<pre><code class="lang-sql">CASE
WHEN @evaluation = 100
  THEN <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.3</span>;
WHEN @evaluation =  90
  THEN <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.2</span>;
WHEN @evaluation =  80
  THEN <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.1</span>;
ELSE <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.05</span>;
<span class="hljs-keyword">END</span>
</code></pre>
</li>
<li>WHILE Loop<pre><code class="lang-sql">WHILE @@FETCH_STATUS = 0
<span class="hljs-keyword">BEGIN</span>
  &lt;<span class="hljs-keyword">loop</span> processing&gt;
<span class="hljs-keyword">END</span>
</code></pre>
</li>
<li>BREAK<ul>
<li>It is used to break the loop.</li>
</ul>
</li>
<li>CONTINUE<ul>
<li>Used to advance to the next iteration of a loop.</li>
</ul>
</li>
</ul>
<h4 id="cursor">Cursor</h4>
<ul>
<li>Used to access a SELECT result set one row at a time</li>
<li>Steps to use a cursor<ol>
<li>DECLARE a cursor with a SELECT statement</li>
<li>OPEN the cursor</li>
<li>This executes the SELECT statement and populates the cursor</li>
<li>FETCH one row at a time from the result set INTO variables</li>
<li>Each column fetched must have a correlating variable</li>
<li>Perform whatever processing desired for each row</li>
<li>CLOSE the cursor</li>
<li>DEALLOCATE the cursor</li>
</ol>
</li>
<li>Example<pre><code class="lang-sql">ALTER PROCEDURE update_items_item_cost
  @increase DECIMAL(3, 2),
  @vendor_id INT,
  @update INT = 0, -- If @update = 1, perform update, else show what would be updated
  @number_of_records INT OUTPUT
AS
  DECLARE items_cursor CURSOR
    FOR SELECT item_cost
        FROM items
        WHERE primary_vendor_id = @vendor_id
    FOR UPDATE;
  DECLARE @item_cost DECIMAL(9, 2);
BEGIN
  IF @update = 1
  BEGIN
    SET @number_of_records = 0;
    OPEN items_cursor;
    FETCH NEXT FROM items_cursor
      INTO @item_cost;
    WHILE @@FETCH_STATUS = 0
    BEGIN
      SET @item_cost = @item_cost * (1 + @increase);
      UPDATE items
        SET item_cost = @item_cost
        WHERE CURRENT OF items_cursor;
      SET @number_of_records = @number_of_records + 1;
      FETCH NEXT FROM items_cursor
        INTO @item_cost;
    END
  CLOSE items_cursor;
  END
  ELSE -- No Update
    SELECT item_id, vendor_name, item_cost AS [existing_cost], item_cost * (1 + @increase) AS [proposed_cost]
    FROM items
    JOIN vendors
    ON primary_vendor_id = vendors.vendor_id
    WHERE primary_vendor_id = @vendor_id;
  DEALLOCATE items_cursor;
END
PRINT &apos;**********Before Update**********&apos;
SELECT * FROM items WHERE primary_vendor_id = 1;
-- Need to declare a variable to receive output
DECLARE @num_of_rows INT;
PRINT &apos;**********No Update**********&apos;
EXEC update_items_item_cost @increase=0.25, @vendor_id=1, @update=0, @number_of_records=@num_of_rows OUTPUT;
SELECT @num_of_rows AS [number_of_rows];
PRINT &apos;**********After No Update**********&apos;
SELECT * FROM items WHERE primary_vendor_id = 1;
PRINT &apos;**********Update**********&apos;
EXEC update_items_item_cost @increase=0.25, @vendor_id=1, @update=1, @number_of_records=@num_of_rows OUTPUT;
SELECT @num_of_rows AS [number_of_rows];
PRINT &apos;**********After Update**********&apos;
SELECT * FROM items WHERE primary_vendor_id = 1;
</code></pre>
</li>
<li><code>@@FETCH_STATUS</code>, Returns the status of the last cursor FETCH statement<ul>
<li>0 = The FETCH statement was successful</li>
<li>-1 = The FETCH statement failed or the row was beyond the result set</li>
<li>-2 = The row fetched is missing</li>
</ul>
</li>
</ul>
<h4 id="trigger">Trigger</h4>
<ul>
<li>A trigger is a special stored procedure attached to a specific table.</li>
<li>It is Event-driven, it is &quot;Fired&quot; automatically in response to event</li>
<li>Can&apos;t pass values into a trigger, values can be declared inside a trigger.</li>
<li>Example<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TRIGGER</span> employees_insert
<span class="hljs-keyword">ON</span> employees
<span class="hljs-keyword">AFTER</span> <span class="hljs-keyword">INSERT</span>, <span class="hljs-keyword">UPDATE</span> #triggered <span class="hljs-keyword">by</span> <span class="hljs-keyword">both</span> <span class="hljs-keyword">insert</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">update</span> operation
<span class="hljs-keyword">AS</span>
<span class="hljs-keyword">UPDATE</span> company_stats
<span class="hljs-keyword">SET</span> number_of_employees = number_of_employees + <span class="hljs-number">1</span>;
</code></pre>
</li>
<li>During trigger execution, two special tables are used: deleted and inserted</li>
<li>SQL Server automatically creates and manages these tables</li>
<li>They have identical schema to the table being modified<pre><code class="lang-sql">CREATE TRIGGER trigger_name
  ON table_name
  AFTER UPDATE
AS
  DECLARE @new_data MONEY;
  DECLARE @old_data MONEY;
BEGIN
  SET @newData = (SELECT columnName FROM inserted);
  SET @oldData = (SELECT columnName FROM deleted);
  IF @new_data &gt; (@old_data * 1.5)
    ROLLBACK TRANSACTION;     - - cancel update
END
</code></pre>
</li>
<li>Improvement for updating multiple records<pre><code class="lang-sql">  <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TRIGGER</span> employees_update
  <span class="hljs-keyword">ON</span> employees
  <span class="hljs-keyword">AFTER</span> <span class="hljs-keyword">UPDATE</span>
  <span class="hljs-keyword">AS</span>
  <span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> (<span class="hljs-keyword">SELECT</span> i.salary <span class="hljs-keyword">FROM</span> inserted i
  <span class="hljs-keyword">JOIN</span> deleted d
  <span class="hljs-keyword">ON</span> i.employee_id = d.employee_id
  <span class="hljs-keyword">WHERE</span> i.salary &gt; (d.salary * <span class="hljs-number">1.5</span>))
  <span class="hljs-keyword">ROLLBACK</span> <span class="hljs-keyword">TRANSACTION</span>;
  <span class="hljs-keyword">END</span>
</code></pre>
</li>
<li>Trigger with Cursor<pre><code class="lang-sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TRIGGER</span> employees_update
  <span class="hljs-keyword">ON</span> employees
  <span class="hljs-keyword">AFTER</span> <span class="hljs-keyword">UPDATE</span>
<span class="hljs-keyword">AS</span>
  <span class="hljs-keyword">DECLARE</span> employees_cursor <span class="hljs-keyword">CURSOR</span>
    <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">SELECT</span> i.salary, d.salary
      <span class="hljs-keyword">FROM</span> inserted i
      <span class="hljs-keyword">JOIN</span> deleted d
      <span class="hljs-keyword">ON</span> i.employee_id = d.employee_id;
  <span class="hljs-keyword">DECLARE</span> @new_salary MONEY;
  <span class="hljs-keyword">DECLARE</span> @old_salary MONEY;
<span class="hljs-keyword">BEGIN</span>
  <span class="hljs-keyword">OPEN</span> employees_cursor;
  FETCH NEXT FROM employees_cursor
    INTO @new_salary, @old_salary;
  WHILE @@FETCH_STATUS = 0
  <span class="hljs-keyword">BEGIN</span>
    <span class="hljs-keyword">IF</span> @new_salary &gt; @old_salary * <span class="hljs-number">1.5</span>
    <span class="hljs-keyword">BEGIN</span>
      <span class="hljs-keyword">ROLLBACK</span> <span class="hljs-keyword">TRANSACTION</span>;
      BREAK;
    <span class="hljs-keyword">END</span>
    <span class="hljs-keyword">FETCH</span> <span class="hljs-keyword">NEXT</span> <span class="hljs-keyword">FROM</span> employees_cursor
      <span class="hljs-keyword">INTO</span> @new_salary, @old_salary;
  <span class="hljs-keyword">END</span>
  <span class="hljs-keyword">CLOSE</span> employees_cursor;
<span class="hljs-keyword">END</span>
</code></pre>
</li>
<li>To delete an existing trigger use: <code>DROP TRIGGER Trigger_Name</code></li>
<li>Every CREATE TRIGGER statement generates entries<ul>
<li>For SQL Server<ul>
<li>sys.triggers</li>
<li>sys.trigger_events</li>
<li>sys.events</li>
<li>sys.sql_modules</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="transcation">Transcation</h4>
<ul>
<li><code>COMMIT</code> makes events within a transaction permanent<pre><code class="lang-sql"><span class="hljs-keyword">BEGIN</span> <span class="hljs-keyword">TRANSACTION</span> T1;
<span class="hljs-keyword">UPDATE</span> physicians <span class="hljs-keyword">SET</span> specialty = <span class="hljs-string">&apos;Hematology&apos;</span> <span class="hljs-keyword">WHERE</span> physician_id = <span class="hljs-number">2</span>;
<span class="hljs-keyword">UPDATE</span> patients <span class="hljs-keyword">SET</span> allergies = <span class="hljs-string">&apos;Almonds&apos;</span> <span class="hljs-keyword">WHERE</span> patient_id = <span class="hljs-number">1251</span>;
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> physicians <span class="hljs-keyword">WHERE</span> physician*<span class="hljs-keyword">id</span> = <span class="hljs-number">2</span>;
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> patients <span class="hljs-keyword">WHERE</span> patient*<span class="hljs-keyword">id</span> = <span class="hljs-number">1251</span>;
<span class="hljs-keyword">COMMIT</span> <span class="hljs-keyword">TRANSACTION</span> T1;
</code></pre>
</li>
<li><code>ROLLBACK</code> erases events within a transaction<pre><code class="lang-sql"><span class="hljs-keyword">BEGIN</span> <span class="hljs-keyword">TRANSACTION</span>;
<span class="hljs-keyword">UPDATE</span> physicians <span class="hljs-keyword">SET</span> specialty = <span class="hljs-string">&apos;Hematology&apos;</span> <span class="hljs-keyword">WHERE</span> physician_id = <span class="hljs-number">2</span>;
<span class="hljs-keyword">UPDATE</span> patients <span class="hljs-keyword">SET</span> allergies = <span class="hljs-string">&apos;Almonds&apos;</span> <span class="hljs-keyword">WHERE</span> patient_id = <span class="hljs-number">1251</span>;
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> physicians <span class="hljs-keyword">WHERE</span> physician*<span class="hljs-keyword">id</span> = <span class="hljs-number">2</span>;<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> patients <span class="hljs-keyword">WHERE</span> patient*<span class="hljs-keyword">id</span> = <span class="hljs-number">1251</span>;
<span class="hljs-keyword">ROLLBACK</span> <span class="hljs-keyword">TRANSACTION</span>;
</code></pre>
</li>
<li><code>SAVEPOINT</code> marks a place in a transaction to where a partial rollback may be made</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../php/wordpress.html" class="navigation navigation-prev " aria-label="Previous page: WordPress">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../solidity/" class="navigation navigation-next " aria-label="Next page: Solidity">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"SQL","level":"1.15","depth":1,"next":{"title":"Solidity","level":"1.16","depth":1,"path":"solidity/README.md","ref":"solidity/README.md","articles":[]},"previous":{"title":"WordPress","level":"1.14.1","depth":2,"path":"php/wordpress.md","ref":"php/wordpress.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"sql/README.md","mtime":"2021-04-13T17:10:13.991Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-04-21T15:06:58.594Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

