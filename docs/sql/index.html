
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>SQL Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../solidity/" />
    
    
    <link rel="prev" href="../php/wordpress.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../python/">
            
                <a href="../python/">
            
                    
                    Python
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../python/standard-library.html">
            
                <a href="../python/standard-library.html">
            
                    
                    Python Stardard Library
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../python/tools-and-packages.html">
            
                <a href="../python/tools-and-packages.html">
            
                    
                    Tools & More Packages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../python/django.html">
            
                <a href="../python/django.html">
            
                    
                    Django
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../java/">
            
                <a href="../java/">
            
                    
                    Java
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../java/javafx.html">
            
                <a href="../java/javafx.html">
            
                    
                    JavaFX
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../java/android.md">
            
                <span>
            
                    
                    Android Studio
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../scala/">
            
                <a href="../scala/">
            
                    
                    Scala
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../javascript/">
            
                <a href="../javascript/">
            
                    
                    JavaScript
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../javascript/jquery.html">
            
                <a href="../javascript/jquery.html">
            
                    
                    jQuery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../javascript/react.html">
            
                <a href="../javascript/react.html">
            
                    
                    React
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../javascript/react-native.html">
            
                <a href="../javascript/react-native.html">
            
                    
                    React Native
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../javascript/node-js.html">
            
                <a href="../javascript/node-js.html">
            
                    
                    Node.js
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../javascript/wechat-mini-program.html">
            
                <a href="../javascript/wechat-mini-program.html">
            
                    
                    Wechat Mini Program
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../c/">
            
                <a href="../c/">
            
                    
                    C
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../cpp/">
            
                <a href="../cpp/">
            
                    
                    C++
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../c-sharp/">
            
                <a href="../c-sharp/">
            
                    
                    C#
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../c-sharp/dot-net.html">
            
                <a href="../c-sharp/dot-net.html">
            
                    
                    .NET
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../c-sharp/asp-dot-net.html">
            
                <a href="../c-sharp/asp-dot-net.html">
            
                    
                    ASP.NET
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../swift/">
            
                <a href="../swift/">
            
                    
                    Swift
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../swift/xcode.html">
            
                <a href="../swift/xcode.html">
            
                    
                    Xcode
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../go/">
            
                <a href="../go/">
            
                    
                    Go Programming Language
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../markup/">
            
                <a href="../markup/">
            
                    
                    Markup Language
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../markup/html.html">
            
                <a href="../markup/html.html">
            
                    
                    HTML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../markup/xml.html">
            
                <a href="../markup/xml.html">
            
                    
                    XML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../markup/gfm.html">
            
                <a href="../markup/gfm.html">
            
                    
                    GFM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="../markup/latex.html">
            
                <a href="../markup/latex.html">
            
                    
                    LaTeX
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../css/">
            
                <a href="../css/">
            
                    
                    CSS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../css/bootstrap.html">
            
                <a href="../css/bootstrap.html">
            
                    
                    Bootstrap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../typescript/">
            
                <a href="../typescript/">
            
                    
                    TypeScript
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../typescript/angular.html">
            
                <a href="../typescript/angular.html">
            
                    
                    Angular
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../php/">
            
                <a href="../php/">
            
                    
                    PHP
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../php/wordpress.html">
            
                <a href="../php/wordpress.html">
            
                    
                    WordPress
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.15" data-path="./">
            
                <a href="./">
            
                    
                    SQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../solidity/">
            
                <a href="../solidity/">
            
                    
                    Solidity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../os/">
            
                <a href="../os/">
            
                    
                    Operating Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.17.1" data-path="../os/linux.html">
            
                <a href="../os/linux.html">
            
                    
                    Linux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.2" data-path="../os/bash-scripting.html">
            
                <a href="../os/bash-scripting.html">
            
                    
                    Bash Scripting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.3" data-path="../os/regex.html">
            
                <a href="../os/regex.html">
            
                    
                    Regular Expression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.4" data-path="../os/macos.html">
            
                <a href="../os/macos.html">
            
                    
                    MacOS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.5" data-path="../os/solution-stack.html">
            
                <a href="../os/solution-stack.html">
            
                    
                    Solution Stack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.6" data-path="../os/hadoop.html">
            
                <a href="../os/hadoop.html">
            
                    
                    Hadoop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.7" data-path="../os/git.html">
            
                <a href="../os/git.html">
            
                    
                    Git
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.8" data-path="../os/redis.html">
            
                <a href="../os/redis.html">
            
                    
                    Redis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.9" data-path="../os/media.html">
            
                <a href="../os/media.html">
            
                    
                    Media
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="../networking/">
            
                <a href="../networking/">
            
                    
                    Networking
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.18.1" data-path="../networking/security.html">
            
                <a href="../networking/security.html">
            
                    
                    Security
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.2" data-path="../networking/cisco.html">
            
                <a href="../networking/cisco.html">
            
                    
                    Cisco
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="../virtualization/">
            
                <a href="../virtualization/">
            
                    
                    Virtualization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.19.1" data-path="../virtualization/virtualbox.html">
            
                <a href="../virtualization/virtualbox.html">
            
                    
                    VirtualBox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19.2" data-path="../virtualization/docker.html">
            
                <a href="../virtualization/docker.html">
            
                    
                    Docker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19.3" data-path="../virtualization/kubernetes.html">
            
                <a href="../virtualization/kubernetes.html">
            
                    
                    Kubernetes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="../cloud-services/">
            
                <a href="../cloud-services/">
            
                    
                    Cloud Services
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.20.1" data-path="../cloud-services/aws.html">
            
                <a href="../cloud-services/aws.html">
            
                    
                    AWS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.2" data-path="../cloud-services/gcp.html">
            
                <a href="../cloud-services/gcp.html">
            
                    
                    GCP
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.21" data-path="../embedded/">
            
                <a href="../embedded/">
            
                    
                    Embedded Systems
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.21.1" data-path="../embedded/arduino.html">
            
                <a href="../embedded/arduino.html">
            
                    
                    Arduino
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.2" data-path="../embedded/raspberry-pi.html">
            
                <a href="../embedded/raspberry-pi.html">
            
                    
                    Raspberry Pi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.3" data-path="../embedded/st.html">
            
                <a href="../embedded/st.html">
            
                    
                    STMicroelectronics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.4" data-path="../embedded/electricity-magnetism.html">
            
                <a href="../embedded/electricity-magnetism.html">
            
                    
                    Electricity & Magnetism
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.22" data-path="../gis/">
            
                <a href="../gis/">
            
                    
                    GIS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.22.1" data-path="../gis/arcgis.html">
            
                <a href="../gis/arcgis.html">
            
                    
                    ArcGIS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.23" data-path="../algorithm/">
            
                <a href="../algorithm/">
            
                    
                    Algorithm
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.23.1" data-path="../algorithm/blockchain.html">
            
                <a href="../algorithm/blockchain.html">
            
                    
                    Blockchain
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.23.2" data-path="../algorithm/cryptography.html">
            
                <a href="../algorithm/cryptography.html">
            
                    
                    Cryptography
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.23.3" data-path="../algorithm/ml.html">
            
                <a href="../algorithm/ml.html">
            
                    
                    Machine Learning
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.24" data-path="../math/">
            
                <a href="../math/">
            
                    
                    Mathematics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.24.1" data-path="../math/basic.html">
            
                <a href="../math/basic.html">
            
                    
                    Basic Math
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.2" data-path="../math/calculus.html">
            
                <a href="../math/calculus.html">
            
                    
                    Calculus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.3" data-path="../math/linear-algebra.html">
            
                <a href="../math/linear-algebra.html">
            
                    
                    Linear Algebra
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.4" data-path="../math/discrete.html">
            
                <a href="../math/discrete.html">
            
                    
                    Discrete Mathematics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.5" data-path="../math/probability-statistics.html">
            
                <a href="../math/probability-statistics.html">
            
                    
                    Probability & Statistics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.6" data-path="../math/maple.html">
            
                <a href="../math/maple.html">
            
                    
                    Maple Softwares
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.25" data-path="../visualization/">
            
                <a href="../visualization/">
            
                    
                    Visualization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.25.1" data-path="../visualization/graphic-design.html">
            
                <a href="../visualization/graphic-design.html">
            
                    
                    Graphic Design
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.25.2" data-path="../visualization/computer-vision.html">
            
                <a href="../visualization/computer-vision.html">
            
                    
                    Computer Vision
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.25.3" data-path="../visualization/tableau.html">
            
                <a href="../visualization/tableau.html">
            
                    
                    Tableau
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.26" data-path="../music/">
            
                <a href="../music/">
            
                    
                    Music
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.26.1" data-path="../music/theory.html">
            
                <a href="../music/theory.html">
            
                    
                    Music Theory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.26.2" data-path="../music/logic-pro.html">
            
                <a href="../music/logic-pro.html">
            
                    
                    Logic Pro
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >SQL</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="sql">SQL</h1>
<h2 id="history">History</h2>
<ul>
<li>It started life as SEQUEL in 1974, an IBM product</li>
<li>In 1980 it was renamed SQL</li>
<li>There is a SQL standard maintained by the American National Standards Institute (ANSI). Most database vendors extend the standard</li>
<li>PhpMyAdmin is a tool that helps manage database using a web interface, it is written in PHP.</li>
<li>The easiest way to get MySQL and PHPMyAdmin is to install free tools like XAMPP or WAMP, Then a database server can be installed on the computer and Database management can be accessed from browser using url: localhost:8080/myphpadmin.
(userid:root, password:&quot;&quot;)</li>
</ul>
<h2 id="concepts">Concepts</h2>
<ul>
<li>Compare with NoSQL, SQL it good at making complicated anlytics queries. NoSQL is good at getting direct or simple access to massive data</li>
<li>Column Sometimes referred to as a field, contains the same type of information for every record in table.</li>
<li>Row Sometimes referred to as a record
Table is a collection of related rows</li>
<li>Database is a collection of related tables and other objects</li>
<li>Entity is represented by a table, it is a thing or a person etc.
Cardinality can be used to represent the Entity relationship(one to one, one to many etc.), when the Entity can be zero it is optional.</li>
<li>A weak entity is an entity that cannot be uniquely identified by its attributes alone; therefore, it must use a foreign key.</li>
<li>Relationship has degree, A unary relationship(one entity, recursive relationship), binary relationship(two entities), ternary relationship(three entities), four-entity relationship(four entities), Ternary (and higher) relationships are usually represented by a series of binary relationships.</li>
<li>Attribute is represented by column headings.</li>
<li>Data Dictionary<ul>
<li>Also called Metadata System Tables (SQL Server) System dictionary is the repository of all data definitions for all objects within the scope of the database. It contains meta-data (Table name, column name, data constraints, primary and foreign keys, index)</li>
</ul>
</li>
<li>The System Catalog<ul>
<li>A detailed system data dictionary that describes all objects in the database</li>
</ul>
</li>
<li>For System table of the SQL Server<ul>
<li>Starting with SQL Server 2005, all System Tables are hidden and inaccessible directly A large collection of System Views have been created to accommodate accessing of database&#x2019;s metadata Two schemas INFORMATION_SCHEMA sys</li>
</ul>
</li>
<li>A primary key is a single field in the table that uniquely identifies (unique nonempty values)the table records. primary auto creates index.</li>
<li>Foreign Key is a field a reference a PK from another table.</li>
<li>A good choice for primary keys is a Meaningless But Unique Number (MBUN)&#x2022;Start at 1 and keep incrementing&#x2022;The int datatype provides 2,147,483,647 possible values&#x2022;The bigint datatype provides 9,223,372,036,854,775,807 possible values (&gt; 9 quintillion)</li>
<li>Another possible choice is the Globally Unique Identifier (GUID)&#x2013;Also known as Universally Unique Identifier (UUID)&#x2022;128 bit integer, typically expressed as 32 hex digits in the pattern 8-4-4-4-12&#x2013;Example: 678e6b75-29ad-4cba-8d78-5ad68aad414b&#x2022;Good for decentralized systems</li>
<li>Naming Conventions<ul>
<li>Do not put spaces in the names of anything you create</li>
<li>Do not use descriptive prefixes or postfixes such as tbl</li>
<li>Use all lowercase and divide word boundaries with <code>_</code>, database name uppercase.</li>
<li><a href="http://www.sqlstyle.guide" target="_blank">Click here to see more</a>.</li>
</ul>
</li>
<li>IDENTITY Property<ul>
<li>SQL Server provides an optional identity property to simplify creating MBUNs&#x2022;The identity property would be added to the definition of the primary key column when a table is being created.</li>
<li>IDENTITY [ (seed , increment) ] Seed and increment are optional, both default to 1</li>
<li>when insert row without specifying the value for PK, default rules are used.</li>
<li>Using an identity property simplifies INSERTs.</li>
<li>Without an identity property, the primary key must first be determined and then specified</li>
<li>With an identity property, the primary key is left off the INSERT statement and the database automatically keeps track of it and provides it when necessary.</li>
</ul>
</li>
<li>Determinant<ul>
<li>An attribute whose value determines the value for another attribute</li>
<li>Usually the primary key.</li>
</ul>
</li>
<li>Functional Dependency<ul>
<li>Relationship between a determinant A and dependent attribute B.</li>
<li>Represented by A -&gt; B</li>
</ul>
</li>
<li>Candidate Key<ul>
<li>One of the attributes that could be used as a primary key.</li>
</ul>
</li>
<li>Relation<ul>
<li>A table with rows and columns &#x2022;Each row contains information on an instance of an entity</li>
</ul>
</li>
<li>Tuple is a row of data</li>
<li>When design database, identity the entities then find their relationship.</li>
<li>Many-to-Many relationship cannot be represented in the database. Hence, an intersection entities is required.</li>
<li>Atomic attribute<ul>
<li>A component of the record definition that is used to describe an entity A field Unique meaningful names Example: postal_code Composite attribute Composed of atomic attributes, each defined in the data dictionary Address is comprised of street_address city province_id postal_code</li>
</ul>
</li>
<li>Derived attribute<ul>
<li>An attribute whose value is obtained by applying a formula to other data elements Examples: sales commission = sales <em> percentage age = DATEDIFF(YEAR, birth_date, GETDATE()) Multi-valued attribute An attribute with multiple possible values A employee can have more than one skill Alias Synonym A different name for a data element with the same meaning ``SELECT COUNT(</em>) AS total FROM patients``</li>
</ul>
</li>
<li>Domain<ul>
<li>The set of possible values an attribute can take on Concatenated Key Also known as Composite Key, Compound Key Two or more attributes taken together to uniquely identify a record Examples: patient_id, admission_date in admissions table purchase_order_id, line_num in purchase_order_lines table Secondary Key Requires an index may not be unique Example: last_name Sort Key Used to physically sequence a file Example: seniority listing of employee records</li>
</ul>
</li>
<li>Foreign Key<ul>
<li>A field (or multiple fields) in a table that uniquely identifies a row of another table (or the same table) Example: nursing_unit_id in admissions table Entity Occurrence Represented by a record with actual data values in it, or a row in a table Schema The definition of an entire database In SQL Server, schemas are used as containers to organize database objects</li>
</ul>
</li>
<li>Indexes is used to improve only the access time.</li>
<li>Clustered indexes is the indexes that are associated with a column, usually the primary key. when create is physical sort and associated column data. Unclustered index store unsorted data on the store device and use pointers to associate the data with index.</li>
<li>Multiple SQL statement can bu put in order, end with ;.</li>
<li>Normalization Quick Summary&#x2022;<ul>
<li>0NF - tables without normalization.</li>
<li>1NF - Eliminate Repeating Groups And Derived Attributes&#x2013;Make a separate table for each set of related attributes, and give each table a primary key&#x2022;</li>
<li>2NF - Eliminate Redundant Data&#x2013;If an attribute depends on only part of a composite key, remove it to a separate table&#x2022;</li>
<li>3NF - Eliminate Columns Not Dependent On Key&#x2013;If attributes do not contribute to a description of the key, remove them to a separate table</li>
</ul>
</li>
<li>OLTP(Online Transaction Process) uses normalized data.</li>
<li>OLAP(Online Analytical Process) and BI(Business Intellige) and Data warehouse stores denormalized data.</li>
<li>Business Rules are specifications that preserve the integrity of a conceptual or logical data model. They are enforced by for types of rules.</li>
<li>Entity integrity(PK)</li>
<li>Referential integrity(FK)</li>
<li>Domains(Value Boundary, check)</li>
<li>Triggering operations(?)</li>
<li>View<ul>
<li>View is a virtual table based on one or more tables.</li>
<li>The View result set is not permanently stored in the database, but generated each time it is used</li>
<li>Shows up in INFORMATION_SCHEMA.VIEWS &amp;INFORMATION_SCHEMA.TAB</li>
</ul>
</li>
<li>SQL Statements have two types.<ul>
<li>Data Definition Language (DDL)<ul>
<li>CREATE table</li>
<li>CREATE index</li>
</ul>
</li>
<li>Data Manipulation Language (DML)<ul>
<li>SELECT</li>
<li>INSERT</li>
<li>UPDATE</li>
<li>DELETE</li>
</ul>
</li>
</ul>
</li>
<li>Depending on the database vendor, data can be case sensitive <code>&apos;M&apos; &lt;&gt; &apos;m&apos;</code></li>
<li>For Character and string data single quotes are recommended and generally used.</li>
<li>Convention is to capitalize keywords and place each clause on its own line</li>
<li>multiple queries or commands can be entered at the same time and separate by ; at end of each line.</li>
<li>SQL is case insensitive. However uppercase is preferred for all commands.</li>
<li>SQL syntax is not sensitive to indentations.</li>
</ul>
<h2 id="data-types">Data Types</h2>
<h3 id="postgres">Postgres</h3>
<ul>
<li>Array is supported for all types</li>
</ul>
<h2 id="syntax">Syntax</h2>
<p>The following SQL examples work for mySQL, variation for other SQL will be noted in the bracket.</p>
<ul>
<li>Check server version</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">select</span> @@<span class="hljs-keyword">version</span>
</code></pre>
<ul>
<li>the command lists the databases managed by the server.</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">DATABASES</span> MySQL
.<span class="hljs-keyword">databases</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">SQL</span> <span class="hljs-keyword">Server</span>
</code></pre>
<ul>
<li>display all of the tables in the currently selected database.</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">TABLES</span> MySQL
.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">SQL</span> <span class="hljs-keyword">Server</span>
</code></pre>
<ul>
<li>displays information about the columns in a given table.</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">COLUMNS</span> <span class="hljs-keyword">FROM</span> tablename
</code></pre>
<h3 id="select">SELECT</h3>
<ul>
<li>The SELECT statement is used to query data from a database. Query results are stored in a table called result-set.</li>
<li>A SELECT statement retrieves zero or more rows from one or more database tables.</li>
<li>FROM is required expect for SQL Server.</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> column_list
<span class="hljs-keyword">FROM</span> table_name
</code></pre>
<ul>
<li>SELECT can be followed by a column function.<ul>
<li>AVG&#x2013;Computes the average value of the column</li>
<li>COUNT&#x2013;Counts the number of rows</li>
<li>MAX&#x2013;Determines the maximum value</li>
<li>MIN&#x2013;Determines the minimum value</li>
<li>SUM&#x2013;Totals the numeric values</li>
</ul>
</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(*)<span class="hljs-keyword">FROM</span> patients
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">AVG</span>(patient_weight)<span class="hljs-keyword">FROM</span> patients
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">MIN</span>(last_name)<span class="hljs-keyword">FROM</span> patients
</code></pre>
<ul>
<li>Columns have fully qualified names as tablename.columnname is acceptable. It is used to distinguish same columns names from different tables.</li>
<li>Multiple columns can be queried in one command separated by commas.</li>
<li><code>*</code> represent all.</li>
<li><code>DISTINCT</code> qualifier return unique value of columns</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> column_name1, column_name2
<span class="hljs-keyword">FROM</span> table_name;
</code></pre>
<ul>
<li><code>LIMIT</code> keyword shows only specific number of d rows.</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ID</span>, FirstName, LastName, City
<span class="hljs-keyword">FROM</span> customers <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">5</span>;
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">Select</span> <span class="hljs-number">4</span> <span class="hljs-keyword">start</span> <span class="hljs-keyword">after</span> <span class="hljs-number">3</span>rd(counting <span class="hljs-keyword">from</span> zero)
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ID</span>, FirstName, LastName, City
 <span class="hljs-keyword">FROM</span> customers <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">3</span>, <span class="hljs-number">4</span>;
</code></pre>
<ul>
<li>Im SQL Server use TOP, The TOP clause sets a maximum number of rows that can be retrieved</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> TOP <span class="hljs-number">5</span> *
<span class="hljs-keyword">FROM</span> patients;
and
<span class="hljs-keyword">SELECT</span> TOP <span class="hljs-number">5</span> <span class="hljs-keyword">PERCENT</span> *
<span class="hljs-keyword">FROM</span> patients;
</code></pre>
<ul>
<li>ORDER BY is used with SELECT to sort the returned data.</li>
<li>Can order by multiple columns separate by commas. Sort the first column first then second.</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> customers
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> FirstName;
Default uses ascending order.
Or <span class="hljs-keyword">use</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> Salary <span class="hljs-keyword">DESC</span>(<span class="hljs-keyword">ASC</span>)
</code></pre>
<ul>
<li>Where keyword is used to add conditions.<ul>
<li>Predicates are used in the WHERE clause to specify conditions, Basic Predicate:<ul>
<li><code>=, &lt;&gt;, &lt;, &gt;, &lt;=, &gt;=</code></li>
<li>BETWEEN Predicate</li>
<li>EXISTS Predicate</li>
<li>IN Predicate</li>
<li>LIKE Predicate</li>
<li>NULL Predicate<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> column_list
<span class="hljs-keyword">FROM</span> table_name
<span class="hljs-keyword">WHERE</span> condition;
Condition could be ID=5 (any comparison and logic operator(and &amp; or)
between. for example ID=5 and ID=10)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> customers
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">ID</span> <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">3</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">7</span>;
(Boundaries are included)
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
<li>Single quotation marks (&apos;) is used for text.</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ID</span>, FirstName, LastName, City
<span class="hljs-keyword">FROM</span> customers
<span class="hljs-keyword">WHERE</span> City = <span class="hljs-string">&apos;New York&apos;</span>;
</code></pre>
<ul>
<li>&#x2018; can also be the escape characters. Ex: Can&apos;&apos;t</li>
<li><code>IN</code> keyword includes all satisfied columns.</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> customers
<span class="hljs-keyword">WHERE</span> City <span class="hljs-keyword">IN</span> (<span class="hljs-string">&apos;New York&apos;</span>, <span class="hljs-string">&apos;Los Angeles&apos;</span>, <span class="hljs-string">&apos;Chicago&apos;</span>);
</code></pre>
<ul>
<li>The NOT IN operator allows you to exclude a list of specific values from the result set. Result set must included in bracket, even there is only one element in it. result set can be a column returned from other SELECT query.</li>
<li>EXISTS returns true if a subquery contains any rows.</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> first_name, last_name
<span class="hljs-keyword">FROM</span> patients
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span> (<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> unit_dose_orders <span class="hljs-keyword">WHERE</span> unit_dose_orders.patient_id = patients.patient_id)
(This <span class="hljs-keyword">select</span> all <span class="hljs-keyword">row</span> <span class="hljs-keyword">of</span> patients <span class="hljs-keyword">tables</span> that exist <span class="hljs-keyword">in</span> the unit_dose_orders <span class="hljs-keyword">table</span>.)

<span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> vendors
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> (<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> purchase_orders <span class="hljs-keyword">WHERE</span> purchase_orders.vendor_id = vendors.vendor_id)
(This <span class="hljs-keyword">select</span> all <span class="hljs-keyword">row</span> <span class="hljs-keyword">of</span> patients <span class="hljs-keyword">tables</span> that don&#x2019;t exist <span class="hljs-keyword">in</span> the unit_dose_orders <span class="hljs-keyword">table</span>.)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> patients
<span class="hljs-keyword">WHERE</span> allergies <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>;
IS can be used with NULL. or IS NOT NULL
</code></pre>
<ul>
<li>AND and OR can be used to connects conditions for WHERE statement.</li>
<li>Concat combine two column in a format<ul>
<li>A concatenation results in a new column. The default column name will be the CONCAT</li>
</ul>
</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">CONCAT</span>(FirstName, <span class="hljs-string">&apos;, &apos;</span> , City) <span class="hljs-keyword">FROM</span> customers;
</code></pre>
<ul>
<li>AS is used for a column name change(Alias).</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">CONCAT</span>(FirstName,<span class="hljs-string">&apos;, &apos;</span>, City) <span class="hljs-keyword">AS</span> new_column
<span class="hljs-keyword">FROM</span> customers;
</code></pre>
<ul>
<li>Arithmetic operator can also be used in query.</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ID</span>, FirstName, LastName, Salary+<span class="hljs-number">500</span> <span class="hljs-keyword">AS</span> Salary
<span class="hljs-keyword">FROM</span> employees;
</code></pre>
<ul>
<li>Upper and lower function change upper lower cases.<ul>
<li><ul>
<li>Only affects on letters with default name Upper.</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> FirstName, <span class="hljs-keyword">UPPER</span>(LastName) <span class="hljs-keyword">AS</span> LastName
<span class="hljs-keyword">FROM</span> employees;
</code></pre>
<ul>
<li>GROUP BY<ul>
<li>It can be used to deal with results of the column that has different rows.</li>
<li>GROUP BY must be used in conjunction with an aggregating function</li>
<li>Does not sort automatically, still need ORDER BY for sort</li>
<li>Multiple groupings are allowed</li>
</ul>
</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> province_id, city, <span class="hljs-keyword">COUNT</span>(*)
<span class="hljs-keyword">FROM</span> patients
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> province_id, city
</code></pre>
<ul>
<li>HAVING</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> nursing_unit_id, <span class="hljs-keyword">COUNT</span>(*)
<span class="hljs-keyword">FROM</span> admissions
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> nursing_unit_id
<span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">COUNT</span>(*) &gt;= <span class="hljs-number">340</span>
</code></pre>
<ul>
<li>It is like another WHERE clause for grouped columns.</li>
<li>Used with GROUP BY</li>
<li>Subqueries is a query that has queries inside.<ul>
<li>the inner query is processed first.</li>
<li>Enclose the subquery in parentheses.</li>
<li>Subquery Returns Single Rows<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> FirstName, Salary <span class="hljs-keyword">FROM</span> employees
<span class="hljs-keyword">WHERE</span>  Salary &gt; (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">AVG</span>(Salary) <span class="hljs-keyword">FROM</span> employees)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> Salary <span class="hljs-keyword">DESC</span>;
</code></pre>
</li>
<li>Subquery Returns Multiple Rows<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> nursing_unit_id, patient_id, admission_date
<span class="hljs-keyword">FROM</span> admissions
<span class="hljs-keyword">WHERE</span> nursing_unit_id <span class="hljs-keyword">IN</span>(<span class="hljs-keyword">SELECT</span> nursing_unit_idFROM nursing_unitsWHERE beds &lt; <span class="hljs-number">10</span>)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> nursing_unit_id, patient_id
</code></pre>
</li>
<li>Nested Subquery<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> nursing_unit_id, <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> patients
<span class="hljs-keyword">FROM</span> admissionsWHERE nursing_unit_id <span class="hljs-keyword">IN</span>
(<span class="hljs-keyword">SELECT</span> nursing_unit_id
<span class="hljs-keyword">FROM</span> nursing_units
<span class="hljs-keyword">WHERE</span> beds &gt;(<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">AVG</span>(beds)<span class="hljs-keyword">FROM</span> nursing_units))
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> nursing_unit_id
</code></pre>
</li>
</ul>
</li>
<li>The like keyword can be used to specify a pattern, pattern is represented by:<ul>
<li><code>_</code> any value.</li>
<li><code>%</code> any group of values</li>
</ul>
</li>
</ul>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> employees
<span class="hljs-keyword">WHERE</span> FirstName <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&apos;A%&apos;</span>;
This choose any text <span class="hljs-keyword">begin</span> <span class="hljs-keyword">with</span> A.
</code></pre>
<ul>
<li>NOT LIKE picks anything that not in this pattern.</li>
</ul>
<h3 id="built-in-function">Built-in Function</h3>
<ul>
<li>Scalar Functions &#x2013; Returns Single value.</li>
<li><p>Column Function - works with a set of value.</p>
</li>
<li><p>Mathematical Functions</p>
<ul>
<li>ABS</li>
<li>ACOS</li>
<li>ASIN</li>
<li>ATAN</li>
<li>ATN2</li>
<li>CEILING</li>
<li>COS</li>
<li>COT</li>
<li>DEGREES</li>
<li>EXP</li>
<li>FLOOR</li>
<li>LOG</li>
<li>LOG10</li>
<li>PI</li>
<li>POWER</li>
<li>RADIANS</li>
<li>RAND</li>
<li>ROUND</li>
<li>SIGN</li>
<li>SIN</li>
<li>SQRT</li>
<li>SQUARE</li>
<li>TAN</li>
</ul>
</li>
<li>String Functions<ul>
<li>ASCII</li>
<li>CHAR</li>
<li>CHARINDEX</li>
<li>DIFFERENCE</li>
<li>LEFT</li>
<li>LEN</li>
<li>LOWER</li>
<li>LTRIM</li>
<li>NCHAR</li>
<li>PATINDEX</li>
<li>QUOTENAME</li>
<li>REPLACE</li>
<li>REPLICATE</li>
<li>REVERSE</li>
<li>RTRIM</li>
<li>SOUNDEX</li>
<li>SPACE</li>
<li>STR</li>
<li>STUFF</li>
<li>SUBSTRING</li>
<li>UNICODE</li>
<li>UPPER</li>
</ul>
</li>
<li>Date And Time Functions<ul>
<li>CURRENT_TIMESTAMP</li>
<li>DATEDIFF(datepartType, startdate, enddate)<ul>
<li>datepartType: year, quarter, month, dayofyear, day, week, hour, minute, second, millisecond, microsecond, nanonsecond</li>
<li>Be careful, DATEDIFF with YEAR does not calculate age. A person born on November 15, 1999 is not 19 on October 2, 2018. Use the following way to calculate.<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEDIFF</span>(<span class="hljs-keyword">DAY</span>, <span class="hljs-string">&apos;2017-01-01&apos;</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">608</span> <span class="hljs-keyword">days</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEDIFF</span>(<span class="hljs-keyword">MONTH</span>, <span class="hljs-string">&apos;2017-01-01&apos;</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">20</span> <span class="hljs-keyword">months</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEDIFF</span>(<span class="hljs-keyword">YEAR</span>, <span class="hljs-string">&apos;1999-11-15&apos;</span>, <span class="hljs-string">&apos;2018-10-02&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">19</span> <span class="hljs-keyword">years</span>
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">FLOOR</span>(<span class="hljs-keyword">DATEDIFF</span>(<span class="hljs-keyword">DAY</span>, <span class="hljs-string">&apos;1999-11-15&apos;</span>, <span class="hljs-string">&apos;2018-10-02&apos;</span>) / <span class="hljs-number">365.25</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">18</span> <span class="hljs-keyword">years</span>
</code></pre>
</li>
</ul>
</li>
<li>DATEDIFF extracts the YEAR from both dates and performs subtraction without considering the months or days</li>
<li>DATEADD(datepart, number, date)<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEADD</span>(<span class="hljs-keyword">DAY</span>, <span class="hljs-number">60</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">2018</span><span class="hljs-number">-10</span><span class="hljs-number">-31</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEADD</span>(<span class="hljs-keyword">MONTH</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">2019</span><span class="hljs-number">-02</span><span class="hljs-number">-01</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEADD</span>(<span class="hljs-keyword">YEAR</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">2021</span><span class="hljs-number">-09</span><span class="hljs-number">-01</span>
</code></pre>
</li>
<li>use DATEADD with negative values<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEADD</span>(<span class="hljs-keyword">DAY</span>, <span class="hljs-number">-60</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">2018</span><span class="hljs-number">-07</span><span class="hljs-number">-03</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEADD</span>(<span class="hljs-keyword">MONTH</span>, <span class="hljs-number">-5</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">2018</span><span class="hljs-number">-04</span><span class="hljs-number">-01</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DATEADD</span>(<span class="hljs-keyword">YEAR</span>, <span class="hljs-number">-3</span>, <span class="hljs-string">&apos;2018-09-01&apos;</span>)
<span class="hljs-keyword">Result</span> <span class="hljs-keyword">is</span> <span class="hljs-number">2015</span><span class="hljs-number">-09</span><span class="hljs-number">-01</span>
</code></pre>
</li>
<li>DATENAME(datepart, date) works like DATEPART but returns a string instead of an integer<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> encounter_date_time,
      <span class="hljs-keyword">DATENAME</span>(<span class="hljs-keyword">HOUR</span>, encounter_date_time) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">hour</span>],
      <span class="hljs-keyword">DATENAME</span>(<span class="hljs-keyword">MINUTE</span>, encounter_date_time) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">minute</span>],
      <span class="hljs-keyword">DATENAME</span>(<span class="hljs-keyword">SECOND</span>, encounter_date_time) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">second</span>]
<span class="hljs-keyword">FROM</span> encounters
</code></pre>
</li>
<li>DATEPART(datepart, date)<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> encounter_date_time,
      <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">HOUR</span>, encounter_date_time) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">hour</span>],
      <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">MINUTE</span>, encounter_date_time) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">minute</span>],
      <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">SECOND</span>, encounter_date_time) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">second</span>]
<span class="hljs-keyword">FROM</span> encounters
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span>  <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">YEAR</span>, <span class="hljs-keyword">Timestamp</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&apos;Year&apos;</span>,
        <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">MONTH</span>, <span class="hljs-keyword">Timestamp</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&apos;Month&apos;</span>,
        <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">DAY</span>, <span class="hljs-keyword">Timestamp</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&apos;Day&apos;</span>,
        <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> <span class="hljs-string">&apos;Visits&apos;</span>
<span class="hljs-keyword">FROM</span>      tblVisits
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>  <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">DAY</span>, <span class="hljs-keyword">Timestamp</span>),
          <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">MONTH</span>, <span class="hljs-keyword">Timestamp</span>),
          <span class="hljs-keyword">DATEPART</span>(<span class="hljs-keyword">YEAR</span>, <span class="hljs-keyword">Timestamp</span>)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span>  <span class="hljs-string">&apos;Year&apos;</span>,
          <span class="hljs-string">&apos;Month&apos;</span>,
          <span class="hljs-string">&apos;Day&apos;</span>
</code></pre>
</li>
<li>DAY(date) extracts the day of the month</li>
<li>MONTH(date) extracts the month of the year</li>
<li>YEAR(date) extracts the year<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> birth_date,
      <span class="hljs-keyword">YEAR</span>(birth_date) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">year</span>],
      <span class="hljs-keyword">MONTH</span>(birth_date) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">month</span>],
      <span class="hljs-keyword">DAY</span>(birth_date) <span class="hljs-keyword">AS</span> [<span class="hljs-keyword">day</span>]
<span class="hljs-keyword">FROM</span> patients
</code></pre>
</li>
<li>The GETDATE function returns the current date with time<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">GETDATE</span>()
</code></pre>
</li>
<li>To get the date without the time, the CONVERT function can be used<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">CONVERT</span>(<span class="hljs-built_in">DATE</span>, <span class="hljs-keyword">GETDATE</span>())
</code></pre>
</li>
<li>Calculate patient age<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> birth_date,
      <span class="hljs-keyword">FLOOR</span>(<span class="hljs-keyword">DATEDIFF</span>(<span class="hljs-keyword">DAY</span>, birth_date, <span class="hljs-keyword">GETDATE</span>()) / <span class="hljs-number">365.25</span>)
<span class="hljs-keyword">FROM</span> patients
</code></pre>
</li>
<li>GETUTCDATE</li>
<li>ISDATE</li>
<li>MONTH</li>
<li>SWITCHOFFSET</li>
<li>TODATETIMEOFFSET</li>
<li>YEAR</li>
</ul>
</li>
</ul>
<h3 id="joinregular">Join(regular)</h3>
<p>Rows returned only if they exist in both tables</p>
<ol>
<li>use SELECT&#x2026;..WHERE Col1 = Col2</li>
</ol>
<p>SELECT customers.ID, customers.Name, orders.Name, orders.Amount
FROM customers, orders
WHERE customers.ID=orders.Customer_ID
ORDER BY customers.ID;</p>
<p>Table names can use nickname, set in from clause</p>
<p>SELECT ct.ID, ct.Name, ord.Name, ord.Amount
FROM customers AS ct, orders AS ord
WHERE ct.ID=ord.Customer_ID
ORDER BY ct.ID;</p>
<p>-AS can be omitted sometimes, like in SSMS.
SELECT ct.* ord.Name, ord.Amount
FROM customers ct, orders ord
WHERE ct.ID=ord.Customer_ID
ORDER BY ct.ID;</p>
<p>ct.* means all columns from table ct.</p>
<ol>
<li>use join&#x2026;on</li>
</ol>
<p>SELECT column(s)
FROM firsttable
JOIN secondtable
ON firsttable.column = secondtable.column</p>
<p>example:
SELECT *
FROM purchase_orders
JOIN purchase_order_lines
ON purchase_orders.purchase_order_id = purchase_order_lines.purchase_order_id</p>
<p>Select all columns from both tables
Join on purchase order number</p>
<p>It is also called inner join</p>
<p>SELECT column_name(s)
FROM table1 INNER JOIN table2
ON table1.column_name=table2.column_name;</p>
<p>The LEFT JOIN returns all rows from the left table, even if there are no matches in the right table.
SELECT table1.column1, table2.column2...
FROM table1 LEFT OUTER JOIN table2
ON table1.column_name = table2.column_name;</p>
<p>If no match is found for a particular row, NULL is returned.</p>
<p>The RIGHT JOIN returns all rows from the right table, even if there are no matches in the left table.</p>
<p>MySQL only support above types of join.
OUTER keywords can be optional.
There are many other types of join.
full outer join
All rows returned from both tables
Missing values returned as NULL</p>
<p>cross join
Each row from left table is joined with each row from right table
if table_a has x rows, table_b has y rows. the cross join of them has x multiply by y rows.</p>
<p>SELECT p.product_id, sold, purchased
FROM sales_lines s
CROSS JOIN purchase_lines p</p>
<p>or (inner join using where = syntax and remove the where clause)
SELECT ct.ID, ct.Name, ord.Name, ord.Amount
FROM customers ct, orders ord</p>
<p>Example for join 3 tables</p>
<p>SELECT first_name, last_name, medication_description, dosage
FROM patients p
JOIN unit_dose_orders u
ON p.patient_id = u.patient_id
JOIN medications m
ON u.medication_id = m.medication_id
ORDER BY last_name, first_name, medication_description</p>
<p>Joining a Table with Itself
SELECT e1.employee_id, e1.first_name, e1.last_name, e1.department, e1.title, e1.supervisor, e2.employee_id, e2.first_name, e2.last_name
FROM employees e1
LEFT JOIN employees e2 - - if not using LEFT, somebody will be missing.
ON e1.supervisor = e2.employee_id
ORDER BY e1.department, e1.employee_id</p>
<p>UNION combines multiple datasets into a single dataset, removes any existing duplicates.
UNION ALL (faster) does not remove duplicate rows
Union combines two or more select statements with same type of columns(data type) in order. If one column can&#x2019;t match use null instead.</p>
<p>SELECT FirstName, LastName, Company FROM businessContacts
UNION
SELECT FirstName, LastName, NULL FROM otherContacts;</p>
<p>Order of Clauses in SELECT</p>
<p>SELECT list_of_columns
FROM list_of_tables
WHERE list of conditions
GROUP BY list_of_expressions
HAVING condition
ORDER BY expressions</p>
<p>Insert into keyword:
INSERT INTO table_name
VALUES (value1, value2, value3,&#x2026;);</p>
<p>INSERT INTO dental_services
VALUES(101, &apos;Tricky Extraction&apos;, &apos;E&apos;, NULL, 0)
New row will be added at the bottom. Order is important.
Must include a value for columns that have no default values or don&#x2019;t allow null.
PK value can be omitted, identity property will be used.
Alternatively, you can specify the table&apos;s column names(so you can use your own order for columns, not the default)
INSERT INTO table_name (column1, column2, column3, ...,columnN)<br>VALUES (value1, value2, value3,...valueN);</p>
<p>INSERT INTO dental_services
(service_id, service_description, service_type, hourly_rate, sales_ytd)
VALUES(302, &apos;Temporary Filling&apos;, &apos;F&apos;, 100, 0)</p>
<p>When omit one column its value will be set to NULL.</p>
<p>It is also possible to insert data into specific columns only.</p>
<p>Multiple rows of value can be inserted in one statement.
after VALUE separated by comma.</p>
<p>INSERT INTO dental_services
(service_id, service_description, service_type, hourly_rate, sales_ytd)
VALUES(302, &apos;Temporary Filling&apos;, &apos;F&apos;, 100, 0),(303,&apos;Temp&apos;,&apos;T&apos;,230.0)</p>
<p>One can insert multiple rows
INSERT INTO tablename[(column1, column2, column3, column4)]
SELECT statement</p>
<p>INSERT INTO dental<em>service_archives(service_id, service_description, service_type, hourly_rate, sales_ytd)
SELECT service_id, service_description, service_type, hourly_rate, sales_ytd
FROM dental_services
or
INSERT INTO dental_service_archives(service_id, service_description, service_type, hourly_rate, sales_ytd)
SELECT </em>
FROM dental<em>services
WHERE sales_ytd &gt;= 500
or
INSERT INTO dental_service_archives
SELECT </em>
FROM dental_services<br>(all column must have values.and in order)</p>
<p>INSERT INTO dental_service_archives(service_id, service_description)
SELECT service_id, service_description
FROM dental_services
(omitted column will be null)</p>
<p>Update
UPDATE table_name
SET column1=value1, column2=value2, ...
WHERE condition;</p>
<p>UPDATE departments
SET manager_first_name = &apos;Bob&apos;, manager_last_name = &#x2018;Loblaw&apos;
WHERE department_id = 5</p>
<p>UPDATE items
SET item_cost = item_cost * 1.1
WHERE primary_vendor_id = 5
(select multi rows and apply updates using formula)</p>
<p>UPDATE purchase_orders
SET total_amount = (SELECT SUM(quantity * unit_cost)FROM purchase_order_linesWHERE purchase_order_id = 10)
WHERE purchase_order_id = 1
(Updating A Single Row With A Subquery)</p>
<p>If the WHERE clause is omitted, all records in the table will be updated!</p>
<p>Delete
DELETE FROM table_name
WHERE condition;</p>
<p>DELETE FROM dental_services
WHERE service_id = 301
Deletion can fail if the PK has a reference to other table.</p>
<p>DELETE FROM sales
WHERE amount &gt;= 100
Delete multiple rows.</p>
<p>If you omit the WHERE clause, all records in the table will be deleted!
The DELETE statement removes the data from the table permanently.</p>
<p>A single database can house hundreds of tables</p>
<p>CREATE TABLE</p>
<p>CREATE TABLE table_name
(
column_name1 data_type(size),
column_name2 data_type(size),
column_name3 data_type(size),
....
columnN data_type(size)
);</p>
<p>Numeric</p>
<p>int(can have no length),can be signed or unsigned.
FLOAT(optional display length,decimal place) cannot be unsigned.
DOUBLE(optional display length,decimal place) cannot be unsigned.
Date and Time
DATE - A date in YYYY-MM-DD format.
DATETIME - A date and time combination in YYYY-MM-DD HH:MM:SS format.
TIMESTAMP - A timestamp, calculated from midnight, January 1, 1970
TIME - Stores the time in HH:MM:SS format.</p>
<p>String Type
CHAR(M) - Fixed-length character string. Size is specified in parenthesis. Max 255 bytes.
VARCHAR(M) - Variable-length character string. Max size is specified in parenthesis.
BLOB - &quot;Binary Large Objects&quot; and are used to store large amounts of binary data, such as images or other types of files.
TEXT - Large amount of text data.</p>
<p>The size parameter specifies the maximum length of the table&apos;s column.</p>
<p>Data Types for SQL Server</p>
<p>Exact Numerics
bigint
bit
decimal
int
money
numeric
smallint
smallmoney
tinyint</p>
<p>Approximate Numerics
float
real
Date and Time
date
datetime2
datetime
datetimeoffset
smalldatetime
time</p>
<p>Character Strings
char
text
varchar
Unicode Character Strings
nchar
ntext
nvarchar
Binary Strings
binary
image
varbinary
Other Data Types
Cursor
hierarchyid
sql_variant
table
timestamp
uniqueidentifier
xml</p>
<p>NULL
All data types support the concept of NULL
NULL is the absence of a value, it is unknown
For a numeric column NULL is not 0
For a string column NULL is not &apos;&apos;</p>
<p>Primary key keyword
Define it as a primary key</p>
<p>CREATE TABLE Users
(
UserID int,
FirstName varchar(100),
LastName varchar(100),
City varchar(100),
PRIMARY KEY(UserID)
);</p>
<p>SQL Constraints
Not null
name varchar(100) NOT NULL</p>
<p>Unique
Primary key
Default
Check
Determines whether the value is valid or not from a logical expression.</p>
<p>During table creation, specify column level constraint(s) after the data type of that column.</p>
<p>Auto increment
the starting value for AUTO_INCREMENT is 1, and it will increment by 1 for each new record.</p>
<p>UserID int NOT NULL AUTO_INCREMENT,
PRIMARY KEY (UserID)</p>
<p>The ALTER TABLE command is used to add, delete, or modify columns constraints in an existing table.</p>
<p>Add new columns
ALTER TABLE People ADD DateOfBirth date;
Default value will set for the new column, if not default value then all null.</p>
<p>Delete columns
ALTER TABLE People
DROP COLUMN DateOfBirth;</p>
<p>Delete entire table
DROP TABLE People;</p>
<p>Rename columns</p>
<p>ALTER TABLE People
CHANGE FirstName name varchar(100);</p>
<p>Rename tables
RENAME TABLE People TO Users;</p>
<p>For SQL Server:</p>
<p>CREATE TABLE TableName (
ColumnName1 DataType[(size)][not null] [DEFAULT value],
ColumnName2 DataType[(size)][not null] [DEFAULT value],</p>
<p>[CONSTRAINT CK_ConstraintName
CHECK (ConstraintCheckCondition),]</p>
<pre><code>CONSTRAINT PK_ConstraintName
           PRIMARY KEY(ColumnName[, ColumnName]
</code></pre><p>[,CONSTRAINT FK_ConstraintName
FOREIGN KEY (ColumnName)
REFERENCES TableName (ColumnName)
ON DELETE RESTRICT
ON UPDATE RESTRICT]
)</p>
<p>Example:</p>
<p>CREATE TABLE employees
(employee_id INT NOT NULL,
employee_name VARCHAR(50) NOT NULL,
department_id INT,
job_id CHAR(3),
birth_date DATE,
gender CHAR(1),
salary DECIMAL(8, 2),
CONSTRAINT PK_employees PRIMARY KEY(employee_id),
CONSTRAINT CK_gender CHECK(gender IN (&apos;M&apos;, &apos;F&apos;)),
CONSTRAINT CK_salary CHECK(salary &gt;= 0),
CONSTRAINT FK_employees_department_id_departments FOREIGN KEY(department_id) REFERENCES departments(department_id))</p>
<p>Table Creation Example with IDENTITY and Constraints Specified Inline
CREATE TABLE employees_with_identity
(employee_id INT IDENTITY PRIMARY KEY,
employee_name VARCHAR(50) NOT NULL,
department_id INT FOREIGN KEY REFERENCES departments(department_id),
job_id CHAR(3),
birth_date DATE,
gender CHAR(1) CHECK(gender IN (&apos;M&apos;, &apos;F&apos;)),
salary DECIMAL(8, 2) CHECK(salary &gt;= 0))</p>
<p>Create an index
Create [UNIQUE][clustered] INDEX index_name
ON table_name
(column_name1 [ ASC/DESC ].
...
column_nameN [ ASC/DESC ]</p>
<p>Ex:
CREATE INDEX STJ_patients_last_name
ON patients
(last_name ASC)</p>
<p>View
In SQL, a VIEW is a virtual table that is based on the result-set of an SQL statement.
It cannot use ORDER BY</p>
<p>CREATE VIEW view_name AS
SELECT column_name(s)
FROM table_name
WHERE condition
GROUP BY column_name;</p>
<p>Once generated, View can be later query as a normal table.
A view always shows up-to-date data.
When use substring in a view columns names must have alias(new name after AS)</p>
<p>Update view</p>
<p>CREATE OR REPLACE VIEW view_name AS
SELECT column_name(s)
FROM table_name
WHERE condition;</p>
<p>Delete view,
DROP VIEW List;</p>
<p>Stored Procedures
Pieces of executable code stored in the database (small programs)<br>Stored procedures require procedural code<br>Each database vendor extends SQL with procedural code<br>Microsoft uses T-SQL<br>Oracle uses Procedural Language SQL (PL/SQL)<br>IBM uses SQL Procedural Language (SQL PL)<br>MySQL uses SQL/Persistent Stored Module (SQL/PSM)
System Stored Procedures are pre-defined stored procedures with name:
sp_help &#x2018;column_name&apos; &#x2014;see help about a column
sp_server_info &#x2014; see info about the server.
Procedures are stored in the data dictionary sys.procedures, sys.sql_modules.</p>
<p>Create Procedure</p>
<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> procedure_name
    @param1 DATATYPE,
    @param2 DATATYPE
<span class="hljs-keyword">AS</span>
&#x2026;<span class="hljs-keyword">SQL</span> COMMAND <span class="hljs-keyword">WITH</span> @param1, @param2&#x2026;
</code></pre>
<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> update_items_item_cost
    @increase <span class="hljs-built_in">DECIMAL</span>(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>),
    @vendor_id <span class="hljs-built_in">INT</span>  = <span class="hljs-number">0</span>    - - <span class="hljs-keyword">SET</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">after</span>
<span class="hljs-keyword">AS</span>
<span class="hljs-keyword">UPDATE</span> items
    <span class="hljs-keyword">SET</span> item_cost = item_cost * (<span class="hljs-number">1</span> + @increase)
    <span class="hljs-keyword">WHERE</span> primary_vendor_id = @vendor_id;
</code></pre>
<p>Alter a Procedure</p>
<pre><code class="lang-sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">PROCEDURE</span> procedure_name
    @param1 DATATYPE,
    @param2 DATATYPE
<span class="hljs-keyword">AS</span>
&#x2026;<span class="hljs-keyword">SQL</span> COMMAND <span class="hljs-keyword">WITH</span> @param1, @param2&#x2026;
</code></pre>
<p>Delete a Procedure</p>
<pre><code class="lang-sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">PROCEDURE</span> procedure_name;
</code></pre>
<p>Run Procedure</p>
<pre><code class="lang-sql">EXEC sp_help
EXEC procedure_name &#x2018;column_name&#x2019;;
</code></pre>
<p>Can accept command line parameters, separated by commas
functions are not accepted, new variables need to be declared to store values from function.
EXEC procedure_name @param1=&#x2018;value1&#x2019;, @param2=&#x2018;value2&#x2019;;</p>
<p>Parameters can be positional or named<br>EXEC procedure_name value1 value2;</p>
<p>BEGIN-END
Used to enclose a block of statements, like {}.</p>
<pre><code class="lang-sql"><span class="hljs-keyword">BEGIN</span>
    <span class="hljs-keyword">SET</span>&#x2026;
    <span class="hljs-keyword">SET</span>&#x2026;
<span class="hljs-keyword">END</span>
<span class="hljs-keyword">Declare</span>
<span class="hljs-keyword">Declare</span> <span class="hljs-keyword">local</span> <span class="hljs-keyword">variables</span>
<span class="hljs-keyword">DECLARE</span> @variable_name DATATYPE;
</code></pre>
<p>SET
It is used to assign value.</p>
<pre><code class="lang-sql"><span class="hljs-keyword">SET</span> @variable_name = <span class="hljs-keyword">value</span>;
<span class="hljs-keyword">SET</span> @variable_name = <span class="hljs-literal">NULL</span>;
<span class="hljs-keyword">SET</span> @variable_name = &#x2026;<span class="hljs-keyword">SQL</span> Command that <span class="hljs-keyword">return</span> a single <span class="hljs-keyword">value</span>&#x2026;
</code></pre>
<p>IF</p>
<pre><code class="lang-sql">IF @ref_error = 1
<span class="hljs-keyword">SET</span> @error_msg = <span class="hljs-string">&apos;NOT FOUND&apos;</span>;
</code></pre>
<p>IF/ELSE statements</p>
<pre><code class="lang-sql">IF @ref_error = 0
    <span class="hljs-keyword">SET</span> @error_msg = <span class="hljs-string">&apos;FOUND&apos;</span>;
ELSE
    <span class="hljs-keyword">SET</span> @error_msg = <span class="hljs-string">&apos;NOT FOUND&apos;</span>;
</code></pre>
<p>CASE statements</p>
<pre><code class="lang-sql">CASE @evaluation
WHEN 100
    THEN <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.3</span>;
WHEN 90
    THEN <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.2</span>;
WHEN 80
    THEN <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.1</span>;
ELSE <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.05</span>;
<span class="hljs-keyword">END</span>
</code></pre>
<p>Or</p>
<pre><code class="lang-sql">CASE
WHEN @evaluation = 100
    THEN <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.3</span>;
WHEN @evaluation =  90
    THEN <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.2</span>;
WHEN @evaluation =  80
    THEN <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.1</span>;
ELSE <span class="hljs-keyword">UPDATE</span> employees <span class="hljs-keyword">SET</span> salary = salary * <span class="hljs-number">1.05</span>;
<span class="hljs-keyword">END</span>
</code></pre>
<p>WHILE Loop</p>
<pre><code class="lang-sql">WHILE @@FETCH_STATUS = 0
<span class="hljs-keyword">BEGIN</span>
     &lt;<span class="hljs-keyword">loop</span> processing&gt;
<span class="hljs-keyword">END</span>
</code></pre>
<p>BREAK
it is used to break the loop.</p>
<p>CONTINUE
Used to advance to the next iteration of a WHILE loop.</p>
<p>Cursor
Used to access a SELECT result set one row at a time
Steps to use a cursor<br>DECLARE a cursor with a SELECT statement<br>OPEN the cursor<br>This executes the SELECT statement and populates the cursor<br>FETCH one row at a time from the result set INTO variables<br>Each column fetched must have a correlating variable<br>Perform whatever processing desired for each row<br>CLOSE the cursor<br>DEALLOCATE the cursor</p>
<p>Example:</p>
<pre><code class="lang-sql">ALTER PROCEDURE update_items_item_cost
  @increase DECIMAL(3, 2),
  @vendor_id INT,
  @update INT = 0, -- If @update = 1, perform update, else show what would be updated
  @number_of_records INT OUTPUT
AS
  DECLARE items_cursor CURSOR
    FOR SELECT item_cost
        FROM items
        WHERE primary_vendor_id = @vendor_id
    FOR UPDATE;
  DECLARE @item_cost DECIMAL(9, 2);
BEGIN
  IF @update = 1
  BEGIN
    SET @number_of_records = 0;
    OPEN items_cursor;
    FETCH NEXT FROM items_cursor
      INTO @item_cost;
    WHILE @@FETCH_STATUS = 0
    BEGIN
      SET @item_cost = @item_cost * (1 + @increase);
      UPDATE items
        SET item_cost = @item_cost
        WHERE CURRENT OF items_cursor;
      SET @number_of_records = @number_of_records + 1;
      FETCH NEXT FROM items_cursor
        INTO @item_cost;
    END
  CLOSE items_cursor;
  END
  ELSE -- No Update
    SELECT item_id, vendor_name, item_cost AS [existing_cost], item_cost * (1 + @increase) AS [proposed_cost]
    FROM items
    JOIN vendors
    ON primary_vendor_id = vendors.vendor_id
    WHERE primary_vendor_id = @vendor_id;
  DEALLOCATE items_cursor;
END

PRINT &apos;**********Before Update**********&apos;
SELECT * FROM items WHERE primary_vendor_id = 1;

-- Need to declare a variable to receive output
DECLARE @num_of_rows INT;

PRINT &apos;**********No Update**********&apos;
EXEC update_items_item_cost @increase=0.25, @vendor_id=1, @update=0, @number_of_records=@num_of_rows OUTPUT;
SELECT @num_of_rows AS [number_of_rows];

PRINT &apos;**********After No Update**********&apos;
SELECT * FROM items WHERE primary_vendor_id = 1;

PRINT &apos;**********Update**********&apos;
EXEC update_items_item_cost @increase=0.25, @vendor_id=1, @update=1, @number_of_records=@num_of_rows OUTPUT;
SELECT @num_of_rows AS [number_of_rows];

PRINT &apos;**********After Update**********&apos;
SELECT * FROM items WHERE primary_vendor_id = 1;
</code></pre>
<p>@@FETCH_STATUS
Returns the status of the last cursor FETCH statement<br>0 = The FETCH statement was successful<br>-1 = The FETCH statement failed or the row was beyond the result set<br>-2 = The row fetched is missing</p>
<p>Trigger
A trigger is a special stored procedure attached to a specific table.</p>
<p>It is Event-driven, it is &quot;Fired&quot; automatically in response to event</p>
<p>Can&#x2019;t pass values into a trigger, values can be declared inside a trigger.</p>
<p>CREATE TRIGGER employees_insert<br> ON employees<br> AFTER INSERT, UPDATE #triggered by both insert and update operation
AS<br> UPDATE company_stats<br> SET number_of_employees = number_of_employees + 1;</p>
<p>During trigger execution, two special tables are used: deleted and inserted<br>SQL Server automatically creates and manages these tables<br>They have identical schema to the table being modified</p>
<pre><code class="lang-sql">CREATE TRIGGER trigger_name
    ON table_name
    AFTER UPDATE
AS
    DECLARE @new_data MONEY;
    DECLARE @old_data MONEY;
BEGIN
    SET @newData = (SELECT columnName FROM inserted);
    SET @oldData = (SELECT columnName FROM deleted);
    IF @new_data &gt; (@old_data * 1.5)
        ROLLBACK TRANSACTION;     - - cancel update
END
</code></pre>
<p>Improvement for updating multiple records</p>
<p>ALTER TRIGGER employees_update<br> ON employees<br> AFTER UPDATE<br>AS<br>BEGIN<br> IF EXISTS (SELECT i.salary FROM inserted i<br> JOIN deleted d<br> ON i.employee_id = d.employee_id<br> WHERE i.salary &gt; (d.salary * 1.5))<br> ROLLBACK TRANSACTION;<br>END</p>
<p>Trigger with Cursor</p>
<pre><code class="lang-sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TRIGGER</span> employees_update
    <span class="hljs-keyword">ON</span> employees
    <span class="hljs-keyword">AFTER</span> <span class="hljs-keyword">UPDATE</span>
<span class="hljs-keyword">AS</span>
    <span class="hljs-keyword">DECLARE</span> employees_cursor <span class="hljs-keyword">CURSOR</span>
        <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">SELECT</span> i.salary, d.salary
            <span class="hljs-keyword">FROM</span> inserted i
            <span class="hljs-keyword">JOIN</span> deleted d
            <span class="hljs-keyword">ON</span> i.employee_id = d.employee_id;
    <span class="hljs-keyword">DECLARE</span> @new_salary MONEY;
    <span class="hljs-keyword">DECLARE</span> @old_salary MONEY;
<span class="hljs-keyword">BEGIN</span>
    <span class="hljs-keyword">OPEN</span> employees_cursor;
  FETCH NEXT FROM employees_cursor
        INTO @new_salary, @old_salary;
    WHILE @@FETCH_STATUS = 0
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">IF</span> @new_salary &gt; @old_salary * <span class="hljs-number">1.5</span>
        <span class="hljs-keyword">BEGIN</span>
            <span class="hljs-keyword">ROLLBACK</span> <span class="hljs-keyword">TRANSACTION</span>;
            BREAK;
        <span class="hljs-keyword">END</span>
        <span class="hljs-keyword">FETCH</span> <span class="hljs-keyword">NEXT</span> <span class="hljs-keyword">FROM</span> employees_cursor
            <span class="hljs-keyword">INTO</span> @new_salary, @old_salary;
    <span class="hljs-keyword">END</span>
    <span class="hljs-keyword">CLOSE</span> employees_cursor;
<span class="hljs-keyword">END</span>
</code></pre>
<p>To delete an existing trigger use:<br>DROP TRIGGER Trigger_Name</p>
<p>Every CREATE TRIGGER statement generates entries in<br>sys.triggers<br>sys.trigger_events<br>sys.events<br>sys.sql_modules</p>
<p>TRANSCATION
ROLLBACK</p>
<p>SELECT <em> FROM physicians WHERE physician_id = 2;SELECT </em> FROM patients WHERE patient<em>id = 1251;BEGIN TRANSACTION;UPDATE physicians SET specialty = &apos;Hematology&apos; WHERE physician_id = 2;UPDATE patients SET allergies = &apos;Almonds&apos; WHERE patient_id = 1251;SELECT </em> FROM physicians WHERE physician<em>id = 2;SELECT </em> FROM patients WHERE patient<em>id = 1251;ROLLBACK TRANSACTION;SELECT </em> FROM physicians WHERE physician<em>id = 2;SELECT </em> FROM patients WHERE patient_id = 1251;</p>
<p>Commit
SELECT <em> FROM physicians WHERE physician_id = 2;SELECT </em> FROM patients WHERE patient<em>id = 1251;BEGIN TRANSACTION T1;UPDATE physicians SET specialty = &apos;Hematology&apos; WHERE physician_id = 2;UPDATE patients SET allergies = &apos;Almonds&apos; WHERE patient_id = 1251;SELECT </em> FROM physicians WHERE physician<em>id = 2;SELECT </em> FROM patients WHERE patient<em>id = 1251;COMMIT TRANSACTION T1;SELECT </em> FROM physicians WHERE physician<em>id = 2;SELECT </em> FROM patients WHERE patient_id = 1251;</p>
<p>SQL Script
the script put multiple SQL statement together one by one in a file.
the script file has an extension of .sql
each statement requires; in the end
Excel can build inserts statements
When work with scripts in database management software always select the correct table or database before execution.</p>
<p>Script file comments
Single line comments begin with <code>--</code>
Multi line comments are bounded with <code>/* */</code></p>
<p>A group of sql command is called a batch in sql script.</p>
<p>GO statements is used at the end of each batch, no ; followed. It can be followed by an integer that repeats the batch for certain time. When a batch fails other batches will still be executed.</p>
<p>Some CREATE and INSERT statements require that they are the first statement in a batch.</p>
<p>SET commands can be used to change session settings.
SET NOCOUNT ON
Suppress INSERT, UPDATE and DELETE completion messages
SET DATEFORMAT ymd
Sets the date format to YYYY-MM-D</p>
<p>SET Examples:</p>
<p>SET NOCOUNT ON</p>
<p>-- Set date format to year, month, day
SET DATEFORMAT ymd;</p>
<p>-- Make the master database the current database
USE master</p>
<p>-- If database co859 exists, drop it
IF EXISTS (SELECT * FROM sysdatabases WHERE name = &apos;co859&apos;)
DROP DATABASE co859;
GO</p>
<p>PRINT &#x2018;Verification&apos;;
//Print statement in the script print string in console, when it is executed. For Microsoft SQL manegement output setting need to be changed to text.</p>
<p>SET DATEFORMAT format
format can be:
dmy (Preferred in much of the world)
mdy (Preferred in USA)
ymd (Unambiguous, best choice, SQL Server default)
ydm (Should be avoided)
myd (Should be avoided)
dym (Should be avoided)</p>
<p>-- Create the co859 database
CREATE DATABASE co859;
GO</p>
<p>-- Make the co859 database the current database
USE co859;</p>
<p>CREATE User statement creates a new entry in the user table that has no privileges. GRANT is then used to control the access and privileges the user has</p>
<p>smith@localhost &#x2013; this account will be granted access only when accessing the data locally, not remotely&#xF07D;RSingh@&#x2019;192.168.1.%&#x2019; &#x2013;this account will be granted access only when accessing the data from a host with an IP address that begins with 192.168.1&#xF07D;DNguyen &#x2013;this account will be granted access from any host, local or not (translates to DNguyen@&#x2019;%&#x2019;)</p>
<p>GRANT Create ON <em>.</em> TO PZhang@localhost
GRANT Create ON Mydata.* TO PZhang@&#x2019;192.168.1.%&#x2019;</p>
<ul>
<li><code>create database databaseName</code> create a new database.</li>
<li><code>grant select on databaseName.* to userName@localhost identified by &apos;newPassword&apos;</code> create new database user with local connection and only be allowed to select records.</li>
<li><code>use databaseName</code> set the database as default database.</li>
<li><code>describe tableName;</code> view details about certain table.</li>
<li><code>exit;</code> exit the mysql interface.</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../php/wordpress.html" class="navigation navigation-prev " aria-label="Previous page: WordPress">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../solidity/" class="navigation navigation-next " aria-label="Next page: Solidity">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"SQL","level":"1.15","depth":1,"next":{"title":"Solidity","level":"1.16","depth":1,"path":"solidity/README.md","ref":"solidity/README.md","articles":[]},"previous":{"title":"WordPress","level":"1.14.1","depth":2,"path":"php/wordpress.md","ref":"php/wordpress.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"sql/README.md","mtime":"2020-11-20T18:09:53.477Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-12-07T20:59:12.500Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

